[{"Bao": {"Bao prediction": 2195.631, "Bao recommended hint": "SET enable_mergejoin TO off; SET enable_indexscan TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 355916.53, "Total Cost": 355916.54, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1552.429, "Actual Total Time": 1580.835, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 355916.32, "Total Cost": 355916.53, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 1552.382, "Actual Total Time": 1580.83, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 354916.32, "Total Cost": 354916.33, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1550.064, "Actual Total Time": 1550.068, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 51691.62, "Total Cost": 354915.69, "Plan Rows": 252, "Plan Width": 0, "Actual Startup Time": 319.281, "Actual Total Time": 1549.94, "Actual Rows": 2417, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 302038.28, "Plan Rows": 316166, "Plan Width": 4, "Actual Startup Time": 0.57, "Actual Total Time": 1211.799, "Actual Rows": 235558, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))", "Rows Removed by Filter": 4709682}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 51690.05, "Total Cost": 51690.05, "Plan Rows": 126, "Plan Width": 8, "Actual Startup Time": 316.277, "Actual Total Time": 316.28, "Actual Rows": 2625, "Actual Loops": 3, "Hash Buckets": 8192, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 472, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.73, "Total Cost": 51690.05, "Plan Rows": 126, "Plan Width": 8, "Actual Startup Time": 20.711, "Actual Total Time": 240.155, "Actual Rows": 2625, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.29, "Total Cost": 50878.2, "Plan Rows": 182, "Plan Width": 4, "Actual Startup Time": 20.665, "Actual Total Time": 224.895, "Actual Rows": 4317, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 100.309, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 13, "Plan Width": 4, "Actual Startup Time": 20.044, "Actual Total Time": 20.044, "Actual Rows": 30, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 10, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 13, "Plan Width": 4, "Actual Startup Time": 1.229, "Actual Total Time": 20.029, "Actual Rows": 30, "Actual Loops": 3, "Filter": "((keyword)::text ~~ '%sequel%'::text)", "Rows Removed by Filter": 134140}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "title", "Alias": "t", "Startup Cost": 0.45, "Total Cost": 4.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 12951, "Recheck Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 1990)", "Rows Removed by Filter": 0, "Exact Heap Blocks": 4745, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "title_pkey", "Startup Cost": 0.0, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 12951, "Index Cond": "(id = mk.movie_id)"}]}]}]}]}]}]}]}, "Planning Time": 86.068, "Triggers": [], "Execution Time": 1580.93}]
[{"Bao": {"Bao prediction": 1141.31, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 50226.61, "Total Cost": 50226.62, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 231.579, "Actual Total Time": 235.73, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 50226.4, "Total Cost": 50226.61, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 230.81, "Actual Total Time": 235.724, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 49226.4, "Total Cost": 49226.41, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 228.798, "Actual Total Time": 228.809, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 33908.15, "Total Cost": 49226.28, "Plan Rows": 45, "Plan Width": 0, "Actual Startup Time": 228.759, "Actual Total Time": 228.802, "Actual Rows": 1, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 33907.72, "Total Cost": 49178.32, "Plan Rows": 82, "Plan Width": 8, "Actual Startup Time": 228.735, "Actual Total Time": 228.772, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx.movie_id = mc.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 63.811, "Actual Total Time": 63.813, "Actual Rows": 3, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.015, "Actual Total Time": 32.126, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.028, "Actual Total Time": 0.029, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.024, "Actual Total Time": 0.025, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'bottom 10 rank'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 33866.15, "Total Cost": 33866.15, "Plan Rows": 3132, "Plan Width": 4, "Actual Startup Time": 164.627, "Actual Total Time": 164.634, "Actual Rows": 46968, "Actual Loops": 3, "Hash Buckets": 262144, "Original Hash Buckets": 8192, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9568, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 33866.15, "Plan Rows": 3132, "Plan Width": 4, "Actual Startup Time": 106.303, "Actual Total Time": 150.247, "Actual Rows": 46968, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 32379.21, "Plan Rows": 555923, "Plan Width": 8, "Actual Startup Time": 0.016, "Actual Total Time": 122.114, "Actual Rows": 445696, "Actual Loops": 3, "Filter": "((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text)", "Rows Removed by Filter": 424014}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 0.017, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.012, "Actual Total Time": 0.012, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.58, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.016, "Actual Rows": 1, "Actual Loops": 5, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2000)", "Rows Removed by Filter": 0}]}]}]}]}, "Planning Time": 77.632, "Triggers": [], "Execution Time": 235.819}]
[{"Bao": {"Bao prediction": 2128.919, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 333838.26, "Total Cost": 333838.27, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 997.165, "Actual Total Time": 1028.451, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 333838.04, "Total Cost": 333838.25, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 996.914, "Actual Total Time": 1028.445, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 332838.04, "Total Cost": 332838.05, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 994.483, "Actual Total Time": 994.493, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 324570.39, "Total Cost": 332833.72, "Plan Rows": 1728, "Plan Width": 0, "Actual Startup Time": 972.952, "Actual Total Time": 994.338, "Actual Rows": 3782, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(at.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_title", "Alias": "at", "Startup Cost": 0.0, "Total Cost": 7698.13, "Plan Rows": 150613, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 10.99, "Actual Rows": 120491, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 324561.94, "Total Cost": 324561.94, "Plan Rows": 676, "Plan Width": 16, "Actual Startup Time": 972.47, "Actual Total Time": 972.478, "Actual Rows": 8521, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 2048, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1744, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 273892.97, "Total Cost": 324561.94, "Plan Rows": 676, "Plan Width": 16, "Actual Startup Time": 700.757, "Actual Total Time": 940.909, "Actual Rows": 8521, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 273892.55, "Total Cost": 324265.32, "Plan Rows": 676, "Plan Width": 20, "Actual Startup Time": 700.725, "Actual Total Time": 926.616, "Actual Rows": 8521, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.027, "Actual Total Time": 102.867, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 273891.84, "Total Cost": 273891.84, "Plan Rows": 57, "Plan Width": 12, "Actual Startup Time": 700.614, "Actual Total Time": 700.62, "Actual Rows": 3286, "Actual Loops": 3, "Hash Buckets": 8192, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 600, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 240074.15, "Total Cost": 273891.84, "Plan Rows": 57, "Plan Width": 12, "Actual Startup Time": 508.504, "Actual Total Time": 660.227, "Actual Rows": 3286, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 240074.0, "Total Cost": 273882.29, "Plan Rows": 57, "Plan Width": 16, "Actual Startup Time": 508.489, "Actual Total Time": 657.082, "Actual Rows": 3286, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 240073.58, "Total Cost": 273811.83, "Plan Rows": 158, "Plan Width": 20, "Actual Startup Time": 508.468, "Actual Total Time": 645.52, "Actual Rows": 4792, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 12, "Actual Startup Time": 0.006, "Actual Total Time": 61.603, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 240073.23, "Total Cost": 240073.23, "Plan Rows": 28, "Plan Width": 8, "Actual Startup Time": 508.303, "Actual Total Time": 508.306, "Actual Rows": 3554, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 760, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.86, "Total Cost": 240073.23, "Plan Rows": 28, "Plan Width": 8, "Actual Startup Time": 123.019, "Actual Total Time": 468.89, "Actual Rows": 3554, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 239810.89, "Plan Rows": 41, "Plan Width": 4, "Actual Startup Time": 122.991, "Actual Total Time": 455.327, "Actual Rows": 3560, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 239795.93, "Plan Rows": 4599, "Plan Width": 8, "Actual Startup Time": 19.587, "Actual Total Time": 454.672, "Actual Rows": 3603, "Actual Loops": 3, "Filter": "((note)::text ~~ '%internet%'::text)", "Rows Removed by Filter": 4941637}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.033, "Actual Total Time": 0.033, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.022, "Actual Total Time": 0.028, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 6.4, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 10679, "Index Cond": "(id = mi.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 1990)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 14377, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 9857, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 9857}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 25564, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 25564}]}]}]}]}]}]}, "Planning Time": 99.414, "Triggers": [], "Execution Time": 1028.599}]
[{"Bao": {"Bao prediction": 2374.587, "Bao recommended hint": "SET enable_mergejoin TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 409637.01, "Total Cost": 409637.02, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3116.781, "Actual Total Time": 3150.997, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 392410.02, "Total Cost": 409637.01, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 3012.533, "Actual Total Time": 3150.611, "Actual Rows": 8373, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 392409.87, "Total Cost": 409636.82, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 3012.515, "Actual Total Time": 3131.623, "Actual Rows": 24852, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 391409.87, "Total Cost": 408636.72, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 3010.619, "Actual Total Time": 3105.736, "Actual Rows": 8284, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 561109, "Plan Width": 8, "Actual Startup Time": 0.029, "Actual Total Time": 76.086, "Actual Rows": 447629, "Actual Loops": 3, "Filter": "((info)::text < '8.5'::text)", "Rows Removed by Filter": 12383}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 391409.86, "Total Cost": 391409.86, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2999.448, "Actual Total Time": 2999.457, "Actual Rows": 2831, "Actual Loops": 3, "Hash Buckets": 8192, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 632, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 341037.45, "Total Cost": 391409.86, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1889.349, "Actual Total Time": 2711.274, "Actual Rows": 2831, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 341037.3, "Total Cost": 391409.69, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 1889.336, "Actual Total Time": 2708.87, "Actual Rows": 2831, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 341036.88, "Total Cost": 391409.24, "Plan Rows": 1, "Plan Width": 28, "Actual Startup Time": 1878.724, "Actual Total Time": 2133.881, "Actual Rows": 390194, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.012, "Actual Total Time": 97.971, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 341036.87, "Total Cost": 341036.87, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1878.468, "Actual Total Time": 1878.475, "Actual Rows": 3970, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 984, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 305720.35, "Total Cost": 341036.87, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1700.734, "Actual Total Time": 1843.831, "Actual Rows": 3970, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 305719.93, "Total Cost": 341036.32, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 1700.713, "Actual Total Time": 1836.276, "Actual Rows": 4197, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 35097.06, "Plan Rows": 58487, "Plan Width": 12, "Actual Startup Time": 0.018, "Actual Total Time": 126.879, "Actual Rows": 101090, "Actual Loops": 3, "Filter": "(((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))", "Rows Removed by Filter": 768619}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 305719.91, "Total Cost": 305719.91, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1700.419, "Actual Total Time": 1700.425, "Actual Rows": 1480, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 312, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2470.17, "Total Cost": 305719.91, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 997.709, "Actual Total Time": 1347.895, "Actual Rows": 1480, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2470.02, "Total Cost": 305719.74, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 997.702, "Actual Total Time": 1346.156, "Actual Rows": 1663, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2469.59, "Total Cost": 305719.05, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 997.496, "Actual Total Time": 1310.072, "Actual Rows": 10350, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2469.44, "Total Cost": 305718.02, "Plan Rows": 6, "Plan Width": 12, "Actual Startup Time": 997.435, "Actual Total Time": 1296.3, "Actual Rows": 14851, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2467.01, "Total Cost": 305713.85, "Plan Rows": 642, "Plan Width": 16, "Actual Startup Time": 40.076, "Actual Total Time": 1293.495, "Actual Rows": 20566, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 302038.28, "Plan Rows": 320570, "Plan Width": 8, "Actual Startup Time": 0.701, "Actual Total Time": 1190.493, "Actual Rows": 238737, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))", "Rows Removed by Filter": 4706503}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2457.5, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 39.107, "Actual Total Time": 39.109, "Actual Rows": 85941, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 1024, "Hash Batches": 2, "Original Hash Batches": 1, "Peak Memory Usage": 3073, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 0.035, "Actual Total Time": 26.903, "Actual Rows": 85941, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.subject_id = cct1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.014, "Actual Total Time": 9.311, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.01, "Actual Total Time": 0.011, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.008, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'cast'::text)", "Rows Removed by Filter": 3}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.031, "Actual Total Time": 0.032, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.025, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'countries'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "comp_cast_type_pkey", "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 44552, "Index Cond": "(id = cc.status_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'complete'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.68, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 31050, "Index Cond": "(id = mi.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2005)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 4990, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = ANY ('{movie,episode}'::text[]))", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.55, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 12591, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text <> '[us]'::text)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 1170582, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 8493, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 8493}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 24852, "Index Cond": "(id = mi_idx.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 1}]}]}, "Planning Time": 236.599, "Triggers": [], "Execution Time": 3151.133}]
[{"Bao": {"Bao prediction": 1249.5, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 101499.5, "Total Cost": 101499.51, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 402.343, "Actual Total Time": 406.957, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 85657.89, "Total Cost": 101499.5, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 341.254, "Actual Total Time": 406.951, "Actual Rows": 8, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 85657.75, "Total Cost": 101499.31, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 341.225, "Actual Total Time": 406.919, "Actual Rows": 24, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 84657.75, "Total Cost": 100499.21, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 379.18, "Actual Total Time": 399.47, "Actual Rows": 8, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx1.movie_id = t1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx1", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.006, "Actual Total Time": 30.348, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 84657.74, "Total Cost": 84657.74, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 337.921, "Actual Total Time": 337.932, "Actual Rows": 3, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50919.57, "Total Cost": 84657.74, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 277.081, "Actual Total Time": 337.894, "Actual Rows": 3, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50919.15, "Total Cost": 84657.29, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 216.718, "Actual Total Time": 337.829, "Actual Rows": 10, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc1.movie_id = t1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc1", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.018, "Actual Total Time": 60.507, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50919.14, "Total Cost": 50919.14, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 216.061, "Actual Total Time": 216.07, "Actual Rows": 4, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 17176.91, "Total Cost": 50919.14, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 116.863, "Actual Total Time": 215.981, "Actual Rows": 4, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(kt1.id = t1.kind_id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 17176.48, "Total Cost": 50914.65, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 116.851, "Actual Total Time": 215.953, "Actual Rows": 4, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 17176.06, "Total Cost": 50914.21, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 116.82, "Actual Total Time": 215.898, "Actual Rows": 4, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc2.movie_id = t2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc2", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.014, "Actual Total Time": 62.346, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 17176.05, "Total Cost": 17176.05, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 94.304, "Actual Total Time": 94.31, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 860.69, "Total Cost": 17176.05, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 44.704, "Actual Total Time": 94.286, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": false, "Join Filter": "(kt2.id = t2.kind_id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 860.69, "Total Cost": 17129.91, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 44.688, "Actual Total Time": 94.263, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ml.linked_movie_id = t2.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 860.26, "Total Cost": 17128.43, "Plan Rows": 2, "Plan Width": 12, "Actual Startup Time": 11.088, "Actual Total Time": 94.149, "Actual Rows": 11, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ml.link_type_id = lt.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 840.36, "Total Cost": 17108.12, "Plan Rows": 158, "Plan Width": 16, "Actual Startup Time": 8.726, "Actual Total Time": 94.053, "Actual Rows": 362, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx2.movie_id = ml.linked_movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15867.61, "Plan Rows": 2412, "Plan Width": 4, "Actual Startup Time": 0.103, "Actual Total Time": 83.794, "Actual Rows": 8530, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx2.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx2", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 272632, "Plan Width": 8, "Actual Startup Time": 0.016, "Actual Total Time": 70.965, "Actual Rows": 218320, "Actual Loops": 3, "Filter": "((info)::text < '3.0'::text)", "Rows Removed by Filter": 241691}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.024, "Actual Total Time": 0.025, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.022, "Actual Total Time": 0.023, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 462.97, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 12, "Actual Startup Time": 8.223, "Actual Total Time": 8.224, "Actual Rows": 29997, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 32768, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1545, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 12, "Actual Startup Time": 0.01, "Actual Total Time": 3.905, "Actual Rows": 29997, "Actual Loops": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 19.76, "Total Cost": 19.76, "Plan Rows": 11, "Plan Width": 4, "Actual Startup Time": 0.049, "Actual Total Time": 0.049, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.0, "Total Cost": 19.76, "Plan Rows": 11, "Plan Width": 4, "Actual Startup Time": 0.039, "Actual Total Time": 0.044, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((link)::text = ANY ('{sequel,follows,\"followed by\"}'::text[]))", "Rows Removed by Filter": 16}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t2", "Startup Cost": 0.43, "Total Cost": 0.73, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.009, "Actual Total Time": 0.009, "Actual Rows": 0, "Actual Loops": 34, "Index Cond": "(id = mi_idx2.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 2005) AND (production_year <= 2008))", "Rows Removed by Filter": 1}]}, {"Node Type": "Nested Loop", "Parent Relationship": "Inner", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 45.82, "Plan Rows": 25, "Plan Width": 8, "Actual Startup Time": 0.008, "Actual Total Time": 0.009, "Actual Rows": 1, "Actual Loops": 6, "Inner Unique": false, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "kind_type", "Alias": "kt2", "Startup Cost": 0.0, "Total Cost": 22.75, "Plan Rows": 5, "Plan Width": 4, "Actual Startup Time": 0.006, "Actual Total Time": 0.007, "Actual Rows": 1, "Actual Loops": 6, "Filter": "((kind)::text = 'tv series'::text)", "Rows Removed by Filter": 6}, {"Node Type": "Materialize", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 0.0, "Total Cost": 22.77, "Plan Rows": 5, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 6, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "kind_type", "Alias": "kt1", "Startup Cost": 0.0, "Total Cost": 22.75, "Plan Rows": 5, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 2, "Filter": "((kind)::text = 'tv series'::text)", "Rows Removed by Filter": 6}]}]}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn2", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.013, "Actual Rows": 1, "Actual Loops": 11, "Index Cond": "(id = mc2.company_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 11}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t1", "Startup Cost": 0.43, "Total Cost": 4.47, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.006, "Actual Total Time": 0.006, "Actual Rows": 1, "Actual Loops": 11, "Index Cond": "(id = ml.movie_id)", "Rows Removed by Index Recheck": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn1", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.006, "Actual Total Time": 0.006, "Actual Rows": 0, "Actual Loops": 29, "Index Cond": "(id = mc1.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 24, "Index Cond": "(id = mi_idx1.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 1}]}]}, "Planning Time": 247.122, "Triggers": [], "Execution Time": 407.111}]
[{"Bao": {"Bao prediction": 2910.674, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 908558.61, "Total Cost": 908558.62, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2874.033, "Actual Total Time": 2926.84, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 891997.92, "Total Cost": 908558.61, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2758.758, "Actual Total Time": 2926.037, "Actual Rows": 16308, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 891997.78, "Total Cost": 908558.42, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2758.64, "Actual Total Time": 2871.333, "Actual Rows": 67827, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 891997.63, "Total Cost": 908557.69, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2758.627, "Actual Total Time": 2818.405, "Actual Rows": 67827, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 890997.63, "Total Cost": 907557.59, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2710.265, "Actual Total Time": 2728.8, "Actual Rows": 22609, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 23.104, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 890997.62, "Total Cost": 890997.62, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2679.384, "Actual Total Time": 2679.402, "Actual Rows": 5114, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1112, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 822953.04, "Total Cost": 890997.62, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2525.06, "Actual Total Time": 2676.56, "Actual Rows": 5114, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(pi.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "person_info", "Alias": "pi", "Startup Cost": 0.0, "Total Cost": 63409.96, "Plan Rows": 1235896, "Plan Width": 8, "Actual Startup Time": 0.017, "Actual Total Time": 87.608, "Actual Rows": 987888, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 822953.03, "Total Cost": 822953.03, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 2521.17, "Actual Total Time": 2521.187, "Actual Rows": 15, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 772575.87, "Total Cost": 822953.03, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 2435.008, "Actual Total Time": 2521.137, "Actual Rows": 15, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 772575.45, "Total Cost": 822951.0, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2434.983, "Actual Total Time": 2520.92, "Actual Rows": 69, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 772575.03, "Total Cost": 822947.39, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2255.567, "Actual Total Time": 2452.7, "Actual Rows": 50295, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.025, "Actual Total Time": 100.854, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 772575.01, "Total Cost": 772575.01, "Plan Rows": 1, "Plan Width": 36, "Actual Startup Time": 2233.968, "Actual Total Time": 2233.983, "Actual Rows": 357, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 136, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 516740.22, "Total Cost": 772575.01, "Plan Rows": 1, "Plan Width": 36, "Actual Startup Time": 1735.593, "Actual Total Time": 2233.821, "Actual Rows": 357, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 516739.79, "Total Cost": 772572.85, "Plan Rows": 1, "Plan Width": 32, "Actual Startup Time": 1735.569, "Actual Total Time": 2232.944, "Actual Rows": 548, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 516739.65, "Total Cost": 772572.66, "Plan Rows": 1, "Plan Width": 36, "Actual Startup Time": 1735.551, "Actual Total Time": 2232.418, "Actual Rows": 548, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 255356.52, "Plan Rows": 127064, "Plan Width": 8, "Actual Startup Time": 83.338, "Actual Total Time": 754.358, "Actual Rows": 150368, "Actual Loops": 3, "Filter": "((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))", "Rows Removed by Filter": 4794872}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 516739.63, "Total Cost": 516739.63, "Plan Rows": 1, "Plan Width": 28, "Actual Startup Time": 1467.766, "Actual Total Time": 1467.778, "Actual Rows": 371, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 483001.49, "Total Cost": 516739.63, "Plan Rows": 1, "Plan Width": 28, "Actual Startup Time": 1348.969, "Actual Total Time": 1467.608, "Actual Rows": 371, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.014, "Actual Total Time": 61.792, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 483001.48, "Total Cost": 483001.48, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1345.664, "Actual Total Time": 1345.669, "Actual Rows": 22, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2479.34, "Total Cost": 483001.48, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 454.562, "Actual Total Time": 1345.604, "Actual Rows": 22, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2478.91, "Total Cost": 482999.23, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 454.536, "Actual Total Time": 1345.445, "Actual Rows": 25, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2478.48, "Total Cost": 482994.56, "Plan Rows": 2, "Plan Width": 20, "Actual Startup Time": 36.552, "Actual Total Time": 1338.376, "Actual Rows": 2376, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 479115.98, "Plan Rows": 373356, "Plan Width": 16, "Actual Startup Time": 0.041, "Actual Total Time": 1265.46, "Actual Rows": 289159, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(voice),\"(voice: Japanese version)\",\"(voice) (uncredited)\",\"(voice: English version)\"}'::text[]))", "Rows Removed by Filter": 11792289}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2478.43, "Total Cost": 2478.43, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 36.37, "Actual Total Time": 36.373, "Actual Rows": 17879, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 885, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 37.85, "Total Cost": 2478.43, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.05, "Actual Total Time": 34.097, "Actual Rows": 17879, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.status_id = cct2.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 0.022, "Actual Total Time": 27.414, "Actual Rows": 85941, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.subject_id = cct1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.009, "Actual Total Time": 9.406, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'cast'::text)", "Rows Removed by Filter": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.019, "Actual Total Time": 0.02, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.015, "Actual Total Time": 0.016, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'complete+verified'::text)", "Rows Removed by Filter": 3}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 2.33, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 7127, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 2.24, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.005, "Actual Total Time": 0.005, "Actual Rows": 1, "Actual Loops": 76, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 67}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 1644, "Index Cond": "(id = mi.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 2.15, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 1644, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 2000) AND (production_year <= 2010))", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 2.02, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 150884, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = 'computer-animation'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 2.03, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 206, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "role_type_pkey", "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.15, "Total Cost": 0.57, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 67827, "Index Cond": "(id = ci.role_id)", "Rows Removed by Index Recheck": 0, "Filter": "((role)::text = 'actress'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it3", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 67827, "Index Cond": "(id = pi.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'trivia'::text)", "Rows Removed by Filter": 1}]}]}, "Planning Time": 301.997, "Triggers": [], "Execution Time": 2926.994}]
[{"Bao": {"Bao prediction": 2683.381, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 499622.06, "Total Cost": 499622.07, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1320.914, "Actual Total Time": 1352.63, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 499621.85, "Total Cost": 499622.06, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 1320.673, "Actual Total Time": 1352.625, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 498621.85, "Total Cost": 498621.86, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1318.392, "Actual Total Time": 1318.397, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 482053.13, "Total Cost": 498621.85, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1310.294, "Actual Total Time": 1318.393, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 482052.7, "Total Cost": 498619.64, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1310.258, "Actual Total Time": 1318.314, "Actual Rows": 8, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 482052.27, "Total Cost": 498618.87, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1266.115, "Actual Total Time": 1316.696, "Actual Rows": 915, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 482051.85, "Total Cost": 498611.8, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1266.088, "Actual Total Time": 1315.108, "Actual Rows": 917, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = ci.person_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.025, "Actual Total Time": 24.746, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 482051.83, "Total Cost": 482051.83, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1264.535, "Actual Total Time": 1264.538, "Actual Rows": 360, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 441518.14, "Total Cost": 482051.83, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1156.672, "Actual Total Time": 1264.39, "Actual Rows": 360, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 40532.74, "Plan Rows": 251, "Plan Width": 8, "Actual Startup Time": 0.061, "Actual Total Time": 109.457, "Actual Rows": 2856, "Actual Loops": 3, "Filter": "(((note)::text ~~ '%(Japan)%'::text) AND ((note)::text !~~ '%(USA)%'::text) AND (((note)::text ~~ '%(2006)%'::text) OR ((note)::text ~~ '%(2007)%'::text)))", "Rows Removed by Filter": 866853}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 441514.99, "Total Cost": 441514.99, "Plan Rows": 252, "Plan Width": 8, "Actual Startup Time": 1154.367, "Actual Total Time": 1154.368, "Actual Rows": 11616, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2424, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 441514.99, "Plan Rows": 252, "Plan Width": 8, "Actual Startup Time": 324.309, "Actual Total Time": 918.44, "Actual Rows": 11616, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 441377.81, "Plan Rows": 44782, "Plan Width": 12, "Actual Startup Time": 0.473, "Actual Total Time": 915.261, "Actual Rows": 31032, "Actual Loops": 3, "Filter": "((note)::text = '(voice: English version)'::text)", "Rows Removed by Filter": 12050416}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.03, "Actual Total Time": 0.031, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.025, "Actual Total Time": 0.026, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((role)::text = 'actress'::text)", "Rows Removed by Filter": 11}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 7.06, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 2751, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[jp]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.77, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 2745, "Index Cond": "(id = an.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name)::text ~~ '%Yo%'::text) AND ((name)::text !~~ '%Yu%'::text))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 2.13, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.009, "Actual Total Time": 0.009, "Actual Rows": 0, "Actual Loops": 25, "Index Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 2006) AND (production_year <= 2007) AND (((title)::text ~~ 'One Piece%'::text) OR ((title)::text ~~ 'Dragon Ball Z%'::text)))", "Rows Removed by Filter": 1}]}]}]}]}, "Planning Time": 82.431, "Triggers": [], "Execution Time": 1352.748}]
[{"Bao": {"Bao prediction": 3595.761, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 290311.73, "Total Cost": 290311.74, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3183.027, "Actual Total Time": 3215.246, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 48897.35, "Total Cost": 290311.73, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1453.551, "Actual Total Time": 3209.881, "Actual Rows": 111101, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 47897.35, "Total Cost": 289311.63, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1449.206, "Actual Total Time": 3169.69, "Actual Rows": 37034, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 47897.2, "Total Cost": 289311.28, "Plan Rows": 2, "Plan Width": 4, "Actual Startup Time": 1405.774, "Actual Total Time": 3128.982, "Actual Rows": 44730, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 47896.77, "Total Cost": 289310.36, "Plan Rows": 2, "Plan Width": 12, "Actual Startup Time": 1405.755, "Actual Total Time": 3044.206, "Actual Rows": 44730, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 47896.35, "Total Cost": 289289.85, "Plan Rows": 46, "Plan Width": 16, "Actual Startup Time": 1405.109, "Actual Total Time": 1670.435, "Actual Rows": 834997, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mc.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 241189.17, "Plan Rows": 55082, "Plan Width": 4, "Actual Startup Time": 210.119, "Actual Total Time": 819.695, "Actual Rows": 1012240, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 224235.35, "Plan Rows": 6224235, "Plan Width": 8, "Actual Startup Time": 0.017, "Actual Total Time": 392.091, "Actual Rows": 4945240, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 0.018, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.01, "Actual Total Time": 0.016, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 47891.91, "Total Cost": 47891.91, "Plan Rows": 161, "Plan Width": 12, "Actual Startup Time": 475.619, "Actual Total Time": 475.991, "Actual Rows": 194741, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 4000, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 15336.14, "Total Cost": 47891.91, "Plan Rows": 161, "Plan Width": 12, "Actual Startup Time": 340.634, "Actual Total Time": 429.918, "Actual Rows": 194741, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = miidx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 32551.06, "Plan Rows": 6125, "Plan Width": 8, "Actual Startup Time": 63.609, "Actual Total Time": 165.58, "Actual Rows": 444961, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 12, "Actual Startup Time": 0.007, "Actual Total Time": 65.784, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.018, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.016, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 15253.6, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 119.958, "Actual Total Time": 119.959, "Actual Rows": 153308, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 16384, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 3360, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 0.054, "Actual Total Time": 81.771, "Actual Rows": 153308, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(miidx.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "miidx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.013, "Actual Total Time": 34.527, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.031, "Actual Total Time": 0.031, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.024, "Actual Total Time": 0.026, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 2504990, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[de]'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 134189, "Index Cond": "(id = mi.movie_id)", "Rows Removed by Index Recheck": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 134189, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'movie'::text)", "Rows Removed by Filter": 0}]}]}]}, "Planning Time": 91.387, "Triggers": [], "Execution Time": 3215.349}]
[{"Bao": {"Bao prediction": 2250.756, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 890239.54, "Total Cost": 890239.55, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2642.378, "Actual Total Time": 2706.944, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 873678.85, "Total Cost": 890239.53, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2639.552, "Actual Total Time": 2706.855, "Actual Rows": 1620, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 873678.7, "Total Cost": 890238.8, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2639.546, "Actual Total Time": 2705.66, "Actual Rows": 1620, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 873678.56, "Total Cost": 890238.61, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2639.532, "Actual Total Time": 2704.268, "Actual Rows": 1620, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 872678.56, "Total Cost": 889238.51, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2621.264, "Actual Total Time": 2636.351, "Actual Rows": 540, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 24.554, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 872678.54, "Total Cost": 872678.54, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2589.827, "Actual Total Time": 2589.84, "Actual Rows": 180, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 804633.93, "Total Cost": 872678.54, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2486.6, "Actual Total Time": 2589.784, "Actual Rows": 180, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 804633.78, "Total Cost": 872678.36, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2434.786, "Actual Total Time": 2589.213, "Actual Rows": 543, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(pi.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "person_info", "Alias": "pi", "Startup Cost": 0.0, "Total Cost": 63409.96, "Plan Rows": 1235896, "Plan Width": 8, "Actual Startup Time": 0.009, "Actual Total Time": 90.561, "Actual Rows": 987888, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 804633.77, "Total Cost": 804633.77, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2430.868, "Actual Total Time": 2430.878, "Actual Rows": 3, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 754254.58, "Total Cost": 804633.77, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2413.857, "Actual Total Time": 2430.852, "Actual Rows": 3, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 754254.15, "Total Cost": 804629.7, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2413.853, "Actual Total Time": 2430.843, "Actual Rows": 3, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 754253.73, "Total Cost": 804626.09, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2413.735, "Actual Total Time": 2430.269, "Actual Rows": 360, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.007, "Actual Total Time": 100.728, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 754253.71, "Total Cost": 754253.71, "Plan Rows": 1, "Plan Width": 40, "Actual Startup Time": 2228.146, "Actual Total Time": 2228.155, "Actual Rows": 3, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 292662.72, "Total Cost": 754253.71, "Plan Rows": 1, "Plan Width": 40, "Actual Startup Time": 1949.384, "Actual Total Time": 2228.132, "Actual Rows": 3, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 292662.57, "Total Cost": 754252.98, "Plan Rows": 1, "Plan Width": 44, "Actual Startup Time": 1949.381, "Actual Total Time": 2228.125, "Actual Rows": 3, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 292662.14, "Total Cost": 754250.63, "Plan Rows": 1, "Plan Width": 40, "Actual Startup Time": 1004.949, "Actual Total Time": 2227.863, "Actual Rows": 127, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 460246.89, "Plan Rows": 357758, "Plan Width": 16, "Actual Startup Time": 0.047, "Actual Total Time": 1218.461, "Actual Rows": 278900, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(voice),\"(voice) (uncredited)\",\"(voice: English version)\"}'::text[]))", "Rows Removed by Filter": 11802548}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 292662.13, "Total Cost": 292662.13, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 992.994, "Actual Total Time": 993.0, "Actual Rows": 3, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 258922.37, "Total Cost": 292662.13, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 963.814, "Actual Total Time": 992.968, "Actual Rows": 3, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 258921.95, "Total Cost": 292660.1, "Plan Rows": 1, "Plan Width": 28, "Actual Startup Time": 963.799, "Actual Total Time": 992.918, "Actual Rows": 15, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.011, "Actual Total Time": 68.558, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 258921.94, "Total Cost": 258921.94, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 864.732, "Actual Total Time": 864.736, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2467.44, "Total Cost": 258921.94, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 862.628, "Actual Total Time": 864.209, "Actual Rows": 1, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2467.01, "Total Cost": 258302.57, "Plan Rows": 255, "Plan Width": 16, "Actual Startup Time": 210.015, "Actual Total Time": 844.589, "Actual Rows": 5875, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 255356.52, "Plan Rows": 127064, "Plan Width": 8, "Actual Startup Time": 86.898, "Actual Total Time": 762.397, "Actual Rows": 150368, "Actual Loops": 3, "Filter": "((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))", "Rows Removed by Filter": 4794872}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2457.5, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 38.196, "Actual Total Time": 38.198, "Actual Rows": 85941, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 1024, "Hash Batches": 2, "Original Hash Batches": 1, "Peak Memory Usage": 3073, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 0.047, "Actual Total Time": 26.248, "Actual Rows": 85941, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.subject_id = cct1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.021, "Actual Total Time": 8.905, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.017, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.007, "Actual Total Time": 0.008, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'cast'::text)", "Rows Removed by Filter": 3}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 2.43, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 17626, "Index Cond": "(id = mi.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 2000) AND (production_year <= 2010) AND ((title)::text = 'Shrek 2'::text))", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 2.03, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 44, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 2.34, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 380, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "role_type_pkey", "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.15, "Total Cost": 0.57, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 10, "Index Cond": "(id = ci.role_id)", "Rows Removed by Index Recheck": 0, "Filter": "((role)::text = 'actress'::text)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 2.02, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 1080, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = 'computer-animation'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 2.25, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 10, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name)::text = 'Queen'::text)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it3", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 1630, "Index Cond": "(id = pi.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'trivia'::text)", "Rows Removed by Filter": 1}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 1620, "Index Cond": "(id = mi.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "comp_cast_type_pkey", "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.15, "Total Cost": 0.57, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 1620, "Index Cond": "(id = cc.status_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'complete+verified'::text)", "Rows Removed by Filter": 0}]}]}, "Planning Time": 294.644, "Triggers": [], "Execution Time": 2707.107}]
[{"Bao": {"Bao prediction": 2069.596, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 513186.8, "Total Cost": 513186.81, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1976.359, "Actual Total Time": 2011.728, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 52939.71, "Total Cost": 513186.79, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 442.121, "Actual Total Time": 2011.722, "Actual Rows": 12, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 52939.28, "Total Cost": 513186.34, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 299.792, "Actual Total Time": 2010.519, "Actual Rows": 383, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 51939.28, "Total Cost": 512186.24, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 311.975, "Actual Total Time": 1973.72, "Actual Rows": 128, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.022, "Actual Total Time": 859.808, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 51939.27, "Total Cost": 51939.27, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 262.557, "Actual Total Time": 262.56, "Actual Rows": 12, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3632.93, "Total Cost": 51939.27, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 115.99, "Actual Total Time": 262.467, "Actual Rows": 12, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3632.5, "Total Cost": 51884.41, "Plan Rows": 112, "Plan Width": 4, "Actual Startup Time": 28.562, "Actual Total Time": 230.406, "Actual Rows": 11849, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 98.228, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 3632.4, "Total Cost": 3632.4, "Plan Rows": 8, "Plan Width": 4, "Actual Startup Time": 28.418, "Actual Total Time": 28.419, "Actual Rows": 8, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 3632.4, "Plan Rows": 8, "Plan Width": 4, "Actual Startup Time": 0.125, "Actual Total Time": 28.411, "Actual Rows": 8, "Actual Loops": 3, "Filter": "((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))", "Rows Removed by Filter": 134162}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 35548, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2014)", "Rows Removed by Filter": 1}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 383, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name)::text ~~ '%Downey%Robert%'::text)", "Rows Removed by Filter": 1}]}]}, "Planning Time": 77.701, "Triggers": [], "Execution Time": 2011.787}]
[{"Bao": {"Bao prediction": 4399.98, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 806451.6, "Total Cost": 806451.61, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2211.341, "Actual Total Time": 2268.699, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 806451.38, "Total Cost": 806451.59, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2210.126, "Actual Total Time": 2268.694, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 805451.38, "Total Cost": 805451.39, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2207.557, "Actual Total Time": 2207.567, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 755078.03, "Total Cost": 805451.38, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2201.538, "Actual Total Time": 2207.564, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 755077.6, "Total Cost": 805450.3, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2201.528, "Actual Total Time": 2207.551, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 755077.18, "Total Cost": 805449.54, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2201.502, "Actual Total Time": 2207.499, "Actual Rows": 12, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.006, "Actual Total Time": 100.583, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 755077.17, "Total Cost": 755077.17, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2006.519, "Actual Total Time": 2006.527, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 255156.14, "Total Cost": 755077.17, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1832.713, "Actual Total Time": 2006.499, "Actual Rows": 1, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 497985.06, "Plan Rows": 516258, "Plan Width": 8, "Actual Startup Time": 91.566, "Actual Total Time": 1369.516, "Actual Rows": 414905, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(writer),\"(head writer)\",\"(written by)\",(story),\"(story editor)\"}'::text[]))", "Rows Removed by Filter": 11666543}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 255156.13, "Total Cost": 255156.13, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 613.7, "Actual Total Time": 613.707, "Actual Rows": 3, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 15320.07, "Total Cost": 255156.13, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 588.3, "Actual Total Time": 612.258, "Actual Rows": 3, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 15319.64, "Total Cost": 255153.32, "Plan Rows": 3, "Plan Width": 8, "Actual Startup Time": 575.622, "Actual Total Time": 587.998, "Actual Rows": 5493, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 239835.65, "Plan Rows": 121, "Plan Width": 4, "Actual Startup Time": 400.998, "Actual Total Time": 450.966, "Actual Rows": 10138, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 239795.93, "Plan Rows": 13693, "Plan Width": 8, "Actual Startup Time": 283.768, "Actual Total Time": 449.571, "Actual Rows": 10267, "Actual Loops": 3, "Filter": "((info)::text = 'Horror'::text)", "Rows Removed by Filter": 4934973}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.017, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'genres'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 15253.6, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 118.396, "Actual Total Time": 118.398, "Actual Rows": 153308, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 16384, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 3360, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 0.052, "Actual Total Time": 80.209, "Actual Rows": 153308, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.013, "Actual Total Time": 33.922, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.028, "Actual Total Time": 0.028, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.022, "Actual Total Time": 0.023, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'votes'::text)", "Rows Removed by Filter": 112}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.92, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 0, "Actual Loops": 16480, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year > 2010) AND ((title)::text ~~ 'Vampire%'::text))", "Rows Removed by Filter": 1}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.67, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 0, "Actual Loops": 35, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,blood,gore,death,female-nudity}'::text[]))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 1.08, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.005, "Actual Total Time": 0.005, "Actual Rows": 1, "Actual Loops": 6, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((gender)::text = 'm'::text)", "Rows Removed by Filter": 0}]}]}]}]}, "Planning Time": 97.086, "Triggers": [], "Execution Time": 2268.793}]
[{"Bao": {"Bao prediction": 4050.173, "Bao recommended hint": "SET enable_mergejoin TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 358497.35, "Total Cost": 358497.36, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 831.623, "Actual Total Time": 863.565, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 358497.13, "Total Cost": 358497.34, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 831.441, "Actual Total Time": 863.56, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 357497.13, "Total Cost": 357497.14, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 828.894, "Actual Total Time": 828.903, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 307124.75, "Total Cost": 357497.13, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 759.066, "Actual Total Time": 828.889, "Actual Rows": 209, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 307124.33, "Total Cost": 357496.69, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 759.022, "Actual Total Time": 828.408, "Actual Rows": 209, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.019, "Actual Total Time": 105.319, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 307124.32, "Total Cost": 307124.32, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 621.83, "Actual Total Time": 621.838, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 273385.87, "Total Cost": 307124.32, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 564.381, "Actual Total Time": 621.757, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 273385.72, "Total Cost": 307124.15, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 564.358, "Actual Total Time": 621.73, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 273385.29, "Total Cost": 307123.61, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 564.329, "Actual Total Time": 621.696, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 273385.15, "Total Cost": 307123.35, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 564.319, "Actual Total Time": 621.683, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 273385.0, "Total Cost": 307123.18, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 564.297, "Actual Total Time": 621.657, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 273384.58, "Total Cost": 307122.73, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 564.267, "Actual Total Time": 621.608, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 12, "Actual Startup Time": 0.013, "Actual Total Time": 62.847, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 273384.57, "Total Cost": 273384.57, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 499.067, "Actual Total Time": 499.069, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2467.01, "Total Cost": 273384.57, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 233.367, "Actual Total Time": 499.001, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 270917.11, "Plan Rows": 117, "Plan Width": 8, "Actual Startup Time": 128.752, "Actual Total Time": 475.558, "Actual Rows": 594, "Actual Loops": 3, "Filter": "((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))", "Rows Removed by Filter": 4944646}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2457.5, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 4, "Actual Startup Time": 23.25, "Actual Total Time": 23.251, "Actual Rows": 24592, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1121, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 4, "Actual Startup Time": 0.048, "Actual Total Time": 20.298, "Actual Rows": 24592, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.status_id = cct1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 8, "Actual Startup Time": 0.02, "Actual Total Time": 8.572, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.017, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.008, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'complete+verified'::text)", "Rows Removed by Filter": 3}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.019, "Actual Total Time": 0.019, "Actual Rows": 1, "Actual Loops": 7, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.009, "Actual Total Time": 0.009, "Actual Rows": 1, "Actual Loops": 7, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 7}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.14, "Total Cost": 0.21, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 1, "Actual Loops": 7, "Index Cond": "(id = mi.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.52, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.013, "Actual Total Time": 0.013, "Actual Rows": 1, "Actual Loops": 7, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 1990)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.01, "Actual Total Time": 0.01, "Actual Rows": 1, "Actual Loops": 7, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = ANY ('{movie,\"tv movie\",\"video movie\",\"video game\"}'::text[]))", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 628, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 628}]}]}]}]}, "Planning Time": 135.891, "Triggers": [], "Execution Time": 863.735}]
[{"Bao": {"Bao prediction": 2398.123, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 323081.74, "Total Cost": 323081.75, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1084.524, "Actual Total Time": 1115.779, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 272709.06, "Total Cost": 323081.74, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1083.34, "Actual Total Time": 1115.771, "Actual Rows": 38, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 271709.06, "Total Cost": 322081.64, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1013.0, "Actual Total Time": 1080.909, "Actual Rows": 13, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 271708.64, "Total Cost": 322081.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 874.805, "Actual Total Time": 1080.359, "Actual Rows": 405, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.007, "Actual Total Time": 102.437, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 271708.62, "Total Cost": 271708.62, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 873.248, "Actual Total Time": 873.255, "Actual Rows": 147, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 271708.04, "Total Cost": 271708.62, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 869.553, "Actual Total Time": 872.306, "Actual Rows": 147, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ml.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 271707.61, "Total Cost": 271708.02, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 869.526, "Actual Total Time": 871.635, "Actual Rows": 357, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Merge Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 271707.19, "Total Cost": 271707.56, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 869.46, "Actual Total Time": 869.904, "Actual Rows": 970, "Actual Loops": 3, "Inner Unique": false, "Merge Cond": "(mc.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 271144.99, "Total Cost": 271146.93, "Plan Rows": 775, "Plan Width": 12, "Actual Startup Time": 864.803, "Actual Total Time": 864.858, "Actual Rows": 769, "Actual Loops": 3, "Sort Key": ["mc.movie_id"], "Sort Method": "quicksort", "Sort Space Used": 3207, "Sort Space Type": "Memory", "Workers": [{"Worker Number": 0, "Sort Method": "quicksort", "Sort Space Used": 3199, "Sort Space Type": "Memory"}, {"Worker Number": 1, "Sort Method": "quicksort", "Sort Space Used": 3145, "Sort Space Type": "Memory"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 31120.35, "Total Cost": 271107.8, "Plan Rows": 775, "Plan Width": 12, "Actual Startup Time": 818.007, "Actual Total Time": 856.356, "Actual Rows": 38777, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 239795.93, "Plan Rows": 50209, "Plan Width": 4, "Actual Startup Time": 0.275, "Actual Total Time": 593.388, "Actual Rows": 38853, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Germany,German}'::text[]))", "Rows Removed by Filter": 4906387}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 31082.95, "Total Cost": 31082.95, "Plan Rows": 2992, "Plan Width": 8, "Actual Startup Time": 214.295, "Actual Total Time": 214.297, "Actual Rows": 397976, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 8192, "Hash Batches": 16, "Original Hash Batches": 1, "Peak Memory Usage": 3520, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 31082.95, "Plan Rows": 2992, "Plan Width": 8, "Actual Startup Time": 37.146, "Actual Total Time": 134.31, "Actual Rows": 397976, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 531175, "Plan Width": 12, "Actual Startup Time": 0.028, "Actual Total Time": 81.243, "Actual Rows": 423996, "Actual Loops": 3, "Filter": "(note IS NULL)", "Rows Removed by Filter": 445713}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 0.018, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}]}]}]}, {"Node Type": "Sort", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 562.2, "Total Cost": 562.3, "Plan Rows": 42, "Plan Width": 4, "Actual Startup Time": 4.64, "Actual Total Time": 4.772, "Actual Rows": 3086, "Actual Loops": 3, "Sort Key": ["ml.movie_id"], "Sort Method": "quicksort", "Sort Space Used": 205, "Sort Space Type": "Memory", "Workers": [{"Worker Number": 0, "Sort Method": "quicksort", "Sort Space Used": 205, "Sort Space Type": "Memory"}, {"Worker Number": 1, "Sort Method": "quicksort", "Sort Space Used": 205, "Sort Space Type": "Memory"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.89, "Total Cost": 561.07, "Plan Rows": 42, "Plan Width": 4, "Actual Startup Time": 0.042, "Actual Total Time": 4.279, "Actual Rows": 2315, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ml.link_type_id = lt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 8, "Actual Startup Time": 0.018, "Actual Total Time": 1.925, "Actual Rows": 29997, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.015, "Actual Total Time": 0.015, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.01, "Actual Total Time": 0.013, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((link)::text ~~ '%follow%'::text)", "Rows Removed by Filter": 16}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 2911, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.59, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 1072, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 2000) AND (production_year <= 2010))", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 1215, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = 'sequel'::text)", "Rows Removed by Filter": 1}]}]}]}, "Planning Time": 100.096, "Triggers": [], "Execution Time": 1115.875}]
[{"Bao": {"Bao prediction": 2657.587, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 533805.79, "Total Cost": 533805.8, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2459.685, "Actual Total Time": 2504.403, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 533805.58, "Total Cost": 533805.79, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2458.132, "Actual Total Time": 2504.396, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 532805.58, "Total Cost": 532805.59, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2455.843, "Actual Total Time": 2456.003, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 516243.96, "Total Cost": 532804.14, "Plan Rows": 576, "Plan Width": 0, "Actual Startup Time": 2370.731, "Actual Total Time": 2449.227, "Actual Rows": 161027, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.022, "Actual Total Time": 25.246, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 516240.84, "Total Cost": 516240.84, "Plan Rows": 250, "Plan Width": 8, "Actual Startup Time": 2370.362, "Actual Total Time": 2370.521, "Actual Rows": 57856, "Actual Loops": 3, "Hash Buckets": 262144, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 10936, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 482057.58, "Total Cost": 516240.84, "Plan Rows": 250, "Plan Width": 8, "Actual Startup Time": 1852.428, "Actual Total Time": 2329.839, "Actual Rows": 57856, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ci.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 482057.15, "Total Cost": 516108.59, "Plan Rows": 250, "Plan Width": 16, "Actual Startup Time": 1852.408, "Actual Total Time": 2217.385, "Actual Rows": 57856, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 482056.73, "Total Cost": 515797.77, "Plan Rows": 697, "Plan Width": 20, "Actual Startup Time": 1852.376, "Actual Total Time": 1979.988, "Actual Rows": 142133, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.009, "Actual Total Time": 66.682, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 482053.74, "Total Cost": 482053.74, "Plan Rows": 239, "Plan Width": 12, "Actual Startup Time": 1682.463, "Actual Total Time": 1682.466, "Actual Rows": 85164, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 2112, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 19.79, "Total Cost": 482053.74, "Plan Rows": 239, "Plan Width": 12, "Actual Startup Time": 398.68, "Actual Total Time": 1639.959, "Actual Rows": 85164, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 19.36, "Total Cost": 481730.17, "Plan Rows": 490, "Plan Width": 16, "Actual Startup Time": 398.647, "Actual Total Time": 1465.687, "Actual Rows": 92002, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 480120.81, "Plan Rows": 2103, "Plan Width": 12, "Actual Startup Time": 398.615, "Actual Total Time": 1298.224, "Actual Rows": 92055, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 479115.98, "Plan Rows": 373356, "Plan Width": 16, "Actual Startup Time": 0.033, "Actual Total Time": 1267.25, "Actual Rows": 289159, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(voice),\"(voice: Japanese version)\",\"(voice) (uncredited)\",\"(voice: English version)\"}'::text[]))", "Rows Removed by Filter": 11792289}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.021, "Actual Total Time": 0.022, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.018, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((role)::text = 'actress'::text)", "Rows Removed by Filter": 11}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.77, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 276166, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((gender)::text = 'f'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 0.66, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 276005, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 255493}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 426400, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.52, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 173567, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 173567}]}]}]}]}]}]}, "Planning Time": 88.083, "Triggers": [], "Execution Time": 2504.487}]
[{"Bao": {"Bao prediction": 917.102, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 51398.92, "Total Cost": 51398.93, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 222.744, "Actual Total Time": 226.954, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 36128.39, "Total Cost": 51398.92, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 222.581, "Actual Total Time": 226.947, "Actual Rows": 3, "Actual Loops": 1, "Inner Unique": true, "Join Filter": "(mc.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 36127.96, "Total Cost": 51398.33, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 222.5, "Actual Total Time": 226.847, "Actual Rows": 23, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 35127.96, "Total Cost": 50398.23, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 220.48, "Actual Total Time": 220.518, "Actual Rows": 8, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx.movie_id = mc.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 62.517, "Actual Total Time": 62.536, "Actual Rows": 83, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.008, "Actual Total Time": 31.185, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.033, "Actual Total Time": 0.033, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.027, "Actual Total Time": 0.028, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'top 250 rank'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 35125.28, "Total Cost": 35125.28, "Plan Rows": 20, "Plan Width": 4, "Actual Startup Time": 157.613, "Actual Total Time": 157.615, "Actual Rows": 5937, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 952, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 35125.28, "Plan Rows": 20, "Plan Width": 4, "Actual Startup Time": 111.07, "Actual Total Time": 150.234, "Actual Rows": 5937, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 35097.06, "Plan Rows": 3522, "Plan Width": 8, "Actual Startup Time": 86.269, "Actual Total Time": 149.421, "Actual Rows": 5939, "Actual Loops": 3, "Filter": "(((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text) AND ((note)::text ~~ '%(co-production)%'::text))", "Rows Removed by Filter": 863771}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.022, "Actual Total Time": 0.023, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 0.017, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.58, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 0, "Actual Loops": 23, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2010)", "Rows Removed by Filter": 1}]}]}, "Planning Time": 78.049, "Triggers": [], "Execution Time": 227.04}]
[{"Bao": {"Bao prediction": 1563.728, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 279580.04, "Total Cost": 279580.05, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 721.772, "Actual Total Time": 747.885, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 38815.63, "Total Cost": 279580.04, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 721.768, "Actual Total Time": 747.881, "Actual Rows": 0, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 38815.2, "Total Cost": 279579.29, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 721.768, "Actual Total Time": 747.879, "Actual Rows": 0, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 38815.06, "Total Cost": 279579.13, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 721.767, "Actual Total Time": 747.879, "Actual Rows": 0, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 38814.91, "Total Cost": 279567.76, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 168.458, "Actual Total Time": 746.436, "Actual Rows": 1768, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 37814.91, "Total Cost": 278567.66, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 161.68, "Actual Total Time": 719.066, "Actual Rows": 589, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 239795.93, "Plan Rows": 255147, "Plan Width": 8, "Actual Startup Time": 40.989, "Actual Total Time": 592.345, "Actual Rows": 184259, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{USA,America}'::text[]))", "Rows Removed by Filter": 4760981}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 37814.9, "Total Cost": 37814.9, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 110.832, "Actual Total Time": 110.833, "Actual Rows": 473, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 37814.9, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1.225, "Actual Total Time": 110.701, "Actual Rows": 473, "Actual Loops": 3, "Filter": "(((note)::text ~~ '%(VHS)%'::text) AND ((note)::text ~~ '%(USA)%'::text) AND ((note)::text ~~ '%(1994)%'::text))", "Rows Removed by Filter": 869237}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 8.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 1768, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 0, "Actual Loops": 0, "Index Cond": "(id = mi.info_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.74, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 0, "Actual Loops": 0, "Index Cond": "(id = mi.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2010)", "Rows Removed by Filter": 0}]}]}, "Planning Time": 78.956, "Triggers": [], "Execution Time": 747.94}]
[{"Bao": {"Bao prediction": 3323.76, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 359412.74, "Total Cost": 359412.75, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1400.835, "Actual Total Time": 1435.212, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 309040.24, "Total Cost": 359412.74, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1246.529, "Actual Total Time": 1435.202, "Actual Rows": 31, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 308040.24, "Total Cost": 358412.64, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1241.797, "Actual Total Time": 1396.874, "Actual Rows": 10, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 308039.82, "Total Cost": 358412.18, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1236.38, "Actual Total Time": 1394.995, "Actual Rows": 869, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.006, "Actual Total Time": 97.101, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 308039.81, "Total Cost": 308039.81, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1196.028, "Actual Total Time": 1196.041, "Actual Rows": 30, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 272712.01, "Total Cost": 308039.81, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1039.09, "Actual Total Time": 1195.861, "Actual Rows": 30, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 272711.86, "Total Cost": 308039.64, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1039.074, "Actual Total Time": 1195.792, "Actual Rows": 30, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 272711.44, "Total Cost": 308039.09, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 1036.429, "Actual Total Time": 1195.464, "Actual Rows": 58, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 272711.29, "Total Cost": 308038.41, "Plan Rows": 4, "Plan Width": 28, "Actual Startup Time": 1000.461, "Actual Total Time": 1195.309, "Actual Rows": 79, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 272710.86, "Total Cost": 308027.32, "Plan Rows": 18, "Plan Width": 20, "Actual Startup Time": 987.443, "Actual Total Time": 1137.133, "Actual Rows": 26221, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 35097.06, "Plan Rows": 58487, "Plan Width": 12, "Actual Startup Time": 0.026, "Actual Total Time": 129.988, "Actual Rows": 101090, "Actual Loops": 3, "Filter": "(((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))", "Rows Removed by Filter": 768619}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 272710.09, "Total Cost": 272710.09, "Plan Rows": 61, "Plan Width": 8, "Actual Startup Time": 987.323, "Actual Total Time": 987.328, "Actual Rows": 49082, "Actual Loops": 3, "Hash Buckets": 262144, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9880, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 16511.57, "Total Cost": 272710.09, "Plan Rows": 61, "Plan Width": 8, "Actual Startup Time": 930.943, "Actual Total Time": 971.06, "Actual Rows": 49082, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 256190.56, "Plan Rows": 2702, "Plan Width": 4, "Actual Startup Time": 588.644, "Actual Total Time": 764.141, "Actual Rows": 196255, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 255356.52, "Plan Rows": 305356, "Plan Width": 8, "Actual Startup Time": 0.329, "Actual Total Time": 738.149, "Actual Rows": 223112, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Germany,German,USA,American}'::text[]))", "Rows Removed by Filter": 4722128}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.006, "Actual Total Time": 0.012, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'countries'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 16455.12, "Total Cost": 16455.12, "Plan Rows": 4322, "Plan Width": 4, "Actual Startup Time": 142.88, "Actual Total Time": 142.881, "Actual Rows": 108039, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 16384, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 2656, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 16455.12, "Plan Rows": 4322, "Plan Width": 4, "Actual Startup Time": 0.064, "Actual Total Time": 108.427, "Actual Rows": 108039, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 488356, "Plan Width": 8, "Actual Startup Time": 0.019, "Actual Total Time": 78.139, "Actual Rows": 390635, "Actual Loops": 3, "Filter": "((info)::text < '7.0'::text)", "Rows Removed by Filter": 69377}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.032, "Actual Total Time": 0.032, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.025, "Actual Total Time": 0.027, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.6, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 78662, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2009)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 237, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = ANY ('{movie,episode}'::text[]))", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.55, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.005, "Actual Total Time": 0.005, "Actual Rows": 1, "Actual Loops": 173, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text <> '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 91, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 91}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 2606, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))", "Rows Removed by Filter": 1}]}]}]}, "Planning Time": 134.069, "Triggers": [], "Execution Time": 1435.366}]
[{"Bao": {"Bao prediction": 1590.551, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 85652.97, "Total Cost": 85652.98, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 494.761, "Actual Total Time": 504.074, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 51879.08, "Total Cost": 85652.97, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 494.757, "Actual Total Time": 504.07, "Actual Rows": 0, "Actual Loops": 1, "Inner Unique": true, "Join Filter": "(mc.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 51878.65, "Total Cost": 85652.47, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 494.754, "Actual Total Time": 504.066, "Actual Rows": 0, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50878.65, "Total Cost": 84652.37, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 492.422, "Actual Total Time": 492.425, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50878.23, "Total Cost": 84616.69, "Plan Rows": 80, "Plan Width": 12, "Actual Startup Time": 241.976, "Actual Total Time": 398.955, "Actual Rows": 49517, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mk.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.011, "Actual Total Time": 62.557, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50878.05, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 241.56, "Actual Total Time": 241.562, "Actual Rows": 13947, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2680, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 12.714, "Actual Total Time": 222.212, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 105.533, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 12.671, "Actual Total Time": 12.672, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.593, "Actual Total Time": 12.666, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'character-name-in-title'::text)", "Rows Removed by Filter": 134169}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 148552, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[sm]'::text)", "Rows Removed by Filter": 1}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 0, "Actual Loops": 0, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 0}]}]}, "Planning Time": 79.505, "Triggers": [], "Execution Time": 504.149}]
[{"Bao": {"Bao prediction": 1234.554, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 85659.2, "Total Cost": 85659.21, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 535.623, "Actual Total Time": 548.196, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 85658.99, "Total Cost": 85659.2, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 535.431, "Actual Total Time": 548.191, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 84658.99, "Total Cost": 84659.0, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 533.238, "Actual Total Time": 533.246, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50885.47, "Total Cost": 84658.92, "Plan Rows": 28, "Plan Width": 0, "Actual Startup Time": 281.167, "Actual Total Time": 532.042, "Actual Rows": 22772, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50885.05, "Total Cost": 84623.24, "Plan Rows": 80, "Plan Width": 4, "Actual Startup Time": 281.123, "Actual Total Time": 438.445, "Actual Rows": 49517, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.015, "Actual Total Time": 63.432, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50884.87, "Total Cost": 50884.87, "Plan Rows": 14, "Plan Width": 8, "Actual Startup Time": 280.697, "Actual Total Time": 280.703, "Actual Rows": 13947, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2680, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.57, "Total Cost": 50884.87, "Plan Rows": 14, "Plan Width": 8, "Actual Startup Time": 12.224, "Actual Total Time": 259.611, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 12.192, "Actual Total Time": 219.398, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 101.307, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 12.151, "Actual Total Time": 12.152, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.587, "Actual Total Time": 12.146, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'character-name-in-title'::text)", "Rows Removed by Filter": 134169}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 41840, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 41840}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 148552, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1}]}]}]}]}, "Planning Time": 78.575, "Triggers": [], "Execution Time": 548.28}]
[{"Bao": {"Bao prediction": 3292.967, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 562750.76, "Total Cost": 562750.77, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 5005.428, "Actual Total Time": 5056.838, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 562750.55, "Total Cost": 562750.76, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 5004.203, "Actual Total Time": 5056.815, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 561750.55, "Total Cost": 561750.56, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 5001.917, "Actual Total Time": 5001.925, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 545186.64, "Total Cost": 561747.12, "Plan Rows": 1370, "Plan Width": 0, "Actual Startup Time": 4742.222, "Actual Total Time": 4953.557, "Actual Rows": 1236864, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.036, "Actual Total Time": 26.483, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 545179.19, "Total Cost": 545179.19, "Plan Rows": 596, "Plan Width": 8, "Actual Startup Time": 4660.79, "Actual Total Time": 4660.796, "Actual Rows": 944185, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 2048, "Hash Batches": 32, "Original Hash Batches": 1, "Peak Memory Usage": 4192, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 84659.7, "Total Cost": 545179.19, "Plan Rows": 596, "Plan Width": 8, "Actual Startup Time": 571.177, "Actual Total Time": 4449.252, "Actual Rows": 944185, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 84659.27, "Total Cost": 544907.83, "Plan Rows": 596, "Plan Width": 4, "Actual Startup Time": 571.141, "Actual Total Time": 2843.435, "Actual Rows": 944185, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.017, "Actual Total Time": 860.633, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 84658.92, "Total Cost": 84658.92, "Plan Rows": 28, "Plan Width": 12, "Actual Startup Time": 571.029, "Actual Total Time": 571.033, "Actual Rows": 22772, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 5304, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50885.47, "Total Cost": 84658.92, "Plan Rows": 28, "Plan Width": 12, "Actual Startup Time": 287.615, "Actual Total Time": 539.529, "Actual Rows": 22772, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50885.05, "Total Cost": 84623.24, "Plan Rows": 80, "Plan Width": 16, "Actual Startup Time": 287.56, "Actual Total Time": 446.876, "Actual Rows": 49517, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.007, "Actual Total Time": 64.062, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50884.87, "Total Cost": 50884.87, "Plan Rows": 14, "Plan Width": 8, "Actual Startup Time": 287.461, "Actual Total Time": 287.464, "Actual Rows": 13947, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2680, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.57, "Total Cost": 50884.87, "Plan Rows": 14, "Plan Width": 8, "Actual Startup Time": 12.011, "Actual Total Time": 256.528, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 11.982, "Actual Total Time": 217.488, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 101.165, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 11.937, "Actual Total Time": 11.938, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.551, "Actual Total Time": 11.932, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'character-name-in-title'::text)", "Rows Removed by Filter": 134169}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 41840, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 41840}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 148552, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 2832555, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 2832555}]}]}]}]}]}]}, "Planning Time": 86.843, "Triggers": [], "Execution Time": 5056.928}]
[{"Bao": {"Bao prediction": 2200.665, "Bao recommended hint": "SET enable_mergejoin TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 809518.66, "Total Cost": 809518.67, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2580.851, "Actual Total Time": 2639.178, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 759145.84, "Total Cost": 809518.66, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2382.838, "Actual Total Time": 2639.116, "Actual Rows": 757, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 759145.69, "Total Cost": 809518.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2382.833, "Actual Total Time": 2638.463, "Actual Rows": 757, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 758145.69, "Total Cost": 808518.39, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2373.744, "Actual Total Time": 2577.75, "Actual Rows": 252, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 758145.27, "Total Cost": 808517.63, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2373.581, "Actual Total Time": 2556.647, "Actual Rows": 11445, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.015, "Actual Total Time": 107.493, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 758145.26, "Total Cost": 758145.26, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2339.205, "Actual Total Time": 2339.223, "Actual Rows": 91, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 742303.24, "Total Cost": 758145.26, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2287.25, "Actual Total Time": 2339.113, "Actual Rows": 91, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 742302.81, "Total Cost": 758144.32, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2271.578, "Actual Total Time": 2335.724, "Actual Rows": 697, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 742302.67, "Total Cost": 758144.13, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2271.56, "Actual Total Time": 2333.736, "Actual Rows": 2104, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.025, "Actual Total Time": 32.445, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 742302.66, "Total Cost": 742302.66, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2265.233, "Actual Total Time": 2265.248, "Actual Rows": 697, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 216, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 242380.96, "Total Cost": 742302.66, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1514.939, "Actual Total Time": 2071.869, "Actual Rows": 697, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 242380.53, "Total Cost": 742301.57, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1514.54, "Actual Total Time": 2066.857, "Actual Rows": 1137, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 497985.06, "Plan Rows": 516258, "Plan Width": 8, "Actual Startup Time": 75.569, "Actual Total Time": 1370.319, "Actual Rows": 414905, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(writer),\"(head writer)\",\"(written by)\",(story),\"(story editor)\"}'::text[]))", "Rows Removed by Filter": 11666543}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 242380.52, "Total Cost": 242380.52, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 658.421, "Actual Total Time": 658.425, "Actual Rows": 1648, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 312, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2469.44, "Total Cost": 242380.52, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 555.858, "Actual Total Time": 624.88, "Actual Rows": 1648, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2467.01, "Total Cost": 242377.93, "Plan Rows": 61, "Plan Width": 16, "Actual Startup Time": 403.706, "Actual Total Time": 624.576, "Actual Rows": 1935, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 239795.93, "Plan Rows": 30499, "Plan Width": 8, "Actual Startup Time": 379.851, "Actual Total Time": 596.942, "Actual Rows": 24349, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Horror,Thriller}'::text[]))", "Rows Removed by Filter": 4920891}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2457.5, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 23.418, "Actual Total Time": 23.419, "Actual Rows": 24592, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1217, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 0.04, "Actual Total Time": 20.568, "Actual Rows": 24592, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.status_id = cct2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.02, "Actual Total Time": 8.622, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.009, "Actual Total Time": 0.01, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.007, "Actual Total Time": 0.007, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'complete+verified'::text)", "Rows Removed by Filter": 3}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.037, "Actual Total Time": 0.038, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.024, "Actual Total Time": 0.033, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'genres'::text)", "Rows Removed by Filter": 112}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 1.09, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 1, "Actual Loops": 3412, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((gender)::text = 'm'::text)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 6313, "Index Cond": "(id = mi_idx.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'votes'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.93, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.005, "Actual Total Time": 0.005, "Actual Rows": 0, "Actual Loops": 2091, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2000)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.69, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 34335, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))", "Rows Removed by Filter": 1}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "comp_cast_type_pkey", "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 757, "Index Cond": "(id = cc.subject_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = ANY ('{cast,crew}'::text[]))", "Rows Removed by Filter": 0}]}]}, "Planning Time": 205.942, "Triggers": [], "Execution Time": 2639.294}]
[{"Bao": {"Bao prediction": 2919.878, "Bao recommended hint": "SET enable_mergejoin TO off; SET enable_indexscan TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 548409.21, "Total Cost": 548409.22, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3500.8, "Actual Total Time": 3545.054, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 514662.94, "Total Cost": 548409.21, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 3373.022, "Actual Total Time": 3544.936, "Actual Rows": 1918, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 514662.5, "Total Cost": 548404.75, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 3373.013, "Actual Total Time": 3539.993, "Actual Rows": 1918, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 514662.07, "Total Cost": 548400.31, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 3372.999, "Actual Total Time": 3534.223, "Actual Rows": 1918, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 513662.07, "Total Cost": 547400.21, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 3372.016, "Actual Total Time": 3494.574, "Actual Rows": 639, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.022, "Actual Total Time": 62.058, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 513662.06, "Total Cost": 513662.06, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3369.632, "Actual Total Time": 3369.636, "Actual Rows": 83, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50878.66, "Total Cost": 513662.06, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1340.269, "Actual Total Time": 3369.491, "Actual Rows": 83, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50878.23, "Total Cost": 511127.48, "Plan Rows": 569, "Plan Width": 12, "Actual Startup Time": 244.398, "Actual Total Time": 2391.097, "Actual Rows": 346131, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = mk.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.041, "Actual Total Time": 859.254, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50878.05, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 244.227, "Actual Total Time": 244.229, "Actual Rows": 13947, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2680, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 12.0, "Actual Total Time": 217.058, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 102.473, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 11.958, "Actual Total Time": 11.959, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.557, "Actual Total Time": 11.945, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'character-name-in-title'::text)", "Rows Removed by Filter": 134169}]}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "name", "Alias": "n", "Startup Cost": 0.44, "Total Cost": 4.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 1038393, "Recheck Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name)::text ~~ 'X%'::text)", "Rows Removed by Filter": 1, "Exact Heap Blocks": 349829, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "name_pkey", "Startup Cost": 0.0, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 1038393, "Index Cond": "(id = ci.person_id)"}]}]}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.43, "Total Cost": 4.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 1918, "Recheck Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Exact Heap Blocks": 1918, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "company_name_pkey", "Startup Cost": 0.0, "Total Cost": 0.43, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 1918, "Index Cond": "(id = mc.company_id)"}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "title", "Alias": "t", "Startup Cost": 0.44, "Total Cost": 4.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 1918, "Recheck Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Exact Heap Blocks": 1918, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "title_pkey", "Startup Cost": 0.0, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 1918, "Index Cond": "(id = ci.movie_id)"}]}]}]}, "Planning Time": 83.667, "Triggers": [], "Execution Time": 3545.14}]
[{"Bao": {"Bao prediction": 1856.52, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 291678.75, "Total Cost": 291678.76, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 733.445, "Actual Total Time": 758.582, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 291678.53, "Total Cost": 291678.74, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 733.342, "Actual Total Time": 758.576, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 290678.53, "Total Cost": 290678.54, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 731.339, "Actual Total Time": 731.343, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50880.91, "Total Cost": 290678.53, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 440.35, "Actual Total Time": 731.338, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50880.48, "Total Cost": 290678.03, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 320.124, "Actual Total Time": 731.275, "Actual Rows": 7, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mk.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 239795.93, "Plan Rows": 161, "Plan Width": 4, "Actual Startup Time": 29.979, "Actual Total Time": 450.221, "Actual Rows": 762, "Actual Loops": 3, "Filter": "((info)::text = 'Bulgaria'::text)", "Rows Removed by Filter": 4944478}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50878.2, "Total Cost": 50878.2, "Plan Rows": 182, "Plan Width": 4, "Actual Startup Time": 280.534, "Actual Total Time": 280.536, "Actual Rows": 4317, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 760, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.29, "Total Cost": 50878.2, "Plan Rows": 182, "Plan Width": 4, "Actual Startup Time": 19.947, "Actual Total Time": 225.456, "Actual Rows": 4317, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 103.144, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 13, "Plan Width": 4, "Actual Startup Time": 19.574, "Actual Total Time": 19.575, "Actual Rows": 30, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 10, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 13, "Plan Width": 4, "Actual Startup Time": 1.172, "Actual Total Time": 19.561, "Actual Rows": 30, "Actual Loops": 3, "Filter": "((keyword)::text ~~ '%sequel%'::text)", "Rows Removed by Filter": 134140}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.007, "Actual Total Time": 0.007, "Actual Rows": 0, "Actual Loops": 21, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2010)", "Rows Removed by Filter": 1}]}]}]}]}, "Planning Time": 79.662, "Triggers": [], "Execution Time": 758.64}]
[{"Bao": {"Bao prediction": 2147.314, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 512274.4, "Total Cost": 512274.41, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1900.259, "Actual Total Time": 1934.566, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 51885.44, "Total Cost": 512274.4, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 363.418, "Actual Total Time": 1934.559, "Actual Rows": 6, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50885.44, "Total Cost": 511274.3, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1385.9, "Actual Total Time": 1898.123, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50885.01, "Total Cost": 511132.38, "Plan Rows": 310, "Plan Width": 4, "Actual Startup Time": 230.104, "Actual Total Time": 1895.03, "Actual Rows": 408, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.012, "Actual Total Time": 836.414, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50884.91, "Total Cost": 50884.91, "Plan Rows": 8, "Plan Width": 8, "Actual Startup Time": 217.166, "Actual Total Time": 217.168, "Actual Rows": 4, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.57, "Total Cost": 50884.91, "Plan Rows": 8, "Plan Width": 8, "Actual Startup Time": 58.379, "Actual Total Time": 217.138, "Actual Rows": 4, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 58.355, "Actual Total Time": 217.071, "Actual Rows": 5, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 102.904, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 12.069, "Actual Total Time": 12.07, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.313, "Actual Total Time": 12.064, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'marvel-cinematic-universe'::text)", "Rows Removed by Filter": 134169}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.012, "Actual Total Time": 0.012, "Actual Rows": 1, "Actual Loops": 14, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2000)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.007, "Actual Total Time": 0.007, "Actual Rows": 0, "Actual Loops": 1224, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name)::text ~~ '%Downey%Robert%'::text)", "Rows Removed by Filter": 1}]}]}]}, "Planning Time": 77.254, "Triggers": [], "Execution Time": 1934.625}]
[{"Bao": {"Bao prediction": 3079.001, "Bao recommended hint": "SET enable_mergejoin TO off; SET enable_indexscan TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 548938.44, "Total Cost": 548938.45, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 5352.032, "Actual Total Time": 5398.173, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 548938.22, "Total Cost": 548938.43, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 5351.547, "Actual Total Time": 5398.15, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 547938.22, "Total Cost": 547938.23, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 5349.005, "Actual Total Time": 5349.016, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 85035.15, "Total Cost": 547938.1, "Plan Rows": 48, "Plan Width": 0, "Actual Startup Time": 688.393, "Actual Total Time": 5344.092, "Actual Rows": 86096, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 85034.71, "Total Cost": 545283.28, "Plan Rows": 596, "Plan Width": 4, "Actual Startup Time": 620.373, "Actual Total Time": 2907.376, "Actual Rows": 944185, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 874.31, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 85034.36, "Total Cost": 85034.36, "Plan Rows": 28, "Plan Width": 12, "Actual Startup Time": 620.094, "Actual Total Time": 620.1, "Actual Rows": 22772, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 5304, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50941.07, "Total Cost": 85034.36, "Plan Rows": 28, "Plan Width": 12, "Actual Startup Time": 294.576, "Actual Total Time": 589.868, "Actual Rows": 22772, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50940.64, "Total Cost": 84678.83, "Plan Rows": 80, "Plan Width": 16, "Actual Startup Time": 294.53, "Actual Total Time": 453.737, "Actual Rows": 49517, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.02, "Actual Total Time": 62.794, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50940.47, "Total Cost": 50940.47, "Plan Rows": 14, "Plan Width": 8, "Actual Startup Time": 294.324, "Actual Total Time": 294.327, "Actual Rows": 13947, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2680, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.58, "Total Cost": 50940.47, "Plan Rows": 14, "Plan Width": 8, "Actual Startup Time": 12.133, "Actual Total Time": 270.024, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 12.105, "Actual Total Time": 217.712, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.011, "Actual Total Time": 100.735, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 12.064, "Actual Total Time": 12.064, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.571, "Actual Total Time": 12.059, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'character-name-in-title'::text)", "Rows Removed by Filter": 134169}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "title", "Alias": "t", "Startup Cost": 0.45, "Total Cost": 4.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 41840, "Recheck Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Exact Heap Blocks": 16255, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "title_pkey", "Startup Cost": 0.0, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 41840, "Index Cond": "(id = mk.movie_id)"}]}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.43, "Total Cost": 4.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 148552, "Recheck Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1, "Exact Heap Blocks": 49372, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "company_name_pkey", "Startup Cost": 0.0, "Total Cost": 0.43, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 148552, "Index Cond": "(id = mc.company_id)"}]}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "name", "Alias": "n", "Startup Cost": 0.44, "Total Cost": 4.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 2832555, "Recheck Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name)::text ~~ 'B%'::text)", "Rows Removed by Filter": 1, "Exact Heap Blocks": 955954, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "name_pkey", "Startup Cost": 0.0, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 2832555, "Index Cond": "(id = ci.person_id)"}]}]}]}]}]}, "Planning Time": 84.435, "Triggers": [], "Execution Time": 5398.259}]
[{"Bao": {"Bao prediction": 3750.807, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 787379.8, "Total Cost": 787379.81, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2631.443, "Actual Total Time": 2691.81, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 787379.58, "Total Cost": 787379.79, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2630.031, "Actual Total Time": 2691.803, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 786379.58, "Total Cost": 786379.59, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2627.808, "Actual Total Time": 2628.043, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 286436.22, "Total Cost": 786379.56, "Plan Rows": 10, "Plan Width": 0, "Actual Startup Time": 1687.376, "Actual Total Time": 2627.355, "Actual Rows": 9358, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 286435.79, "Total Cost": 786373.65, "Plan Rows": 10, "Plan Width": 12, "Actual Startup Time": 1687.34, "Actual Total Time": 2591.865, "Actual Rows": 9358, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 286435.36, "Total Cost": 786356.49, "Plan Rows": 23, "Plan Width": 16, "Actual Startup Time": 1687.216, "Actual Total Time": 2543.674, "Actual Rows": 18052, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 497985.06, "Plan Rows": 516258, "Plan Width": 8, "Actual Startup Time": 89.828, "Actual Total Time": 1385.049, "Actual Rows": 414905, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(writer),\"(head writer)\",\"(written by)\",(story),\"(story editor)\"}'::text[]))", "Rows Removed by Filter": 11666543}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 286435.15, "Total Cost": 286435.15, "Plan Rows": 17, "Plan Width": 8, "Actual Startup Time": 1090.0, "Actual Total Time": 1090.233, "Actual Rows": 34172, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 6104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 15319.64, "Total Cost": 286435.15, "Plan Rows": 17, "Plan Width": 8, "Actual Startup Time": 1052.991, "Actual Total Time": 1077.107, "Actual Rows": 34172, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 271115.48, "Plan Rows": 637, "Plan Width": 4, "Actual Startup Time": 807.876, "Actual Total Time": 921.86, "Actual Rows": 62198, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 270917.11, "Plan Rows": 71947, "Plan Width": 8, "Actual Startup Time": 530.637, "Actual Total Time": 913.896, "Actual Rows": 62990, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))", "Rows Removed by Filter": 4882250}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.017, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'genres'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 15253.6, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 118.523, "Actual Total Time": 118.525, "Actual Rows": 153308, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 16384, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 3328, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 0.057, "Actual Total Time": 80.387, "Actual Rows": 153308, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.014, "Actual Total Time": 33.413, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.032, "Actual Total Time": 0.033, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.026, "Actual Total Time": 0.027, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'votes'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.75, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 54155, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((gender)::text = 'm'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.58, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 28073, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 28073}]}]}]}]}, "Planning Time": 83.345, "Triggers": [], "Execution Time": 2691.886}]
[{"Bao": {"Bao prediction": 2547.687, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 304668.48, "Total Cost": 304668.49, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1133.138, "Actual Total Time": 1164.89, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 304668.26, "Total Cost": 304668.47, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 1132.69, "Actual Total Time": 1164.885, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 303668.26, "Total Cost": 303668.27, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1130.515, "Actual Total Time": 1130.522, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 271113.02, "Total Cost": 303668.26, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 948.433, "Actual Total Time": 1130.386, "Actual Rows": 1570, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 271112.59, "Total Cost": 303667.73, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 948.115, "Actual Total Time": 1114.322, "Actual Rows": 4251, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 271112.17, "Total Cost": 303667.28, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 948.07, "Actual Total Time": 1085.858, "Actual Rows": 12740, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 32551.06, "Plan Rows": 6125, "Plan Width": 8, "Actual Startup Time": 62.474, "Actual Total Time": 161.055, "Actual Rows": 444961, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 12, "Actual Startup Time": 0.006, "Actual Total Time": 62.464, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.02, "Actual Total Time": 0.02, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.013, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 271093.18, "Total Cost": 271093.18, "Plan Rows": 5, "Plan Width": 8, "Actual Startup Time": 885.21, "Actual Total Time": 885.214, "Actual Rows": 7396, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1432, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 15354.59, "Total Cost": 271093.18, "Plan Rows": 5, "Plan Width": 8, "Actual Startup Time": 736.141, "Actual Total Time": 857.043, "Actual Rows": 7396, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 255736.39, "Plan Rows": 1227, "Plan Width": 4, "Actual Startup Time": 650.186, "Actual Total Time": 752.494, "Actual Rows": 108418, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 255356.52, "Plan Rows": 138593, "Plan Width": 8, "Actual Startup Time": 459.203, "Actual Total Time": 738.779, "Actual Rows": 109104, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Drama,Horror,Western,Family}'::text[]))", "Rows Removed by Filter": 4836136}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 0.018, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.009, "Actual Total Time": 0.015, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'genres'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 15343.3, "Total Cost": 15343.3, "Plan Rows": 709, "Plan Width": 4, "Actual Startup Time": 85.919, "Actual Total Time": 85.92, "Actual Rows": 40524, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 2048, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 6832, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15343.3, "Plan Rows": 709, "Plan Width": 4, "Actual Startup Time": 0.076, "Actual Total Time": 73.612, "Actual Rows": 40524, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 80118, "Plan Width": 8, "Actual Startup Time": 0.041, "Actual Total Time": 66.861, "Actual Rows": 64632, "Actual Loops": 3, "Filter": "((info)::text > '7.0'::text)", "Rows Removed by Filter": 395380}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.026, "Actual Total Time": 0.026, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.021, "Actual Total Time": 0.022, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 38219, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.52, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 0, "Actual Loops": 12752, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 2000) AND (production_year <= 2010))", "Rows Removed by Filter": 1}]}]}]}]}, "Planning Time": 86.721, "Triggers": [], "Execution Time": 1164.986}]
[{"Bao": {"Bao prediction": 757.775, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 52751.88, "Total Cost": 52751.89, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 227.175, "Actual Total Time": 234.183, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 52751.67, "Total Cost": 52751.88, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 227.012, "Actual Total Time": 234.177, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 51751.67, "Total Cost": 51751.68, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 225.016, "Actual Total Time": 225.02, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3465.08, "Total Cost": 51751.66, "Plan Rows": 5, "Plan Width": 0, "Actual Startup Time": 225.014, "Actual Total Time": 225.017, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3464.65, "Total Cost": 51729.3, "Plan Rows": 5, "Plan Width": 4, "Actual Startup Time": 225.013, "Actual Total Time": 225.017, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3464.22, "Total Cost": 51726.86, "Plan Rows": 5, "Plan Width": 12, "Actual Startup Time": 225.013, "Actual Total Time": 225.016, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3464.07, "Total Cost": 51726.02, "Plan Rows": 5, "Plan Width": 16, "Actual Startup Time": 225.013, "Actual Total Time": 225.015, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 214.219, "Actual Total Time": 217.495, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.008, "Actual Total Time": 103.054, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 10.43, "Actual Total Time": 10.431, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 10.219, "Actual Total Time": 10.425, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = '10,000-mile-club'::text)", "Rows Removed by Filter": 134169}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 462.97, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 12, "Actual Startup Time": 7.372, "Actual Total Time": 7.373, "Actual Rows": 29997, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 32768, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1545, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 12, "Actual Startup Time": 0.019, "Actual Total Time": 3.452, "Actual Rows": 29997, "Actual Loops": 3}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "link_type_pkey", "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 0, "Actual Loops": 0, "Index Cond": "(id = ml.link_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t1", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 0, "Actual Loops": 0, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t2", "Startup Cost": 0.43, "Total Cost": 4.47, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 0, "Actual Loops": 0, "Index Cond": "(id = ml.linked_movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 0}]}]}]}]}, "Planning Time": 79.185, "Triggers": [], "Execution Time": 234.266}]
[{"Bao": {"Bao prediction": 2192.671, "Bao recommended hint": "SET enable_mergejoin TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 409636.97, "Total Cost": 409636.98, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2361.396, "Actual Total Time": 2391.306, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 359264.3, "Total Cost": 409636.96, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1642.791, "Actual Total Time": 2391.014, "Actual Rows": 4803, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 359264.15, "Total Cost": 409636.79, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1642.787, "Actual Total Time": 2385.738, "Actual Rows": 6156, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 359263.73, "Total Cost": 409636.24, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1642.781, "Actual Total Time": 2374.237, "Actual Rows": 6346, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 359263.58, "Total Cost": 409636.07, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1642.774, "Actual Total Time": 2368.439, "Actual Rows": 6542, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 358263.58, "Total Cost": 408635.97, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1640.416, "Actual Total Time": 2350.247, "Actual Rows": 2181, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 358263.16, "Total Cost": 408635.51, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1633.536, "Actual Total Time": 1878.793, "Actual Rows": 304835, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.017, "Actual Total Time": 98.427, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 358263.14, "Total Cost": 358263.14, "Plan Rows": 1, "Plan Width": 32, "Actual Startup Time": 1632.995, "Actual Total Time": 1633.003, "Actual Rows": 3504, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 952, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 341035.43, "Total Cost": 358263.14, "Plan Rows": 1, "Plan Width": 32, "Actual Startup Time": 1451.543, "Actual Total Time": 1601.316, "Actual Rows": 3504, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 341035.0, "Total Cost": 358262.55, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 1451.52, "Actual Total Time": 1583.181, "Actual Rows": 7460, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 341034.85, "Total Cost": 358261.71, "Plan Rows": 5, "Plan Width": 28, "Actual Startup Time": 1451.501, "Actual Total Time": 1563.029, "Actual Rows": 22985, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 561109, "Plan Width": 8, "Actual Startup Time": 0.03, "Actual Total Time": 75.378, "Actual Rows": 447629, "Actual Loops": 3, "Filter": "((info)::text < '8.5'::text)", "Rows Removed by Filter": 12383}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 341034.83, "Total Cost": 341034.83, "Plan Rows": 2, "Plan Width": 20, "Actual Startup Time": 1451.305, "Actual Total Time": 1451.31, "Actual Rows": 8013, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1880, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 305718.25, "Total Cost": 341034.83, "Plan Rows": 2, "Plan Width": 20, "Actual Startup Time": 1287.658, "Actual Total Time": 1432.304, "Actual Rows": 8013, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 305718.1, "Total Cost": 341034.49, "Plan Rows": 2, "Plan Width": 24, "Actual Startup Time": 1287.628, "Actual Total Time": 1425.383, "Actual Rows": 8013, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 35097.06, "Plan Rows": 58487, "Plan Width": 12, "Actual Startup Time": 0.024, "Actual Total Time": 126.103, "Actual Rows": 101090, "Actual Loops": 3, "Filter": "(((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))", "Rows Removed by Filter": 768619}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 305718.02, "Total Cost": 305718.02, "Plan Rows": 6, "Plan Width": 12, "Actual Startup Time": 1287.456, "Actual Total Time": 1287.459, "Actual Rows": 9424, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1880, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2469.44, "Total Cost": 305718.02, "Plan Rows": 6, "Plan Width": 12, "Actual Startup Time": 988.289, "Actual Total Time": 1272.082, "Actual Rows": 9424, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2467.01, "Total Cost": 305713.85, "Plan Rows": 642, "Plan Width": 16, "Actual Startup Time": 30.827, "Actual Total Time": 1270.561, "Actual Rows": 12690, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 302038.28, "Plan Rows": 320570, "Plan Width": 8, "Actual Startup Time": 0.558, "Actual Total Time": 1204.018, "Actual Rows": 238737, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))", "Rows Removed by Filter": 4706503}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2457.5, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 29.623, "Actual Total Time": 29.625, "Actual Rows": 49145, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2432, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 12.804, "Actual Total Time": 23.943, "Actual Rows": 49145, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.subject_id = cct1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.013, "Actual Total Time": 9.523, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.012, "Actual Total Time": 0.012, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.008, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'crew'::text)", "Rows Removed by Filter": 3}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.028, "Actual Total Time": 0.028, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.024, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'countries'::text)", "Rows Removed by Filter": 112}]}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 24039, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 24039}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 68955, "Index Cond": "(id = mi_idx.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.58, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 22380, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2000)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 914506, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))", "Rows Removed by Filter": 1}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 6542, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = ANY ('{movie,episode}'::text[]))", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.55, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 6346, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text <> '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "comp_cast_type_pkey", "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 6156, "Index Cond": "(id = cc.status_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text <> 'complete+verified'::text)", "Rows Removed by Filter": 0}]}]}, "Planning Time": 232.415, "Triggers": [], "Execution Time": 2391.435}]
[{"Bao": {"Bao prediction": 3264.987, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 497918.95, "Total Cost": 497918.96, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1944.346, "Actual Total Time": 1979.758, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 481358.17, "Total Cost": 497918.95, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1915.953, "Actual Total Time": 1979.748, "Actual Rows": 40, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 481357.74, "Total Cost": 497918.25, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1896.624, "Actual Total Time": 1979.475, "Actual Rows": 94, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 481357.32, "Total Cost": 497917.65, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1896.614, "Actual Total Time": 1979.254, "Actual Rows": 94, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 481356.89, "Total Cost": 497916.94, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1896.593, "Actual Total Time": 1979.004, "Actual Rows": 103, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 480356.89, "Total Cost": 496916.84, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1898.312, "Actual Total Time": 1941.195, "Actual Rows": 34, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 25.911, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 480356.88, "Total Cost": 480356.88, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 1892.981, "Actual Total Time": 1892.985, "Actual Rows": 29, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 442219.76, "Total Cost": 480356.88, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 1852.148, "Actual Total Time": 1892.824, "Actual Rows": 29, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 442219.33, "Total Cost": 480193.82, "Plan Rows": 194, "Plan Width": 20, "Actual Startup Time": 1849.993, "Actual Total Time": 1864.37, "Actual Rows": 9700, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 37814.9, "Plan Rows": 42343, "Plan Width": 8, "Actual Startup Time": 0.023, "Actual Total Time": 128.207, "Actual Rows": 66173, "Actual Loops": 3, "Filter": "(((note)::text ~~ '%(200%)%'::text) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))", "Rows Removed by Filter": 803537}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 442197.95, "Total Cost": 442197.95, "Plan Rows": 1710, "Plan Width": 12, "Actual Startup Time": 1711.198, "Actual Total Time": 1711.2, "Actual Rows": 74229, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 8192, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 1888, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 442197.95, "Plan Rows": 1710, "Plan Width": 12, "Actual Startup Time": 339.823, "Actual Total Time": 923.768, "Actual Rows": 74229, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 441377.81, "Plan Rows": 303415, "Plan Width": 16, "Actual Startup Time": 0.035, "Actual Total Time": 900.959, "Actual Rows": 237943, "Actual Loops": 3, "Filter": "((note)::text = '(voice)'::text)", "Rows Removed by Filter": 11843505}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.023, "Actual Total Time": 0.024, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.019, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((role)::text = 'actress'::text)", "Rows Removed by Filter": 11}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.84, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 29100, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name)::text ~~ '%Angel%'::text) AND ((gender)::text = 'f'::text))", "Rows Removed by Filter": 1}]}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 0.71, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 103, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 94}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.59, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 94, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.7, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 94, "Index Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 2007) AND (production_year <= 2010))", "Rows Removed by Filter": 1}]}]}, "Planning Time": 86.171, "Triggers": [], "Execution Time": 1979.841}]
[{"Bao": {"Bao prediction": 1688.645, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 364304.79, "Total Cost": 364304.8, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 998.767, "Actual Total Time": 1029.608, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 364304.58, "Total Cost": 364304.79, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 998.584, "Actual Total Time": 1029.603, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 363304.58, "Total Cost": 363304.59, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 996.277, "Actual Total Time": 996.285, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 355041.52, "Total Cost": 363304.46, "Plan Rows": 46, "Plan Width": 0, "Actual Startup Time": 975.812, "Actual Total Time": 996.25, "Actual Rows": 757, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(at.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_title", "Alias": "at", "Startup Cost": 0.0, "Total Cost": 7698.13, "Plan Rows": 150613, "Plan Width": 4, "Actual Startup Time": 0.023, "Actual Total Time": 11.107, "Actual Rows": 120491, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 355041.31, "Total Cost": 355041.31, "Plan Rows": 17, "Plan Width": 16, "Actual Startup Time": 974.985, "Actual Total Time": 974.992, "Actual Rows": 2655, "Actual Loops": 3, "Hash Buckets": 8192, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 536, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 304661.91, "Total Cost": 355041.31, "Plan Rows": 17, "Plan Width": 16, "Actual Startup Time": 671.803, "Actual Total Time": 890.696, "Actual Rows": 2655, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 304661.49, "Total Cost": 355033.85, "Plan Rows": 17, "Plan Width": 20, "Actual Startup Time": 671.772, "Actual Total Time": 885.8, "Actual Rows": 2655, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.02, "Actual Total Time": 102.615, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 304661.48, "Total Cost": 304661.48, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 671.497, "Actual Total Time": 671.503, "Actual Rows": 882, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 248, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 270920.86, "Total Cost": 304661.48, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 477.787, "Actual Total Time": 632.722, "Actual Rows": 882, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 270920.71, "Total Cost": 304661.31, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 477.771, "Actual Total Time": 631.815, "Actual Rows": 882, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 270920.28, "Total Cost": 304660.25, "Plan Rows": 2, "Plan Width": 12, "Actual Startup Time": 477.747, "Actual Total Time": 627.226, "Actual Rows": 882, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 270919.86, "Total Cost": 304658.02, "Plan Rows": 5, "Plan Width": 16, "Actual Startup Time": 477.715, "Actual Total Time": 624.004, "Actual Rows": 961, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 12, "Actual Startup Time": 0.016, "Actual Total Time": 64.405, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 270919.85, "Total Cost": 270919.85, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 477.403, "Actual Total Time": 477.405, "Actual Rows": 594, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 270919.85, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 128.948, "Actual Total Time": 477.232, "Actual Rows": 594, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 270917.11, "Plan Rows": 117, "Plan Width": 8, "Actual Startup Time": 128.902, "Actual Total Time": 477.066, "Actual Rows": 594, "Actual Loops": 3, "Filter": "((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))", "Rows Removed by Filter": 4944646}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.032, "Actual Total Time": 0.032, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.022, "Actual Total Time": 0.027, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 112}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 2884, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.52, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.005, "Actual Total Time": 0.005, "Actual Rows": 1, "Actual Loops": 2647, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 1990)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 2647, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 2647}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 7964, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 7964}]}]}]}]}]}]}, "Planning Time": 99.48, "Triggers": [], "Execution Time": 1029.717}]
[{"Bao": {"Bao prediction": 2939.721, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 545497.75, "Total Cost": 545497.76, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1868.427, "Actual Total Time": 1902.386, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 545497.54, "Total Cost": 545497.75, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 1868.283, "Actual Total Time": 1902.38, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 544497.54, "Total Cost": 544497.55, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1865.953, "Actual Total Time": 1865.96, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 83706.28, "Total Cost": 544497.54, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1579.294, "Actual Total Time": 1865.955, "Actual Rows": 5, "Actual Loops": 3, "Inner Unique": false, "Join Filter": "(ml.linked_movie_id = t.id)", "Rows Removed by Join Filter": 55312, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 83687.36, "Total Cost": 543934.32, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1251.896, "Actual Total Time": 1816.344, "Actual Rows": 11, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 83686.93, "Total Cost": 543933.86, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 563.636, "Actual Total Time": 1815.444, "Actual Rows": 118, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.016, "Actual Total Time": 850.516, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 83686.92, "Total Cost": 83686.92, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 160.242, "Actual Total Time": 160.246, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 66502.6, "Total Cost": 83686.92, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 140.718, "Actual Total Time": 160.138, "Actual Rows": 1, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 66502.17, "Total Cost": 83686.06, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 102.884, "Actual Total Time": 159.702, "Actual Rows": 33, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = pi.person_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 16090.49, "Plan Rows": 291570, "Plan Width": 4, "Actual Startup Time": 0.012, "Actual Total Time": 45.677, "Actual Rows": 224897, "Actual Loops": 3, "Filter": "((name)::text ~~ '%a%'::text)", "Rows Removed by Filter": 75550}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 66502.15, "Total Cost": 66502.15, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 101.171, "Actual Total Time": 101.173, "Actual Rows": 21, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 66502.15, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 5.11, "Actual Total Time": 101.125, "Actual Rows": 21, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(pi.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "person_info", "Alias": "pi", "Startup Cost": 0.0, "Total Cost": 66499.7, "Plan Rows": 12, "Plan Width": 8, "Actual Startup Time": 5.065, "Actual Total Time": 101.05, "Actual Rows": 21, "Actual Loops": 3, "Filter": "((note)::text = 'Volker Boehm'::text)", "Rows Removed by Filter": 987867}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.03, "Actual Total Time": 0.031, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.019, "Actual Total Time": 0.025, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'mini biography'::text)", "Rows Removed by Filter": 112}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.86, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.013, "Actual Rows": 0, "Actual Loops": 98, "Index Cond": "(id = an.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name_pcode_cf)::text ~~ 'D%'::text) AND ((gender)::text = 'm'::text))", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.007, "Actual Total Time": 0.007, "Actual Rows": 0, "Actual Loops": 353, "Index Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 1980) AND (production_year <= 1984))", "Rows Removed by Filter": 1}]}, {"Node Type": "Hash Join", "Parent Relationship": "Inner", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 561.1, "Plan Rows": 169, "Plan Width": 4, "Actual Startup Time": 0.02, "Actual Total Time": 4.436, "Actual Rows": 5186, "Actual Loops": 32, "Inner Unique": true, "Hash Cond": "(ml.link_type_id = lt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 8, "Actual Startup Time": 0.005, "Actual Total Time": 1.886, "Actual Rows": 29997, "Actual Loops": 32}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.01, "Actual Total Time": 0.01, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.006, "Actual Total Time": 0.007, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((link)::text = 'features'::text)", "Rows Removed by Filter": 17}]}]}]}]}]}]}, "Planning Time": 86.438, "Triggers": [], "Execution Time": 1902.47}]
[{"Bao": {"Bao prediction": 2443.859, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 288880.08, "Total Cost": 288880.09, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 903.722, "Actual Total Time": 931.552, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 288879.86, "Total Cost": 288880.07, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 903.612, "Actual Total Time": 931.548, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 287879.86, "Total Cost": 287879.87, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 901.354, "Actual Total Time": 901.361, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 255324.61, "Total Cost": 287879.86, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 767.779, "Actual Total Time": 901.343, "Actual Rows": 132, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 255324.18, "Total Cost": 287879.33, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 759.807, "Actual Total Time": 898.868, "Actual Rows": 437, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 255323.76, "Total Cost": 287878.88, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 759.777, "Actual Total Time": 895.662, "Actual Rows": 839, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 32551.06, "Plan Rows": 6125, "Plan Width": 8, "Actual Startup Time": 62.166, "Actual Total Time": 159.944, "Actual Rows": 444961, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 12, "Actual Startup Time": 0.006, "Actual Total Time": 61.805, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.03, "Actual Total Time": 0.031, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.027, "Actual Total Time": 0.028, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 255304.83, "Total Cost": 255304.83, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 696.636, "Actual Total Time": 696.64, "Actual Rows": 648, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 15185.74, "Total Cost": 255304.83, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 603.471, "Actual Total Time": 696.245, "Actual Rows": 648, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 240117.6, "Plan Rows": 1038, "Plan Width": 4, "Actual Startup Time": 526.593, "Actual Total Time": 610.813, "Actual Rows": 90907, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 239795.93, "Plan Rows": 117223, "Plan Width": 8, "Actual Startup Time": 370.801, "Actual Total Time": 599.291, "Actual Rows": 91548, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Drama,Horror}'::text[]))", "Rows Removed by Filter": 4853692}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 0.017, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'genres'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 15181.04, "Total Cost": 15181.04, "Plan Rows": 182, "Plan Width": 4, "Actual Startup Time": 76.716, "Actual Total Time": 76.717, "Actual Rows": 5283, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 952, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15181.04, "Plan Rows": 182, "Plan Width": 4, "Actual Startup Time": 0.114, "Actual Total Time": 65.556, "Actual Rows": 5283, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 20538, "Plan Width": 8, "Actual Startup Time": 0.027, "Actual Total Time": 64.048, "Actual Rows": 17883, "Actual Loops": 3, "Filter": "((info)::text > '8.0'::text)", "Rows Removed by Filter": 442129}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.035, "Actual Total Time": 0.036, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.03, "Actual Total Time": 0.031, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 1, "Actual Loops": 2518, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.52, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.005, "Actual Total Time": 0.005, "Actual Rows": 0, "Actual Loops": 1311, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 2005) AND (production_year <= 2008))", "Rows Removed by Filter": 1}]}]}]}]}, "Planning Time": 84.633, "Triggers": [], "Execution Time": 931.638}]
[{"Bao": {"Bao prediction": 3223.291, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 533834.42, "Total Cost": 533834.43, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1707.775, "Actual Total Time": 1742.172, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 517273.91, "Total Cost": 533834.42, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1671.652, "Actual Total Time": 1742.159, "Actual Rows": 121, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 517273.48, "Total Cost": 533833.76, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1671.643, "Actual Total Time": 1741.445, "Actual Rows": 341, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 517273.05, "Total Cost": 533833.1, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1671.63, "Actual Total Time": 1740.784, "Actual Rows": 359, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 516273.05, "Total Cost": 532833.0, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1661.869, "Actual Total Time": 1704.085, "Actual Rows": 120, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.014, "Actual Total Time": 24.836, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 516273.03, "Total Cost": 516273.03, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1656.728, "Actual Total Time": 1656.733, "Actual Rows": 110, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 480147.95, "Total Cost": 516273.03, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1496.589, "Actual Total Time": 1656.454, "Actual Rows": 110, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 480147.52, "Total Cost": 516074.94, "Plan Rows": 258, "Plan Width": 16, "Actual Startup Time": 1494.095, "Actual Total Time": 1585.519, "Actual Rows": 26554, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 480147.1, "Total Cost": 515723.47, "Plan Rows": 716, "Plan Width": 20, "Actual Startup Time": 1494.072, "Actual Total Time": 1533.084, "Actual Rows": 28685, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 35097.06, "Plan Rows": 127023, "Plan Width": 8, "Actual Startup Time": 0.02, "Actual Total Time": 137.21, "Actual Rows": 196998, "Actual Loops": 3, "Filter": "((note IS NOT NULL) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))", "Rows Removed by Filter": 672712}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 480120.81, "Total Cost": 480120.81, "Plan Rows": 2103, "Plan Width": 12, "Actual Startup Time": 1331.185, "Actual Total Time": 1331.187, "Actual Rows": 92055, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 8192, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 2176, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 480120.81, "Plan Rows": 2103, "Plan Width": 12, "Actual Startup Time": 402.167, "Actual Total Time": 1301.335, "Actual Rows": 92055, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 479115.98, "Plan Rows": 373356, "Plan Width": 16, "Actual Startup Time": 0.049, "Actual Total Time": 1272.821, "Actual Rows": 289159, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(voice),\"(voice: Japanese version)\",\"(voice) (uncredited)\",\"(voice: English version)\"}'::text[]))", "Rows Removed by Filter": 11792289}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.023, "Actual Total Time": 0.023, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 0.018, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((role)::text = 'actress'::text)", "Rows Removed by Filter": 11}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 86056, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.77, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 79662, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name)::text ~~ '%Ang%'::text) AND ((gender)::text = 'f'::text))", "Rows Removed by Filter": 1}]}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 0.66, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 359, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 341}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.65, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 341, "Index Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 2005) AND (production_year <= 2015))", "Rows Removed by Filter": 1}]}]}, "Planning Time": 86.736, "Triggers": [], "Execution Time": 1742.259}]
[{"Bao": {"Bao prediction": 4216.232, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 753206.23, "Total Cost": 753206.24, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2727.161, "Actual Total Time": 2784.693, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 753206.01, "Total Cost": 753206.22, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2726.252, "Actual Total Time": 2784.687, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 752206.01, "Total Cost": 752206.02, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2723.775, "Actual Total Time": 2723.784, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 714229.25, "Total Cost": 752206.01, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2697.48, "Actual Total Time": 2723.779, "Actual Rows": 5, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 714228.82, "Total Cost": 752204.53, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 2608.895, "Actual Total Time": 2723.69, "Actual Rows": 21, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ci.person_id = n.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 714228.39, "Total Cost": 752202.94, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2579.621, "Actual Total Time": 2717.303, "Actual Rows": 3634, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 714227.97, "Total Cost": 752201.66, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2579.599, "Actual Total Time": 2711.538, "Actual Rows": 3701, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 37814.9, "Plan Rows": 42343, "Plan Width": 8, "Actual Startup Time": 0.011, "Actual Total Time": 126.939, "Actual Rows": 66173, "Actual Loops": 3, "Filter": "(((note)::text ~~ '%(200%)%'::text) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))", "Rows Removed by Filter": 803537}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 714227.95, "Total Cost": 714227.95, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2577.782, "Actual Total Time": 2577.788, "Actual Rows": 7123, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1560, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 697668.0, "Total Cost": 714227.95, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2506.265, "Actual Total Time": 2558.038, "Actual Rows": 7123, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = ci.person_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.014, "Actual Total Time": 24.799, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 697667.99, "Total Cost": 697667.99, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 2505.988, "Actual Total Time": 2505.993, "Actual Rows": 4491, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 920, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 442222.18, "Total Cost": 697667.99, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 2475.382, "Actual Total Time": 2497.287, "Actual Rows": 4491, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 442221.75, "Total Cost": 697666.49, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2475.346, "Actual Total Time": 2482.545, "Actual Rows": 4684, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 255446.09, "Plan Rows": 283, "Plan Width": 4, "Actual Startup Time": 202.209, "Actual Total Time": 752.708, "Actual Rows": 23159, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 255356.52, "Plan Rows": 32001, "Plan Width": 8, "Actual Startup Time": 202.164, "Actual Total Time": 749.511, "Actual Rows": 23159, "Actual Loops": 3, "Filter": "((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%2007%'::text) OR ((info)::text ~~ 'USA:%2008%'::text)))", "Rows Removed by Filter": 4922081}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.032, "Actual Total Time": 0.033, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.025, "Actual Total Time": 0.03, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 442197.95, "Total Cost": 442197.95, "Plan Rows": 1710, "Plan Width": 12, "Actual Startup Time": 1717.348, "Actual Total Time": 1717.349, "Actual Rows": 74229, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 8192, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 1888, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 442197.95, "Plan Rows": 1710, "Plan Width": 12, "Actual Startup Time": 339.546, "Actual Total Time": 924.086, "Actual Rows": 74229, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 441377.81, "Plan Rows": 303415, "Plan Width": 16, "Actual Startup Time": 0.019, "Actual Total Time": 901.476, "Actual Rows": 237943, "Actual Loops": 3, "Filter": "((note)::text = '(voice)'::text)", "Rows Removed by Filter": 11843505}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.031, "Actual Total Time": 0.031, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.019, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((role)::text = 'actress'::text)", "Rows Removed by Filter": 11}]}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 1.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 14051, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 13472}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 1.28, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 11104, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 1.58, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 10903, "Index Cond": "(id = an.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name)::text ~~ '%Angel%'::text) AND ((gender)::text = 'f'::text))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 1.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 0, "Actual Loops": 64, "Index Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 2007) AND (production_year <= 2008) AND ((title)::text ~~ '%Kung%Fu%Panda%'::text))", "Rows Removed by Filter": 1}]}]}]}]}, "Planning Time": 111.383, "Triggers": [], "Execution Time": 2784.801}]
[{"Bao": {"Bao prediction": 1724.261, "Bao recommended hint": "SET enable_mergejoin TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 529929.52, "Total Cost": 529929.53, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 27628.823, "Actual Total Time": 27683.321, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 479556.99, "Total Cost": 529929.52, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 3403.75, "Actual Total Time": 27682.801, "Actual Rows": 5400, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 479556.56, "Total Cost": 529929.06, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 3403.706, "Actual Total Time": 27454.032, "Actual Rows": 189738, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 478556.56, "Total Cost": 528928.96, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 3412.56, "Actual Total Time": 27521.058, "Actual Rows": 63246, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 478556.14, "Total Cost": 528928.5, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3388.64, "Actual Total Time": 5057.957, "Actual Rows": 13706526, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.008, "Actual Total Time": 101.89, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 478556.13, "Total Cost": 478556.13, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 3126.412, "Actual Total Time": 3126.631, "Actual Rows": 128639, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 3168, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18308.28, "Total Cost": 478556.13, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 384.907, "Actual Total Time": 3037.838, "Actual Rows": 128639, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18307.85, "Total Cost": 478555.68, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 384.886, "Actual Total Time": 2752.189, "Actual Rows": 128639, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 18307.7, "Total Cost": 478554.65, "Plan Rows": 6, "Plan Width": 28, "Actual Startup Time": 384.844, "Actual Total Time": 2497.296, "Actual Rows": 272014, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 12, "Actual Startup Time": 0.011, "Actual Total Time": 871.759, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 18307.68, "Total Cost": 18307.68, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 384.733, "Actual Total Time": 384.747, "Actual Rows": 4312, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 920, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2462.84, "Total Cost": 18307.68, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 49.845, "Actual Total Time": 305.515, "Actual Rows": 4312, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(cc.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2462.41, "Total Cost": 18307.09, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 49.511, "Actual Total Time": 245.062, "Actual Rows": 20520, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2462.26, "Total Cost": 18306.74, "Plan Rows": 2, "Plan Width": 12, "Actual Startup Time": 49.495, "Actual Total Time": 214.42, "Actual Rows": 31800, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2459.84, "Total Cost": 18303.67, "Plan Rows": 238, "Plan Width": 16, "Actual Startup Time": 49.447, "Actual Total Time": 205.02, "Actual Rows": 95533, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.014, "Actual Total Time": 32.405, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2457.46, "Total Cost": 2457.46, "Plan Rows": 190, "Plan Width": 8, "Actual Startup Time": 49.398, "Actual Total Time": 49.4, "Actual Rows": 135086, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 1024, "Hash Batches": 2, "Original Hash Batches": 1, "Peak Memory Usage": 3659, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.89, "Total Cost": 2457.46, "Plan Rows": 190, "Plan Width": 8, "Actual Startup Time": 0.037, "Actual Total Time": 30.766, "Actual Rows": 135086, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.status_id = cct2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.014, "Actual Total Time": 9.775, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.014, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.011, "Actual Total Time": 0.011, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((kind)::text ~~ '%complete%'::text)", "Rows Removed by Filter": 2}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.037, "Actual Total Time": 0.041, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.031, "Actual Total Time": 0.034, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "comp_cast_type_pkey", "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 95399, "Index Cond": "(id = cc.subject_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'cast'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.58, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 61559, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2000)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 816042, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'movie'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 385916, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 385916}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 41119579, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))", "Rows Removed by Filter": 1}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 189738, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))", "Rows Removed by Filter": 0}]}]}, "Planning Time": 210.096, "Triggers": [], "Execution Time": 27683.457}]
[{"Bao": {"Bao prediction": 3484.808, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 806468.85, "Total Cost": 806468.86, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2436.225, "Actual Total Time": 2495.126, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 806468.63, "Total Cost": 806468.84, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2435.201, "Actual Total Time": 2495.121, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 805468.63, "Total Cost": 805468.64, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2432.704, "Actual Total Time": 2432.717, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 755080.68, "Total Cost": 805468.63, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2138.007, "Actual Total Time": 2432.592, "Actual Rows": 1469, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 755080.25, "Total Cost": 805467.78, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2137.984, "Actual Total Time": 2428.167, "Actual Rows": 1469, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 755079.83, "Total Cost": 805452.28, "Plan Rows": 23, "Plan Width": 20, "Actual Startup Time": 2120.186, "Actual Total Time": 2349.823, "Actual Rows": 42863, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.035, "Actual Total Time": 106.604, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 755079.81, "Total Cost": 755079.81, "Plan Rows": 2, "Plan Width": 12, "Actual Startup Time": 2115.317, "Actual Total Time": 2115.328, "Actual Rows": 1617, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 344, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 255153.79, "Total Cost": 755079.81, "Plan Rows": 2, "Plan Width": 12, "Actual Startup Time": 1466.268, "Actual Total Time": 2042.35, "Actual Rows": 1617, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 255153.36, "Total Cost": 755074.41, "Plan Rows": 5, "Plan Width": 16, "Actual Startup Time": 1377.335, "Actual Total Time": 2030.845, "Actual Rows": 2883, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 497985.06, "Plan Rows": 516258, "Plan Width": 8, "Actual Startup Time": 90.685, "Actual Total Time": 1384.519, "Actual Rows": 414905, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(writer),\"(head writer)\",\"(written by)\",(story),\"(story editor)\"}'::text[]))", "Rows Removed by Filter": 11666543}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 255153.32, "Total Cost": 255153.32, "Plan Rows": 3, "Plan Width": 8, "Actual Startup Time": 606.111, "Actual Total Time": 606.121, "Actual Rows": 5493, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 920, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 15319.64, "Total Cost": 255153.32, "Plan Rows": 3, "Plan Width": 8, "Actual Startup Time": 587.057, "Actual Total Time": 599.595, "Actual Rows": 5493, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 239835.65, "Plan Rows": 121, "Plan Width": 4, "Actual Startup Time": 408.926, "Actual Total Time": 459.951, "Actual Rows": 10138, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 239795.93, "Plan Rows": 13693, "Plan Width": 8, "Actual Startup Time": 289.641, "Actual Total Time": 458.545, "Actual Rows": 10267, "Actual Loops": 3, "Filter": "((info)::text = 'Horror'::text)", "Rows Removed by Filter": 4934973}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 0.017, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.015, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'genres'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 15253.6, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 120.778, "Actual Total Time": 120.78, "Actual Rows": 153308, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 16384, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 3360, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 0.059, "Actual Total Time": 82.059, "Actual Rows": 153308, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.015, "Actual Total Time": 34.432, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.032, "Actual Total Time": 0.033, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.026, "Actual Total Time": 0.027, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'votes'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 1.08, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 1, "Actual Loops": 8650, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((gender)::text = 'm'::text)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.67, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 128590, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,blood,gore,death,female-nudity}'::text[]))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.84, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 4407, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 4407}]}]}]}]}, "Planning Time": 97.919, "Triggers": [], "Execution Time": 2495.224}]
[{"Bao": {"Bao prediction": 1729.261, "Bao recommended hint": "SET enable_mergejoin TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 341653.86, "Total Cost": 341653.87, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1118.315, "Actual Total Time": 1148.336, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 310000.41, "Total Cost": 341653.86, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1116.615, "Actual Total Time": 1148.307, "Actual Rows": 477, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 309999.99, "Total Cost": 341653.4, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1116.595, "Actual Total Time": 1146.738, "Actual Rows": 1106, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 308999.99, "Total Cost": 340653.3, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1072.343, "Actual Total Time": 1114.289, "Actual Rows": 369, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 308999.84, "Total Cost": 340653.12, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1039.492, "Actual Total Time": 1113.979, "Actual Rows": 388, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 531175, "Plan Width": 12, "Actual Startup Time": 0.016, "Actual Total Time": 75.341, "Actual Rows": 423996, "Actual Loops": 3, "Filter": "(note IS NULL)", "Rows Removed by Filter": 445713}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 308999.82, "Total Cost": 308999.82, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1014.606, "Actual Total Time": 1014.614, "Actual Rows": 51, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 53436.44, "Total Cost": 308999.82, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 916.304, "Actual Total Time": 1014.481, "Actual Rows": 51, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ml.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 53436.01, "Total Cost": 308999.32, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 916.287, "Actual Total Time": 1014.387, "Actual Rows": 51, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 255356.52, "Plan Rows": 55142, "Plan Width": 4, "Actual Startup Time": 0.317, "Actual Total Time": 734.05, "Actual Rows": 44746, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))", "Rows Removed by Filter": 4900494}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 53435.99, "Total Cost": 53435.99, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 277.603, "Actual Total Time": 277.609, "Actual Rows": 26, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3055.03, "Total Cost": 53435.99, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 76.79, "Actual Total Time": 277.566, "Actual Rows": 26, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3054.61, "Total Cost": 53427.15, "Plan Rows": 20, "Plan Width": 16, "Actual Startup Time": 76.15, "Actual Total Time": 276.293, "Actual Rows": 783, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 101.512, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 3054.6, "Total Cost": 3054.6, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 75.809, "Actual Total Time": 75.813, "Actual Rows": 189, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 16, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2478.72, "Total Cost": 3054.6, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 62.017, "Actual Total Time": 75.784, "Actual Rows": 189, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2478.57, "Total Cost": 3054.06, "Plan Rows": 3, "Plan Width": 12, "Actual Startup Time": 61.628, "Actual Total Time": 72.746, "Actual Rows": 3346, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ml.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 8, "Actual Startup Time": 0.014, "Actual Total Time": 2.027, "Actual Rows": 29997, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2478.47, "Total Cost": 2478.47, "Plan Rows": 8, "Plan Width": 4, "Actual Startup Time": 61.574, "Actual Total Time": 61.576, "Actual Rows": 110494, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 1024, "Hash Batches": 2, "Original Hash Batches": 1, "Peak Memory Usage": 3073, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 37.89, "Total Cost": 2478.47, "Plan Rows": 8, "Plan Width": 4, "Actual Startup Time": 0.063, "Actual Total Time": 46.975, "Actual Rows": 110494, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.subject_id = cct1.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 0.026, "Actual Total Time": 32.04, "Actual Rows": 110494, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.status_id = cct2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.011, "Actual Total Time": 10.699, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.006, "Actual Total Time": 0.006, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'complete'::text)", "Rows Removed by Filter": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 7, "Plan Width": 4, "Actual Startup Time": 0.029, "Actual Total Time": 0.029, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 7, "Plan Width": 4, "Actual Startup Time": 0.02, "Actual Total Time": 0.021, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((kind)::text = ANY ('{cast,crew}'::text[]))", "Rows Removed by Filter": 2}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "link_type_pkey", "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 10038, "Index Cond": "(id = ml.link_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((link)::text ~~ '%follow%'::text)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 2350, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = 'sequel'::text)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 154, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 1950) AND (production_year <= 2000))", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 1163, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 0}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 1106, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))", "Rows Removed by Filter": 1}]}]}, "Planning Time": 204.501, "Triggers": [], "Execution Time": 1148.47}]
[{"Bao": {"Bao prediction": 3532.772, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 544532.56, "Total Cost": 544532.57, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2351.906, "Actual Total Time": 2399.254, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 544532.35, "Total Cost": 544532.56, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2350.329, "Actual Total Time": 2399.241, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 543532.35, "Total Cost": 543532.36, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2348.057, "Actual Total Time": 2348.066, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 525396.65, "Total Cost": 543532.35, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2279.839, "Actual Total Time": 2347.165, "Actual Rows": 22728, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 17029.39, "Plan Rows": 295012, "Plan Width": 4, "Actual Startup Time": 0.019, "Actual Total Time": 48.061, "Actual Rows": 228698, "Actual Loops": 3, "Filter": "((name IS NOT NULL) AND (((name)::text ~~ '%a%'::text) OR ((name)::text ~~ 'A%'::text)))", "Rows Removed by Filter": 71749}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 525396.64, "Total Cost": 525396.64, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 2279.473, "Actual Total Time": 2279.48, "Actual Rows": 13386, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2968, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 525392.15, "Total Cost": 525396.64, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 2147.151, "Actual Total Time": 2241.736, "Actual Rows": 13386, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Merge Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 525391.72, "Total Cost": 525396.18, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2147.126, "Actual Total Time": 2199.142, "Actual Rows": 21216, "Actual Loops": 3, "Inner Unique": false, "Merge Cond": "(ci.movie_id = ml.linked_movie_id)", "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 524801.51, "Total Cost": 524802.26, "Plan Rows": 298, "Plan Width": 16, "Actual Startup Time": 2136.564, "Actual Total Time": 2165.918, "Actual Rows": 305716, "Actual Loops": 3, "Sort Key": ["ci.movie_id"], "Sort Method": "external merge", "Sort Space Used": 7888, "Sort Space Type": "Disk", "Workers": [{"Worker Number": 0, "Sort Method": "external merge", "Sort Space Used": 7752, "Sort Space Type": "Disk"}, {"Worker Number": 1, "Sort Method": "external merge", "Sort Space Used": 7768, "Sort Space Type": "Disk"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 64541.14, "Total Cost": 524789.27, "Plan Rows": 298, "Plan Width": 16, "Actual Startup Time": 216.509, "Actual Total Time": 2051.099, "Actual Rows": 305764, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.006, "Actual Total Time": 860.213, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 64540.72, "Total Cost": 64540.72, "Plan Rows": 34, "Plan Width": 8, "Actual Startup Time": 216.406, "Actual Total Time": 216.409, "Actual Rows": 4354, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 792, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.86, "Total Cost": 64540.72, "Plan Rows": 34, "Plan Width": 8, "Actual Startup Time": 0.126, "Actual Total Time": 203.589, "Actual Rows": 4354, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 63502.14, "Plan Rows": 292, "Plan Width": 4, "Actual Startup Time": 0.058, "Actual Total Time": 106.166, "Actual Rows": 28061, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(pi.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "person_info", "Alias": "pi", "Startup Cost": 0.0, "Total Cost": 63409.96, "Plan Rows": 32957, "Plan Width": 8, "Actual Startup Time": 0.014, "Actual Total Time": 101.533, "Actual Rows": 28061, "Actual Loops": 3, "Filter": "(note IS NOT NULL)", "Rows Removed by Filter": 959827}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.035, "Actual Total Time": 0.036, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.024, "Actual Total Time": 0.03, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'mini biography'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 3.56, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 84183, "Index Cond": "(id = pi.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name_pcode_cf)::text >= 'A'::text) AND ((name_pcode_cf)::text <= 'F'::text) AND (((gender)::text = 'm'::text) OR (((gender)::text = 'f'::text) AND ((name)::text ~~ 'A%'::text))))", "Rows Removed by Filter": 1}]}]}]}]}, {"Node Type": "Sort", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 590.21, "Total Cost": 591.69, "Plan Rows": 591, "Plan Width": 4, "Actual Startup Time": 10.525, "Actual Total Time": 13.426, "Actual Rows": 33646, "Actual Loops": 3, "Sort Key": ["ml.linked_movie_id"], "Sort Method": "quicksort", "Sort Space Used": 1777, "Sort Space Type": "Memory", "Workers": [{"Worker Number": 0, "Sort Method": "quicksort", "Sort Space Used": 1777, "Sort Space Type": "Memory"}, {"Worker Number": 1, "Sort Method": "quicksort", "Sort Space Used": 1777, "Sort Space Type": "Memory"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 20.82, "Total Cost": 563.0, "Plan Rows": 591, "Plan Width": 4, "Actual Startup Time": 0.071, "Actual Total Time": 5.75, "Actual Rows": 21505, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ml.link_type_id = lt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 8, "Actual Startup Time": 0.029, "Actual Total Time": 1.937, "Actual Rows": 29997, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 20.65, "Total Cost": 20.65, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 0.032, "Actual Total Time": 0.032, "Actual Rows": 4, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.0, "Total Cost": 20.65, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 0.026, "Actual Total Time": 0.028, "Actual Rows": 4, "Actual Loops": 3, "Filter": "((link)::text = ANY ('{references,\"referenced in\",features,\"featured in\"}'::text[]))", "Rows Removed by Filter": 14}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 63648, "Index Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 1980) AND (production_year <= 2010))", "Rows Removed by Filter": 0}]}]}]}]}]}]}, "Planning Time": 87.734, "Triggers": [], "Execution Time": 2400.342}]
[{"Bao": {"Bao prediction": 5777.424, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 580748.48, "Total Cost": 580748.49, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2818.546, "Actual Total Time": 2865.006, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 580748.27, "Total Cost": 580748.48, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2816.614, "Actual Total Time": 2864.997, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 579748.27, "Total Cost": 579748.28, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2814.48, "Actual Total Time": 2814.492, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 562595.7, "Total Cost": 579235.99, "Plan Rows": 204910, "Plan Width": 0, "Actual Startup Time": 2752.754, "Actual Total Time": 2809.885, "Actual Rows": 107668, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an1.person_id = n1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an1", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.014, "Actual Total Time": 25.471, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 561481.05, "Total Cost": 561481.05, "Plan Rows": 89172, "Plan Width": 8, "Actual Startup Time": 2680.913, "Actual Total Time": 2680.921, "Actual Rows": 95179, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 262144, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 2880, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 527127.79, "Total Cost": 561481.05, "Plan Rows": 89172, "Plan Width": 8, "Actual Startup Time": 2597.279, "Actual Total Time": 2656.237, "Actual Rows": 95179, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 5344.51, "Total Cost": 37859.67, "Plan Rows": 391078, "Plan Width": 4, "Actual Startup Time": 13.936, "Actual Total Time": 203.101, "Actual Rows": 384599, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_id = cn.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.008, "Actual Total Time": 64.397, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 4722.92, "Total Cost": 4722.92, "Plan Rows": 49727, "Plan Width": 4, "Actual Startup Time": 13.826, "Actual Total Time": 13.828, "Actual Rows": 28281, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 4416, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.0, "Total Cost": 4722.92, "Plan Rows": 49727, "Plan Width": 4, "Actual Startup Time": 0.014, "Actual Total Time": 9.397, "Actual Rows": 28281, "Actual Loops": 3, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 50051}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 520720.24, "Total Cost": 520720.24, "Plan Rows": 85044, "Plan Width": 16, "Actual Startup Time": 2348.954, "Actual Total Time": 2348.957, "Actual Rows": 92134, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 262144, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 2176, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 19.79, "Total Cost": 520720.24, "Plan Rows": 85044, "Plan Width": 16, "Actual Startup Time": 1435.9, "Actual Total Time": 2310.497, "Actual Rows": 92134, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 19.36, "Total Cost": 482240.5, "Plan Rows": 85044, "Plan Width": 12, "Actual Startup Time": 1435.869, "Actual Total Time": 2029.581, "Actual Rows": 92134, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 443520.17, "Plan Rows": 85044, "Plan Width": 8, "Actual Startup Time": 1435.812, "Actual Total Time": 1835.982, "Actual Rows": 92134, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 12, "Actual Startup Time": 0.013, "Actual Total Time": 841.23, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.024, "Actual Total Time": 0.024, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.019, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((role)::text = 'costume designer'::text)", "Rows Removed by Filter": 11}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n1", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 276403, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 276403}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 276403, "Index Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 276403}]}]}]}]}]}]}]}]}, "Planning Time": 83.046, "Triggers": [], "Execution Time": 2865.09}]
[{"Bao": {"Bao prediction": 2176.54, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 533065.14, "Total Cost": 533065.15, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3017.53, "Actual Total Time": 3055.633, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 533064.93, "Total Cost": 533065.14, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 3017.441, "Actual Total Time": 3055.625, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 532064.93, "Total Cost": 532064.94, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3015.218, "Actual Total Time": 3015.225, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 515504.91, "Total Cost": 532064.87, "Plan Rows": 23, "Plan Width": 0, "Actual Startup Time": 2966.441, "Actual Total Time": 3015.1, "Actual Rows": 2715, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.028, "Actual Total Time": 24.307, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 515504.79, "Total Cost": 515504.79, "Plan Rows": 10, "Plan Width": 8, "Actual Startup Time": 2965.5, "Actual Total Time": 2965.505, "Actual Rows": 1501, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 280, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 481749.61, "Total Cost": 515504.79, "Plan Rows": 10, "Plan Width": 8, "Actual Startup Time": 2783.133, "Actual Total Time": 2932.945, "Actual Rows": 1501, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ci.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 481749.18, "Total Cost": 515499.5, "Plan Rows": 10, "Plan Width": 16, "Actual Startup Time": 2783.105, "Actual Total Time": 2927.669, "Actual Rows": 1501, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 481748.76, "Total Cost": 515487.01, "Plan Rows": 28, "Plan Width": 20, "Actual Startup Time": 2782.948, "Actual Total Time": 2918.745, "Actual Rows": 4128, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.022, "Actual Total Time": 62.496, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 481748.63, "Total Cost": 481748.63, "Plan Rows": 10, "Plan Width": 12, "Actual Startup Time": 2782.128, "Actual Total Time": 2782.131, "Actual Rows": 1895, "Actual Loops": 3, "Hash Buckets": 8192, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 472, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 19.79, "Total Cost": 481748.63, "Plan Rows": 10, "Plan Width": 12, "Actual Startup Time": 400.313, "Actual Total Time": 1384.919, "Actual Rows": 1895, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 19.36, "Total Cost": 481735.42, "Plan Rows": 20, "Plan Width": 16, "Actual Startup Time": 400.283, "Actual Total Time": 1379.725, "Actual Rows": 2184, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 480120.81, "Plan Rows": 2103, "Plan Width": 12, "Actual Startup Time": 398.57, "Actual Total Time": 1222.975, "Actual Rows": 92055, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 479115.98, "Plan Rows": 373356, "Plan Width": 16, "Actual Startup Time": 0.026, "Actual Total Time": 1193.876, "Actual Rows": 289159, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(voice),\"(voice: Japanese version)\",\"(voice) (uncredited)\",\"(voice: English version)\"}'::text[]))", "Rows Removed by Filter": 11792289}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.021, "Actual Total Time": 0.022, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.017, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((role)::text = 'actress'::text)", "Rows Removed by Filter": 11}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.77, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 276166, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 0.66, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 6552, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 5686}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 12383, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.52, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 4503, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 4503}]}]}]}]}]}]}, "Planning Time": 87.242, "Triggers": [], "Execution Time": 3055.73}]
[{"Bao": {"Bao prediction": 2666.382, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 562549.61, "Total Cost": 562549.62, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2810.184, "Actual Total Time": 2856.299, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 562549.4, "Total Cost": 562549.61, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2809.523, "Actual Total Time": 2856.294, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 561549.4, "Total Cost": 561549.41, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2807.195, "Actual Total Time": 2807.204, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 544987.97, "Total Cost": 561548.12, "Plan Rows": 512, "Plan Width": 0, "Actual Startup Time": 2736.338, "Actual Total Time": 2802.865, "Actual Rows": 106644, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.021, "Actual Total Time": 24.343, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 544985.2, "Total Cost": 544985.2, "Plan Rows": 222, "Plan Width": 8, "Actual Startup Time": 2735.98, "Actual Total Time": 2735.988, "Actual Rows": 73870, "Actual Loops": 3, "Hash Buckets": 262144, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 12824, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 84637.06, "Total Cost": 544985.2, "Plan Rows": 222, "Plan Width": 8, "Actual Startup Time": 437.556, "Actual Total Time": 2655.124, "Actual Rows": 73870, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 84636.63, "Total Cost": 544884.12, "Plan Rows": 222, "Plan Width": 4, "Actual Startup Time": 437.53, "Actual Total Time": 2512.382, "Actual Rows": 73870, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.009, "Actual Total Time": 881.721, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 84636.5, "Total Cost": 84636.5, "Plan Rows": 10, "Plan Width": 12, "Actual Startup Time": 437.441, "Actual Total Time": 437.447, "Actual Rows": 2846, "Actual Loops": 3, "Hash Buckets": 8192, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 600, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50885.39, "Total Cost": 84636.5, "Plan Rows": 10, "Plan Width": 12, "Actual Startup Time": 263.404, "Actual Total Time": 410.359, "Actual Rows": 2846, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50884.97, "Total Cost": 84623.12, "Plan Rows": 30, "Plan Width": 16, "Actual Startup Time": 263.367, "Actual Total Time": 403.893, "Actual Rows": 3802, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.014, "Actual Total Time": 63.904, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50884.91, "Total Cost": 50884.91, "Plan Rows": 5, "Plan Width": 8, "Actual Startup Time": 262.993, "Actual Total Time": 262.996, "Actual Rows": 2309, "Actual Loops": 3, "Hash Buckets": 8192, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 472, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.57, "Total Cost": 50884.91, "Plan Rows": 5, "Plan Width": 8, "Actual Startup Time": 11.321, "Actual Total Time": 255.902, "Actual Rows": 2309, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 11.156, "Actual Total Time": 216.064, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 100.947, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 11.113, "Actual Total Time": 11.114, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.523, "Actual Total Time": 11.109, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'character-name-in-title'::text)", "Rows Removed by Filter": 134169}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 41840, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(episode_nr < 100)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 11406, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 221609, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 221609}]}]}]}]}]}]}, "Planning Time": 87.765, "Triggers": [], "Execution Time": 2856.395}]
[{"Bao": {"Bao prediction": 3070.665, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 787168.13, "Total Cost": 787168.14, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2540.02, "Actual Total Time": 2597.439, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 787167.91, "Total Cost": 787168.12, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2539.167, "Actual Total Time": 2597.433, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 786167.91, "Total Cost": 786167.92, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2536.559, "Actual Total Time": 2536.576, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 752428.09, "Total Cost": 786167.91, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2391.744, "Actual Total Time": 2536.501, "Actual Rows": 1192, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 752427.66, "Total Cost": 786166.57, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 2391.728, "Actual Total Time": 2533.467, "Actual Rows": 1371, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 752427.24, "Total Cost": 786165.4, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2391.346, "Actual Total Time": 2526.085, "Actual Rows": 4475, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.025, "Actual Total Time": 63.502, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 752427.23, "Total Cost": 752427.23, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2388.792, "Actual Total Time": 2388.808, "Actual Rows": 1304, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 280, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 735866.25, "Total Cost": 752427.23, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2327.595, "Actual Total Time": 2376.915, "Actual Rows": 1304, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 735865.82, "Total Cost": 752425.77, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 2327.571, "Actual Total Time": 2374.375, "Actual Rows": 1338, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.014, "Actual Total Time": 24.03, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 735865.81, "Total Cost": 735865.81, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2326.778, "Actual Total Time": 2326.79, "Actual Rows": 840, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 280, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 480149.95, "Total Cost": 735865.81, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2119.426, "Actual Total Time": 2263.869, "Actual Rows": 840, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 480149.52, "Total Cost": 735856.34, "Plan Rows": 6, "Plan Width": 16, "Actual Startup Time": 2118.817, "Actual Total Time": 2151.689, "Actual Rows": 49045, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 255704.99, "Plan Rows": 1125, "Plan Width": 4, "Actual Startup Time": 202.47, "Actual Total Time": 770.205, "Actual Rows": 150346, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 255356.52, "Plan Rows": 127064, "Plan Width": 8, "Actual Startup Time": 81.687, "Actual Total Time": 751.026, "Actual Rows": 150368, "Actual Loops": 3, "Filter": "((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))", "Rows Removed by Filter": 4794872}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.026, "Actual Total Time": 0.027, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.02, "Actual Total Time": 0.025, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 480120.81, "Total Cost": 480120.81, "Plan Rows": 2103, "Plan Width": 12, "Actual Startup Time": 1329.05, "Actual Total Time": 1329.057, "Actual Rows": 92055, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 8192, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 2208, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 480120.81, "Plan Rows": 2103, "Plan Width": 12, "Actual Startup Time": 399.374, "Actual Total Time": 1297.25, "Actual Rows": 92055, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 479115.98, "Plan Rows": 373356, "Plan Width": 16, "Actual Startup Time": 0.036, "Actual Total Time": 1268.972, "Actual Rows": 289159, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(voice),\"(voice: Japanese version)\",\"(voice) (uncredited)\",\"(voice: English version)\"}'::text[]))", "Rows Removed by Filter": 11792289}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.023, "Actual Total Time": 0.024, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.019, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((role)::text = 'actress'::text)", "Rows Removed by Filter": 11}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 1.58, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 147136, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 1.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 4014, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 3913}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 1.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 13425, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 1.33, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 4113, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2000)", "Rows Removed by Filter": 0}]}]}]}]}, "Planning Time": 111.778, "Triggers": [], "Execution Time": 2597.553}]
[{"Bao": {"Bao prediction": 2362.294, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 340002.36, "Total Cost": 340002.37, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1369.067, "Actual Total Time": 1395.376, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 340002.15, "Total Cost": 340002.36, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 1368.94, "Actual Total Time": 1395.37, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 339002.15, "Total Cost": 339002.16, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1366.749, "Actual Total Time": 1366.76, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 35316.5, "Total Cost": 339001.0, "Plan Rows": 460, "Plan Width": 0, "Actual Startup Time": 213.122, "Actual Total Time": 1366.731, "Actual Rows": 223, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it.id)", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 35312.96, "Total Cost": 338996.2, "Plan Rows": 460, "Plan Width": 4, "Actual Startup Time": 212.99, "Actual Total Time": 1366.545, "Actual Rows": 223, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 35312.53, "Total Cost": 338539.2, "Plan Rows": 665, "Plan Width": 12, "Actual Startup Time": 212.956, "Actual Total Time": 1364.508, "Actual Rows": 230, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 302038.28, "Plan Rows": 316166, "Plan Width": 8, "Actual Startup Time": 0.556, "Actual Total Time": 1204.627, "Actual Rows": 235558, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))", "Rows Removed by Filter": 4709682}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 35307.43, "Total Cost": 35307.43, "Plan Rows": 408, "Plan Width": 4, "Actual Startup Time": 142.019, "Actual Total Time": 142.027, "Actual Rows": 266, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 35307.43, "Plan Rows": 408, "Plan Width": 4, "Actual Startup Time": 104.483, "Actual Total Time": 141.921, "Actual Rows": 266, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 35097.06, "Plan Rows": 72500, "Plan Width": 8, "Actual Startup Time": 0.018, "Actual Total Time": 136.527, "Actual Rows": 98543, "Actual Loops": 3, "Filter": "(((note)::text !~~ '%(TV)%'::text) AND ((note)::text ~~ '%(USA)%'::text))", "Rows Removed by Filter": 771167}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.01, "Actual Total Time": 0.011, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.69, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.008, "Actual Rows": 1, "Actual Loops": 691, "Index Cond": "(id = mi.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 1990)", "Rows Removed by Filter": 0}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.13, "Total Cost": 2.13, "Plan Rows": 113, "Plan Width": 4, "Actual Startup Time": 0.046, "Actual Total Time": 0.046, "Actual Rows": 113, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 12, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.13, "Plan Rows": 113, "Plan Width": 4, "Actual Startup Time": 0.02, "Actual Total Time": 0.029, "Actual Rows": 113, "Actual Loops": 3}]}]}]}]}]}, "Planning Time": 79.644, "Triggers": [], "Execution Time": 1395.437}]
[{"Bao": {"Bao prediction": 3784.696, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 871542.26, "Total Cost": 871542.27, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3226.039, "Actual Total Time": 3284.455, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 821164.29, "Total Cost": 871542.26, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2984.97, "Actual Total Time": 3284.272, "Actual Rows": 2825, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 820164.29, "Total Cost": 870542.16, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2980.915, "Actual Total Time": 3221.837, "Actual Rows": 942, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 820163.86, "Total Cost": 870540.81, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2980.881, "Actual Total Time": 3219.615, "Actual Rows": 942, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 820163.44, "Total Cost": 870535.8, "Plan Rows": 5, "Plan Width": 8, "Actual Startup Time": 2977.683, "Actual Total Time": 3160.834, "Actual Rows": 35802, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.009, "Actual Total Time": 103.71, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 820163.42, "Total Cost": 820163.42, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2938.892, "Actual Total Time": 2938.905, "Actual Rows": 339, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 786357.62, "Total Cost": 820163.42, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2575.864, "Actual Total Time": 2938.723, "Actual Rows": 339, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 786357.19, "Total Cost": 820162.26, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2575.833, "Actual Total Time": 2937.471, "Actual Rows": 339, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 786356.77, "Total Cost": 820095.45, "Plan Rows": 68, "Plan Width": 24, "Actual Startup Time": 2548.84, "Actual Total Time": 2724.832, "Actual Rows": 124952, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.017, "Actual Total Time": 62.687, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 786356.49, "Total Cost": 786356.49, "Plan Rows": 23, "Plan Width": 16, "Actual Startup Time": 2548.357, "Actual Total Time": 2548.367, "Actual Rows": 18052, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 3608, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 286435.36, "Total Cost": 786356.49, "Plan Rows": 23, "Plan Width": 16, "Actual Startup Time": 1608.289, "Actual Total Time": 2532.243, "Actual Rows": 18052, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 497985.06, "Plan Rows": 516258, "Plan Width": 8, "Actual Startup Time": 80.136, "Actual Total Time": 1381.247, "Actual Rows": 414905, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(writer),\"(head writer)\",\"(written by)\",(story),\"(story editor)\"}'::text[]))", "Rows Removed by Filter": 11666543}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 286435.15, "Total Cost": 286435.15, "Plan Rows": 17, "Plan Width": 8, "Actual Startup Time": 1096.095, "Actual Total Time": 1096.099, "Actual Rows": 34172, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 6104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 15319.64, "Total Cost": 286435.15, "Plan Rows": 17, "Plan Width": 8, "Actual Startup Time": 1058.763, "Actual Total Time": 1082.626, "Actual Rows": 34172, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 271115.48, "Plan Rows": 637, "Plan Width": 4, "Actual Startup Time": 812.393, "Actual Total Time": 927.58, "Actual Rows": 62198, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 270917.11, "Plan Rows": 71947, "Plan Width": 8, "Actual Startup Time": 533.585, "Actual Total Time": 919.578, "Actual Rows": 62990, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))", "Rows Removed by Filter": 4882250}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 0.018, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.009, "Actual Total Time": 0.015, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'genres'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 15253.6, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 118.516, "Actual Total Time": 118.517, "Actual Rows": 153308, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 16384, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 3328, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 0.06, "Actual Total Time": 80.682, "Actual Rows": 153308, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.015, "Actual Total Time": 33.787, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.033, "Actual Total Time": 0.033, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.025, "Actual Total Time": 0.027, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'votes'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.98, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 374857, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name)::text ~~ 'Lionsgate%'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 1.15, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 1017, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 1017}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.98, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 107406, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 1.34, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 2825, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 2825}]}]}]}, "Planning Time": 163.306, "Triggers": [], "Execution Time": 3284.642}]
[{"Bao": {"Bao prediction": 2333.801, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 562438.7, "Total Cost": 562438.71, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2151.853, "Actual Total Time": 2192.235, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 562438.49, "Total Cost": 562438.7, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2151.719, "Actual Total Time": 2192.224, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 561438.49, "Total Cost": 561438.5, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2149.341, "Actual Total Time": 2149.348, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 544878.44, "Total Cost": 561438.4, "Plan Rows": 36, "Plan Width": 0, "Actual Startup Time": 2104.4, "Actual Total Time": 2149.336, "Actual Rows": 128, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.025, "Actual Total Time": 24.632, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 544878.24, "Total Cost": 544878.24, "Plan Rows": 16, "Plan Width": 8, "Actual Startup Time": 2102.304, "Actual Total Time": 2102.311, "Actual Rows": 108, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 84624.43, "Total Cost": 544878.24, "Plan Rows": 16, "Plan Width": 8, "Actual Startup Time": 402.752, "Actual Total Time": 2102.147, "Actual Rows": 108, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 84624.0, "Total Cost": 544870.96, "Plan Rows": 16, "Plan Width": 4, "Actual Startup Time": 402.725, "Actual Total Time": 2101.246, "Actual Rows": 108, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.022, "Actual Total Time": 864.141, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 84623.99, "Total Cost": 84623.99, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 383.153, "Actual Total Time": 383.157, "Actual Rows": 8, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50885.38, "Total Cost": 84623.99, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 261.718, "Actual Total Time": 383.057, "Actual Rows": 8, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50884.96, "Total Cost": 84623.1, "Plan Rows": 2, "Plan Width": 16, "Actual Startup Time": 260.834, "Actual Total Time": 382.918, "Actual Rows": 18, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.019, "Actual Total Time": 63.221, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50884.94, "Total Cost": 50884.94, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 257.058, "Actual Total Time": 257.06, "Actual Rows": 49, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.57, "Total Cost": 50884.94, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 15.068, "Actual Total Time": 256.991, "Actual Rows": 49, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 12.164, "Actual Total Time": 216.864, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 100.119, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 12.104, "Actual Total Time": 12.105, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.588, "Actual Total Time": 12.1, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'character-name-in-title'::text)", "Rows Removed by Filter": 134169}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 41840, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((episode_nr >= 50) AND (episode_nr < 100))", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.006, "Actual Total Time": 0.006, "Actual Rows": 0, "Actual Loops": 54, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.007, "Actual Total Time": 0.007, "Actual Rows": 1, "Actual Loops": 323, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 323}]}]}]}]}]}]}, "Planning Time": 87.003, "Triggers": [], "Execution Time": 2192.329}]
[{"Bao": {"Bao prediction": 3486.46, "Bao recommended hint": "SET enable_mergejoin TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 342936.71, "Total Cost": 342936.72, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 810.651, "Actual Total Time": 841.839, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 342936.5, "Total Cost": 342936.71, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 810.46, "Actual Total Time": 841.833, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 341936.5, "Total Cost": 341936.51, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 807.818, "Actual Total Time": 807.827, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 291564.1, "Total Cost": 341936.5, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 795.173, "Actual Total Time": 807.823, "Actual Rows": 5, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 291563.68, "Total Cost": 341936.04, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 782.05, "Actual Total Time": 807.316, "Actual Rows": 206, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.009, "Actual Total Time": 104.121, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 291563.67, "Total Cost": 291563.67, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 601.761, "Actual Total Time": 601.769, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 257825.2, "Total Cost": 291563.67, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 575.566, "Actual Total Time": 601.702, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 257825.05, "Total Cost": 291563.49, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 575.56, "Actual Total Time": 601.694, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 257824.62, "Total Cost": 291562.96, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 575.544, "Actual Total Time": 601.673, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 257824.48, "Total Cost": 291562.67, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 575.538, "Actual Total Time": 601.666, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 257824.33, "Total Cost": 291562.51, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 575.525, "Actual Total Time": 601.65, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 257823.91, "Total Cost": 291562.06, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 575.507, "Actual Total Time": 601.628, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 12, "Actual Startup Time": 0.017, "Actual Total Time": 62.715, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 257823.89, "Total Cost": 257823.89, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 479.372, "Actual Total Time": 479.375, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2467.01, "Total Cost": 257823.89, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 315.285, "Actual Total Time": 479.342, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 255356.52, "Plan Rows": 94, "Plan Width": 8, "Actual Startup Time": 123.333, "Actual Total Time": 456.12, "Actual Rows": 590, "Actual Loops": 3, "Filter": "(((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))", "Rows Removed by Filter": 4944650}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2457.5, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 4, "Actual Startup Time": 23.044, "Actual Total Time": 23.045, "Actual Rows": 24592, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1121, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 4, "Actual Startup Time": 0.046, "Actual Total Time": 20.209, "Actual Rows": 24592, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.status_id = cct1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 8, "Actual Startup Time": 0.021, "Actual Total Time": 8.456, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.014, "Actual Total Time": 0.015, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.007, "Actual Total Time": 0.008, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'complete+verified'::text)", "Rows Removed by Filter": 3}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.009, "Actual Total Time": 0.009, "Actual Rows": 1, "Actual Loops": 6, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.006, "Actual Total Time": 0.007, "Actual Rows": 1, "Actual Loops": 6, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 6}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.14, "Total Cost": 0.22, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 6, "Index Cond": "(id = mi.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.52, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.009, "Actual Total Time": 0.009, "Actual Rows": 1, "Actual Loops": 6, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2000)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 6, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'movie'::text)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 618, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{nerd,loner,alienation,dignity}'::text[]))", "Rows Removed by Filter": 1}]}]}]}]}, "Planning Time": 139.561, "Triggers": [], "Execution Time": 841.963}]
[{"Bao": {"Bao prediction": 3327.319, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 359412.91, "Total Cost": 359412.92, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1664.026, "Actual Total Time": 1696.254, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 309040.41, "Total Cost": 359412.91, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1319.188, "Actual Total Time": 1696.121, "Actual Rows": 2851, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 308040.41, "Total Cost": 358412.81, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1308.595, "Actual Total Time": 1659.835, "Actual Rows": 950, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 308039.99, "Total Cost": 358412.35, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1279.354, "Actual Total Time": 1497.663, "Actual Rows": 106470, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.019, "Actual Total Time": 99.092, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 308039.98, "Total Cost": 308039.98, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1275.522, "Actual Total Time": 1275.53, "Actual Rows": 1224, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 280, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 272712.01, "Total Cost": 308039.98, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 989.755, "Actual Total Time": 1196.595, "Actual Rows": 1224, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 272711.86, "Total Cost": 308039.81, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 989.743, "Actual Total Time": 1195.394, "Actual Rows": 1224, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 272711.44, "Total Cost": 308039.26, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 989.726, "Actual Total Time": 1191.81, "Actual Rows": 1478, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 272711.29, "Total Cost": 308038.41, "Plan Rows": 5, "Plan Width": 28, "Actual Startup Time": 989.504, "Actual Total Time": 1189.826, "Actual Rows": 1907, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 272710.86, "Total Cost": 308027.32, "Plan Rows": 18, "Plan Width": 20, "Actual Startup Time": 988.747, "Actual Total Time": 1134.933, "Actual Rows": 26221, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 35097.06, "Plan Rows": 58487, "Plan Width": 12, "Actual Startup Time": 0.037, "Actual Total Time": 126.712, "Actual Rows": 101090, "Actual Loops": 3, "Filter": "(((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))", "Rows Removed by Filter": 768619}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 272710.09, "Total Cost": 272710.09, "Plan Rows": 61, "Plan Width": 8, "Actual Startup Time": 988.605, "Actual Total Time": 988.609, "Actual Rows": 49082, "Actual Loops": 3, "Hash Buckets": 262144, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9880, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 16511.57, "Total Cost": 272710.09, "Plan Rows": 61, "Plan Width": 8, "Actual Startup Time": 931.018, "Actual Total Time": 971.985, "Actual Rows": 49082, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 256190.56, "Plan Rows": 2702, "Plan Width": 4, "Actual Startup Time": 585.883, "Actual Total Time": 760.775, "Actual Rows": 196255, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 255356.52, "Plan Rows": 305356, "Plan Width": 8, "Actual Startup Time": 0.305, "Actual Total Time": 734.708, "Actual Rows": 223112, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Germany,German,USA,American}'::text[]))", "Rows Removed by Filter": 4722128}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.013, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.006, "Actual Total Time": 0.012, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'countries'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 16455.12, "Total Cost": 16455.12, "Plan Rows": 4322, "Plan Width": 4, "Actual Startup Time": 146.214, "Actual Total Time": 146.216, "Actual Rows": 108039, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 16384, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 2656, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 16455.12, "Plan Rows": 4322, "Plan Width": 4, "Actual Startup Time": 0.06, "Actual Total Time": 111.18, "Actual Rows": 108039, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 488356, "Plan Width": 8, "Actual Startup Time": 0.018, "Actual Total Time": 80.178, "Actual Rows": 390635, "Actual Loops": 3, "Filter": "((info)::text < '7.0'::text)", "Rows Removed by Filter": 69377}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.031, "Actual Total Time": 0.032, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.025, "Actual Total Time": 0.027, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.6, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 78662, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2008)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 5720, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = ANY ('{movie,episode}'::text[]))", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.55, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 4434, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text <> '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 3672, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 3672}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 319409, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))", "Rows Removed by Filter": 1}]}]}]}, "Planning Time": 134.45, "Triggers": [], "Execution Time": 1696.377}]
[{"Bao": {"Bao prediction": 4691.318, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 773609.79, "Total Cost": 773609.8, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 5945.668, "Actual Total Time": 6004.039, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 773609.57, "Total Cost": 773609.78, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 5945.659, "Actual Total Time": 6004.033, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 772609.57, "Total Cost": 772609.58, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 5935.205, "Actual Total Time": 5935.215, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 756049.36, "Total Cost": 772609.35, "Plan Rows": 89, "Plan Width": 0, "Actual Startup Time": 5816.802, "Actual Total Time": 5912.301, "Actual Rows": 586882, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.021, "Actual Total Time": 25.783, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 756048.87, "Total Cost": 756048.87, "Plan Rows": 39, "Plan Width": 8, "Actual Startup Time": 5741.782, "Actual Total Time": 5741.791, "Actual Rows": 262348, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 16, "Original Hash Batches": 1, "Peak Memory Usage": 3360, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 722184.7, "Total Cost": 756048.87, "Plan Rows": 39, "Plan Width": 8, "Actual Startup Time": 3763.907, "Actual Total Time": 5624.872, "Actual Rows": 262348, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 722184.28, "Total Cost": 755922.5, "Plan Rows": 108, "Plan Width": 12, "Actual Startup Time": 3763.874, "Actual Total Time": 3970.698, "Actual Rows": 1076352, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.007, "Actual Total Time": 63.525, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 722184.04, "Total Cost": 722184.04, "Plan Rows": 19, "Plan Width": 20, "Actual Startup Time": 3598.139, "Actual Total Time": 3598.145, "Actual Rows": 113945, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 3072, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 480150.81, "Total Cost": 722184.04, "Plan Rows": 19, "Plan Width": 20, "Actual Startup Time": 2269.144, "Actual Total Time": 3540.306, "Actual Rows": 113945, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 480150.38, "Total Cost": 722138.96, "Plan Rows": 35, "Plan Width": 16, "Actual Startup Time": 2269.12, "Actual Total Time": 3219.863, "Actual Rows": 166016, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 480149.95, "Total Cost": 722034.03, "Plan Rows": 72, "Plan Width": 20, "Actual Startup Time": 2269.09, "Actual Total Time": 2841.024, "Actual Rows": 182242, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 480149.52, "Total Cost": 721544.12, "Plan Rows": 311, "Plan Width": 16, "Actual Startup Time": 2269.058, "Actual Total Time": 2436.234, "Actual Rows": 182372, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 241189.17, "Plan Rows": 55082, "Plan Width": 4, "Actual Startup Time": 209.053, "Actual Total Time": 816.13, "Actual Rows": 1012240, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 224235.35, "Plan Rows": 6224235, "Plan Width": 8, "Actual Startup Time": 0.016, "Actual Total Time": 390.075, "Actual Rows": 4945240, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.044, "Actual Total Time": 0.045, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.037, "Actual Total Time": 0.043, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 480120.81, "Total Cost": 480120.81, "Plan Rows": 2103, "Plan Width": 12, "Actual Startup Time": 1344.316, "Actual Total Time": 1344.318, "Actual Rows": 92055, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 8192, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 2208, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 480120.81, "Plan Rows": 2103, "Plan Width": 12, "Actual Startup Time": 403.984, "Actual Total Time": 1312.587, "Actual Rows": 92055, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 479115.98, "Plan Rows": 373356, "Plan Width": 16, "Actual Startup Time": 0.048, "Actual Total Time": 1283.837, "Actual Rows": 289159, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(voice),\"(voice: Japanese version)\",\"(voice) (uncredited)\",\"(voice: English version)\"}'::text[]))", "Rows Removed by Filter": 11792289}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.025, "Actual Total Time": 0.026, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.02, "Actual Total Time": 0.021, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((role)::text = 'actress'::text)", "Rows Removed by Filter": 11}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 1.58, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 547117, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((gender)::text = 'f'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 1.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 546726, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 498048}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 1.29, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 498048, "Index Cond": "(id = mi.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2000)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 1.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 3229056, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1}]}]}]}]}]}]}, "Planning Time": 118.639, "Triggers": [], "Execution Time": 6004.159}]
[{"Bao": {"Bao prediction": 2898.17, "Bao recommended hint": "SET enable_nestloop TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 348795.27, "Total Cost": 348795.28, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1691.91, "Actual Total Time": 1729.932, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 348795.16, "Total Cost": 348795.27, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1691.776, "Actual Total Time": 1729.928, "Actual Rows": 2, "Actual Loops": 1, "Workers Planned": 1, "Workers Launched": 1, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 347795.16, "Total Cost": 347795.17, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1689.992, "Actual Total Time": 1690.002, "Actual Rows": 1, "Actual Loops": 2, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 342885.75, "Total Cost": 347795.16, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1677.602, "Actual Total Time": 1689.996, "Actual Rows": 26, "Actual Loops": 2, "Inner Unique": false, "Hash Cond": "(cn.id = mc.company_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.0, "Total Cost": 4722.92, "Plan Rows": 49727, "Plan Width": 4, "Actual Startup Time": 0.014, "Actual Total Time": 12.71, "Actual Rows": 42422, "Actual Loops": 2, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 75077}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 342885.74, "Total Cost": 342885.74, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1674.607, "Actual Total Time": 1674.617, "Actual Rows": 81, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 310330.62, "Total Cost": 342885.74, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1576.871, "Actual Total Time": 1674.569, "Actual Rows": 81, "Actual Loops": 2, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 32551.06, "Plan Rows": 6125, "Plan Width": 8, "Actual Startup Time": 89.055, "Actual Total Time": 233.819, "Actual Rows": 667442, "Actual Loops": 2, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 12, "Actual Startup Time": 0.005, "Actual Total Time": 89.605, "Actual Rows": 1304564, "Actual Loops": 2}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.013, "Actual Rows": 1, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.01, "Actual Total Time": 0.01, "Actual Rows": 1, "Actual Loops": 2, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 310311.69, "Total Cost": 310311.69, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1403.691, "Actual Total Time": 1403.699, "Actual Rows": 45, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 295041.42, "Total Cost": 310311.69, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1350.832, "Actual Total Time": 1403.662, "Actual Rows": 45, "Actual Loops": 2, "Inner Unique": false, "Hash Cond": "(miidx.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 0.058, "Actual Total Time": 115.21, "Actual Rows": 229962, "Actual Loops": 2, "Inner Unique": true, "Hash Cond": "(miidx.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "miidx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.012, "Actual Total Time": 47.438, "Actual Rows": 690018, "Actual Loops": 2}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.016, "Actual Rows": 1, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 2, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 295038.98, "Total Cost": 295038.98, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1275.432, "Actual Total Time": 1275.437, "Actual Rows": 64, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 54461.92, "Total Cost": 295038.98, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 640.344, "Actual Total Time": 1275.36, "Actual Rows": 64, "Actual Loops": 2, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it2.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 54459.5, "Total Cost": 295036.54, "Plan Rows": 5, "Plan Width": 12, "Actual Startup Time": 225.74, "Actual Total Time": 1275.274, "Actual Rows": 489, "Actual Loops": 2, "Inner Unique": true, "Hash Cond": "(t.kind_id = kt.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 54436.68, "Total Cost": 295010.67, "Plan Rows": 1162, "Plan Width": 16, "Actual Startup Time": 194.25, "Actual Total Time": 1275.106, "Actual Rows": 900, "Actual Loops": 2, "Inner Unique": true, "Hash Cond": "(mi.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 224235.35, "Plan Rows": 6224235, "Plan Width": 8, "Actual Startup Time": 0.005, "Actual Total Time": 547.978, "Actual Rows": 7417860, "Actual Loops": 2}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 54434.22, "Total Cost": 54434.22, "Plan Rows": 197, "Plan Width": 8, "Actual Startup Time": 192.154, "Actual Total Time": 192.154, "Actual Rows": 147, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "title", "Alias": "t", "Startup Cost": 0.0, "Total Cost": 54434.22, "Plan Rows": 197, "Plan Width": 8, "Actual Startup Time": 1.563, "Actual Total Time": 192.084, "Actual Rows": 147, "Actual Loops": 2, "Filter": "(((title)::text <> ''::text) AND (((title)::text ~~ 'Champion%'::text) OR ((title)::text ~~ 'Loser%'::text)))", "Rows Removed by Filter": 1264009}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 22.75, "Total Cost": 22.75, "Plan Rows": 5, "Plan Width": 4, "Actual Startup Time": 0.015, "Actual Total Time": 0.016, "Actual Rows": 1, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.0, "Total Cost": 22.75, "Plan Rows": 5, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 2, "Filter": "((kind)::text = 'movie'::text)", "Rows Removed by Filter": 6}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.028, "Actual Total Time": 0.028, "Actual Rows": 1, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.024, "Actual Rows": 1, "Actual Loops": 2, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}]}]}]}]}]}, "Planning Time": 93.946, "Triggers": [], "Execution Time": 1730.031}]
[{"Bao": {"Bao prediction": 2919.878, "Bao recommended hint": "SET enable_mergejoin TO off; SET enable_indexscan TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 548409.21, "Total Cost": 548409.22, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 4270.239, "Actual Total Time": 4307.735, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 514662.94, "Total Cost": 548409.21, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 3970.996, "Actual Total Time": 4304.798, "Actual Rows": 52306, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 514662.5, "Total Cost": 548404.75, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 3970.987, "Actual Total Time": 4177.073, "Actual Rows": 52306, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 514662.07, "Total Cost": 548400.31, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 3970.974, "Actual Total Time": 4046.285, "Actual Rows": 52306, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 513662.07, "Total Cost": 547400.21, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 3968.822, "Actual Total Time": 4108.985, "Actual Rows": 17435, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.03, "Actual Total Time": 61.832, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 513662.06, "Total Cost": 513662.06, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3968.248, "Actual Total Time": 3968.252, "Actual Rows": 2214, "Actual Loops": 3, "Hash Buckets": 8192, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 472, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50878.66, "Total Cost": 513662.06, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1359.543, "Actual Total Time": 3345.787, "Actual Rows": 2214, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50878.23, "Total Cost": 511127.48, "Plan Rows": 569, "Plan Width": 12, "Actual Startup Time": 245.259, "Actual Total Time": 2375.014, "Actual Rows": 346131, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = mk.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.011, "Actual Total Time": 846.752, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50878.05, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 245.212, "Actual Total Time": 245.214, "Actual Rows": 13947, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2680, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 11.982, "Actual Total Time": 218.818, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 103.109, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 11.939, "Actual Total Time": 11.94, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.555, "Actual Total Time": 11.935, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'character-name-in-title'::text)", "Rows Removed by Filter": 134169}]}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "name", "Alias": "n", "Startup Cost": 0.44, "Total Cost": 4.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 1038393, "Recheck Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name)::text ~~ 'Z%'::text)", "Rows Removed by Filter": 1, "Exact Heap Blocks": 403761, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "name_pkey", "Startup Cost": 0.0, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 1038393, "Index Cond": "(id = ci.person_id)"}]}]}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.43, "Total Cost": 4.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 52306, "Recheck Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Exact Heap Blocks": 52306, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "company_name_pkey", "Startup Cost": 0.0, "Total Cost": 0.43, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 52306, "Index Cond": "(id = mc.company_id)"}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "title", "Alias": "t", "Startup Cost": 0.44, "Total Cost": 4.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 52306, "Recheck Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Exact Heap Blocks": 52306, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "title_pkey", "Startup Cost": 0.0, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 52306, "Index Cond": "(id = ci.movie_id)"}]}]}]}, "Planning Time": 82.679, "Triggers": [], "Execution Time": 4307.819}]
[{"Bao": {"Bao prediction": 2543.096, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 840796.31, "Total Cost": 840796.32, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3339.732, "Actual Total Time": 3395.555, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 340874.52, "Total Cost": 840796.31, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2769.808, "Actual Total Time": 3395.165, "Actual Rows": 8024, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 340874.09, "Total Cost": 840795.22, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2769.661, "Actual Total Time": 3374.804, "Actual Rows": 11863, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 339874.09, "Total Cost": 839795.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2767.329, "Actual Total Time": 3329.248, "Actual Rows": 3954, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 497985.06, "Plan Rows": 516258, "Plan Width": 8, "Actual Startup Time": 102.416, "Actual Total Time": 1383.481, "Actual Rows": 414905, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(writer),\"(head writer)\",\"(written by)\",(story),\"(story editor)\"}'::text[]))", "Rows Removed by Filter": 11666543}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 339874.08, "Total Cost": 339874.08, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1910.136, "Actual Total Time": 1910.146, "Actual Rows": 4885, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1080, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 289501.38, "Total Cost": 339874.08, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1150.976, "Actual Total Time": 1772.844, "Actual Rows": 4885, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 289500.96, "Total Cost": 339873.32, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 1149.405, "Actual Total Time": 1393.522, "Actual Rows": 214476, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.018, "Actual Total Time": 101.461, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 289500.95, "Total Cost": 289500.95, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1148.695, "Actual Total Time": 1148.703, "Actual Rows": 3430, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 824, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 273658.94, "Total Cost": 289500.95, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1041.105, "Actual Total Time": 1134.123, "Actual Rows": 3430, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 273658.51, "Total Cost": 289500.01, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1041.069, "Actual Total Time": 1121.24, "Actual Rows": 3430, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 273658.36, "Total Cost": 289499.83, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1041.053, "Actual Total Time": 1111.619, "Actual Rows": 10351, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.013, "Actual Total Time": 32.012, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 273658.35, "Total Cost": 273658.35, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1040.395, "Actual Total Time": 1040.4, "Actual Rows": 3442, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 696, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2469.59, "Total Cost": 273658.35, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 871.327, "Actual Total Time": 993.858, "Actual Rows": 3442, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2469.44, "Total Cost": 273658.17, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 871.311, "Actual Total Time": 989.837, "Actual Rows": 4427, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2467.01, "Total Cost": 273655.36, "Plan Rows": 144, "Plan Width": 16, "Actual Startup Time": 625.078, "Actual Total Time": 989.083, "Actual Rows": 5289, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 270917.11, "Plan Rows": 71947, "Plan Width": 8, "Actual Startup Time": 561.803, "Actual Total Time": 954.846, "Actual Rows": 62990, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))", "Rows Removed by Filter": 4882250}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2457.5, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 24.483, "Actual Total Time": 24.485, "Actual Rows": 24592, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1217, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 0.046, "Actual Total Time": 21.449, "Actual Rows": 24592, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.status_id = cct2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.025, "Actual Total Time": 9.082, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.012, "Actual Total Time": 0.013, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.008, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'complete+verified'::text)", "Rows Removed by Filter": 3}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.031, "Actual Total Time": 0.031, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.026, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'genres'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "comp_cast_type_pkey", "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 13281, "Index Cond": "(id = cc.subject_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'cast'::text)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 31054, "Index Cond": "(id = mi_idx.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'votes'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.93, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 10291, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 10291}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.69, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 643428, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))", "Rows Removed by Filter": 1}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 1.09, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 11863, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((gender)::text = 'm'::text)", "Rows Removed by Filter": 0}]}]}, "Planning Time": 218.806, "Triggers": [], "Execution Time": 3395.673}]
[{"Bao": {"Bao prediction": 2403.057, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 514326.01, "Total Cost": 514326.02, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2968.338, "Actual Total Time": 3012.221, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 52940.46, "Total Cost": 514326.0, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 549.05, "Actual Total Time": 3012.21, "Actual Rows": 88, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 51940.46, "Total Cost": 513325.9, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 546.922, "Actual Total Time": 2966.064, "Actual Rows": 29, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 51940.03, "Total Cost": 512190.57, "Plan Rows": 2480, "Plan Width": 4, "Actual Startup Time": 322.829, "Actual Total Time": 2449.998, "Actual Rows": 261826, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.014, "Actual Total Time": 867.866, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 51939.27, "Total Cost": 51939.27, "Plan Rows": 61, "Plan Width": 8, "Actual Startup Time": 322.495, "Actual Total Time": 322.498, "Actual Rows": 4722, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 856, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3632.93, "Total Cost": 51939.27, "Plan Rows": 61, "Plan Width": 8, "Actual Startup Time": 28.8, "Actual Total Time": 264.204, "Actual Rows": 4722, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3632.5, "Total Cost": 51884.41, "Plan Rows": 112, "Plan Width": 4, "Actual Startup Time": 28.781, "Actual Total Time": 231.783, "Actual Rows": 11849, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.011, "Actual Total Time": 99.332, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 3632.4, "Total Cost": 3632.4, "Plan Rows": 8, "Plan Width": 4, "Actual Startup Time": 28.68, "Actual Total Time": 28.681, "Actual Rows": 8, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 3632.4, "Plan Rows": 8, "Plan Width": 4, "Actual Startup Time": 0.127, "Actual Total Time": 28.674, "Actual Rows": 8, "Actual Loops": 3, "Filter": "((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))", "Rows Removed by Filter": 134162}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 35548, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2000)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 785477, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name)::text ~~ '%Downey%Robert%'::text)", "Rows Removed by Filter": 1}]}]}]}, "Planning Time": 79.888, "Triggers": [], "Execution Time": 3012.281}]
[{"Bao": {"Bao prediction": 2217.842, "Bao recommended hint": "SET enable_mergejoin TO off; SET enable_indexscan TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 381981.11, "Total Cost": 381981.12, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1544.816, "Actual Total Time": 1577.366, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 350318.08, "Total Cost": 381981.1, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1479.659, "Actual Total Time": 1577.302, "Actual Rows": 743, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 350317.65, "Total Cost": 381976.65, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1478.12, "Actual Total Time": 1573.139, "Actual Rows": 1808, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 349317.65, "Total Cost": 380976.55, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1475.965, "Actual Total Time": 1540.621, "Actual Rows": 603, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 349317.49, "Total Cost": 380970.78, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1440.466, "Actual Total Time": 1539.501, "Actual Rows": 638, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 531175, "Plan Width": 12, "Actual Startup Time": 0.036, "Actual Total Time": 76.105, "Actual Rows": 423996, "Actual Loops": 3, "Filter": "(note IS NULL)", "Rows Removed by Filter": 445713}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 349317.48, "Total Cost": 349317.48, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1439.133, "Actual Total Time": 1439.143, "Actual Rows": 84, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 298852.49, "Total Cost": 349317.48, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1220.35, "Actual Total Time": 1439.033, "Actual Rows": 84, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 298852.06, "Total Cost": 349224.6, "Plan Rows": 20, "Plan Width": 24, "Actual Startup Time": 1220.053, "Actual Total Time": 1433.569, "Actual Rows": 2332, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.024, "Actual Total Time": 106.051, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 298852.04, "Total Cost": 298852.04, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1219.597, "Actual Total Time": 1219.604, "Actual Rows": 167, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3069.63, "Total Cost": 298852.04, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 788.761, "Actual Total Time": 1219.468, "Actual Rows": 167, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3069.48, "Total Cost": 298846.27, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 788.741, "Actual Total Time": 1219.141, "Actual Rows": 167, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 294257.98, "Plan Rows": 405012, "Plan Width": 4, "Actual Startup Time": 0.021, "Actual Total Time": 1149.98, "Actual Rows": 312074, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,English}'::text[]))", "Rows Removed by Filter": 4633166}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 3069.46, "Total Cost": 3069.46, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 51.569, "Actual Total Time": 51.574, "Actual Rows": 228, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 19, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2486.6, "Total Cost": 3069.46, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 40.285, "Actual Total Time": 51.532, "Actual Rows": 228, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ml.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2485.9, "Total Cost": 3064.73, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 40.258, "Actual Total Time": 50.458, "Actual Rows": 228, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ml.link_type_id = lt.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2467.01, "Total Cost": 3045.14, "Plan Rows": 267, "Plan Width": 16, "Actual Startup Time": 39.872, "Actual Total Time": 50.201, "Actual Rows": 3564, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ml.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 8, "Actual Startup Time": 0.008, "Actual Total Time": 1.991, "Actual Rows": 29997, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2457.5, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 39.821, "Actual Total Time": 39.822, "Actual Rows": 85941, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 1024, "Hash Batches": 2, "Original Hash Batches": 1, "Peak Memory Usage": 3073, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 0.031, "Actual Total Time": 27.667, "Actual Rows": 85941, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.subject_id = cct1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.013, "Actual Total Time": 9.624, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.009, "Actual Total Time": 0.009, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.006, "Actual Total Time": 0.006, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'cast'::text)", "Rows Removed by Filter": 3}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.024, "Actual Total Time": 0.025, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.019, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((link)::text ~~ '%follow%'::text)", "Rows Removed by Filter": 16}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "title", "Alias": "t", "Startup Cost": 0.7, "Total Cost": 4.72, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 1, "Actual Loops": 684, "Recheck Cond": "(id = cc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 1950) AND (production_year <= 2010))", "Rows Removed by Filter": 0, "Exact Heap Blocks": 228, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "title_pkey", "Startup Cost": 0.0, "Total Cost": 0.7, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 684, "Index Cond": "(id = cc.movie_id)"}]}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.16, "Total Cost": 4.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 500, "Recheck Cond": "(id = cc.status_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text ~~ 'complete%'::text)", "Rows Removed by Filter": 0, "Exact Heap Blocks": 65, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "comp_cast_type_pkey", "Startup Cost": 0.0, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 1, "Actual Loops": 500, "Index Cond": "(id = cc.status_id)"}]}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.43, "Total Cost": 4.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 6996, "Recheck Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = 'sequel'::text)", "Rows Removed by Filter": 1, "Exact Heap Blocks": 1914, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "keyword_pkey", "Startup Cost": 0.0, "Total Cost": 0.43, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 6996, "Index Cond": "(id = mk.keyword_id)"}]}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.16, "Total Cost": 4.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 1913, "Recheck Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 0, "Exact Heap Blocks": 1796, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "company_type_pkey", "Startup Cost": 0.0, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 1, "Actual Loops": 1913, "Index Cond": "(id = mc.company_type_id)"}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.43, "Total Cost": 4.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 1808, "Recheck Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))", "Rows Removed by Filter": 1, "Exact Heap Blocks": 1808, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "company_name_pkey", "Startup Cost": 0.0, "Total Cost": 0.43, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 1808, "Index Cond": "(id = mc.company_id)"}]}]}]}, "Planning Time": 206.907, "Triggers": [], "Execution Time": 1577.528}]
[{"Bao": {"Bao prediction": 3262.926, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 514108.77, "Total Cost": 514108.78, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3527.116, "Actual Total Time": 3579.993, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 514108.56, "Total Cost": 514108.77, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 3524.199, "Actual Total Time": 3579.987, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 513108.56, "Total Cost": 513108.57, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3522.567, "Actual Total Time": 3522.58, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 462736.13, "Total Cost": 513108.55, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2632.55, "Actual Total Time": 3522.446, "Actual Rows": 1802, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 462735.7, "Total Cost": 513108.1, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2632.531, "Actual Total Time": 3513.949, "Actual Rows": 1802, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 462735.28, "Total Cost": 513107.64, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2628.522, "Actual Total Time": 2845.598, "Actual Rows": 382088, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.015, "Actual Total Time": 99.219, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 462735.27, "Total Cost": 462735.27, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2587.689, "Actual Total Time": 2587.701, "Actual Rows": 3588, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 824, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2488.29, "Total Cost": 462735.27, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 297.628, "Actual Total Time": 2392.751, "Actual Rows": 3588, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2487.86, "Total Cost": 462734.81, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 297.507, "Actual Total Time": 2201.322, "Actual Rows": 131779, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 12, "Actual Startup Time": 0.013, "Actual Total Time": 866.964, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2487.85, "Total Cost": 2487.85, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 297.459, "Actual Total Time": 297.469, "Actual Rows": 4696, "Actual Loops": 3, "Hash Buckets": 8192, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 248, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 19.5, "Total Cost": 2487.85, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.242, "Actual Total Time": 296.415, "Actual Rows": 4696, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 19.36, "Total Cost": 2487.67, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 0.176, "Actual Total Time": 272.444, "Actual Rows": 23557, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2485.89, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.052, "Actual Total Time": 66.276, "Actual Rows": 85941, "Actual Loops": 3, "Inner Unique": false, "Join Filter": "(cc.status_id = cct2.id)", "Rows Removed by Join Filter": 85941, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.019, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((kind)::text ~~ '%complete%'::text)", "Rows Removed by Filter": 2}, {"Node Type": "Hash Join", "Parent Relationship": "Inner", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 0.019, "Actual Total Time": 27.291, "Actual Rows": 85941, "Actual Loops": 6, "Inner Unique": true, "Hash Cond": "(cc.subject_id = cct1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.006, "Actual Total Time": 9.378, "Actual Rows": 135086, "Actual Loops": 6}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.008, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.004, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'cast'::text)", "Rows Removed by Filter": 3}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 1.78, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 257823, "Index Cond": "(id = cc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2000)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 70671, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'movie'::text)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 395336, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 1146265, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 1, "Actual Loops": 5406, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 5406}]}]}]}]}, "Planning Time": 108.179, "Triggers": [], "Execution Time": 3580.096}]
[{"Bao": {"Bao prediction": 3226.222, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 838883.35, "Total Cost": 838883.36, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2483.583, "Actual Total Time": 2543.279, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 838883.13, "Total Cost": 838883.34, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2483.399, "Actual Total Time": 2543.273, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 837883.13, "Total Cost": 837883.14, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2480.88, "Actual Total Time": 2480.895, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 787509.16, "Total Cost": 837883.13, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2423.545, "Actual Total Time": 2480.883, "Actual Rows": 28, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 787508.73, "Total Cost": 837881.79, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2423.522, "Actual Total Time": 2480.786, "Actual Rows": 28, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 787508.31, "Total Cost": 837880.67, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2423.285, "Actual Total Time": 2479.097, "Actual Rows": 895, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.016, "Actual Total Time": 104.116, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 787508.3, "Total Cost": 787508.3, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2273.173, "Actual Total Time": 2273.186, "Actual Rows": 6, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 287584.41, "Total Cost": 787508.3, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 1919.181, "Actual Total Time": 2273.148, "Actual Rows": 6, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 287583.98, "Total Cost": 787507.08, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1719.852, "Actual Total Time": 2272.889, "Actual Rows": 28, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 287583.56, "Total Cost": 787504.59, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 1711.533, "Actual Total Time": 2270.525, "Actual Rows": 1054, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 497985.06, "Plan Rows": 516258, "Plan Width": 8, "Actual Startup Time": 90.196, "Actual Total Time": 1384.976, "Actual Rows": 414905, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(writer),\"(head writer)\",\"(written by)\",(story),\"(story editor)\"}'::text[]))", "Rows Removed by Filter": 11666543}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 287583.55, "Total Cost": 287583.55, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 852.355, "Actual Total Time": 852.365, "Actual Rows": 1236, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 312, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 272313.28, "Total Cost": 287583.55, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 736.648, "Actual Total Time": 826.599, "Actual Rows": 1236, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 0.055, "Actual Total Time": 79.054, "Actual Rows": 153308, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 33.52, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.016, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.012, "Actual Total Time": 0.013, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'votes'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 272310.79, "Total Cost": 272310.79, "Plan Rows": 5, "Plan Width": 12, "Actual Startup Time": 735.475, "Actual Total Time": 735.479, "Actual Rows": 1237, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 280, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 32430.43, "Total Cost": 272310.79, "Plan Rows": 5, "Plan Width": 12, "Actual Startup Time": 637.51, "Actual Total Time": 709.073, "Actual Rows": 1237, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mc.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 239881.42, "Plan Rows": 270, "Plan Width": 4, "Actual Startup Time": 528.128, "Actual Total Time": 597.489, "Actual Rows": 24086, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 239795.93, "Plan Rows": 30499, "Plan Width": 8, "Actual Startup Time": 374.815, "Actual Total Time": 594.39, "Actual Rows": 24349, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Horror,Thriller}'::text[]))", "Rows Removed by Filter": 4920891}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.039, "Actual Total Time": 0.04, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.02, "Actual Total Time": 0.034, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'genres'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 32379.21, "Total Cost": 32379.21, "Plan Rows": 3903, "Plan Width": 8, "Actual Startup Time": 109.138, "Actual Total Time": 109.139, "Actual Rows": 2654, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 16384, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 512, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 32379.21, "Plan Rows": 3903, "Plan Width": 8, "Actual Startup Time": 0.836, "Actual Total Time": 108.601, "Actual Rows": 2654, "Actual Loops": 3, "Filter": "((note)::text ~~ '%(Blu-ray)%'::text)", "Rows Removed by Filter": 867055}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 2.33, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 3162, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name)::text ~~ 'Lionsgate%'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 1.21, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.009, "Actual Total Time": 0.009, "Actual Rows": 0, "Actual Loops": 83, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year > 2000) AND (((title)::text ~~ '%Freddy%'::text) OR ((title)::text ~~ '%Jason%'::text) OR ((title)::text ~~ 'Saw%'::text)))", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.98, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 2686, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 1.35, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 84, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((gender)::text = 'm'::text)", "Rows Removed by Filter": 0}]}]}]}]}, "Planning Time": 161.808, "Triggers": [], "Execution Time": 2543.395}]
[{"Bao": {"Bao prediction": 3293.438, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 371063.07, "Total Cost": 371063.08, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2277.449, "Actual Total Time": 2314.187, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 320689.69, "Total Cost": 371063.07, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1750.602, "Actual Total Time": 2313.947, "Actual Rows": 4115, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 319689.69, "Total Cost": 370062.97, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1749.583, "Actual Total Time": 2273.381, "Actual Rows": 1372, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 319689.27, "Total Cost": 370061.63, "Plan Rows": 3, "Plan Width": 4, "Actual Startup Time": 1747.549, "Actual Total Time": 1990.112, "Actual Rows": 153383, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.011, "Actual Total Time": 98.669, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 319689.26, "Total Cost": 319689.26, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1747.124, "Actual Total Time": 1747.143, "Actual Rows": 14805, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 3128, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 16718.33, "Total Cost": 319689.26, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1435.287, "Actual Total Time": 1721.52, "Actual Rows": 14805, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 16718.18, "Total Cost": 319684.15, "Plan Rows": 30, "Plan Width": 16, "Actual Startup Time": 1435.245, "Actual Total Time": 1696.974, "Actual Rows": 21417, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 16717.75, "Total Cost": 319640.04, "Plan Rows": 74, "Plan Width": 8, "Actual Startup Time": 1435.204, "Actual Total Time": 1498.722, "Actual Rows": 71080, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 302913.76, "Plan Rows": 2837, "Plan Width": 4, "Actual Startup Time": 969.516, "Actual Total Time": 1252.109, "Actual Rows": 204750, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 302038.28, "Plan Rows": 320570, "Plan Width": 8, "Actual Startup Time": 0.573, "Actual Total Time": 1224.236, "Actual Rows": 238737, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))", "Rows Removed by Filter": 4706503}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.006, "Actual Total Time": 0.012, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'countries'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 16653.27, "Total Cost": 16653.27, "Plan Rows": 4965, "Plan Width": 4, "Actual Startup Time": 154.918, "Actual Total Time": 154.929, "Actual Rows": 151410, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 16384, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 3328, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 16653.27, "Plan Rows": 4965, "Plan Width": 4, "Actual Startup Time": 0.062, "Actual Total Time": 116.2, "Actual Rows": 151410, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 561109, "Plan Width": 8, "Actual Startup Time": 0.02, "Actual Total Time": 78.806, "Actual Rows": 447629, "Actual Loops": 3, "Filter": "((info)::text < '8.5'::text)", "Rows Removed by Filter": 12383}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.031, "Actual Total Time": 0.037, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.025, "Actual Total Time": 0.031, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.58, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 213239, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2005)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 64250, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = ANY ('{movie,episode}'::text[]))", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 460150, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword IS NOT NULL) AND ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[])))", "Rows Removed by Filter": 1}]}]}]}, "Planning Time": 86.338, "Triggers": [], "Execution Time": 2314.28}]
[{"Bao": {"Bao prediction": 3301.012, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 404801.84, "Total Cost": 404801.85, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2661.607, "Actual Total Time": 2696.972, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 371063.55, "Total Cost": 404801.84, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2463.391, "Actual Total Time": 2694.72, "Actual Rows": 46281, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 370063.55, "Total Cost": 403801.74, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2460.886, "Actual Total Time": 2653.704, "Actual Rows": 15427, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 370063.4, "Total Cost": 403801.57, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2460.874, "Actual Total Time": 2639.673, "Actual Rows": 15427, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 370062.98, "Total Cost": 403801.13, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2460.855, "Actual Total Time": 2602.347, "Actual Rows": 21616, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 12, "Actual Startup Time": 0.011, "Actual Total Time": 61.872, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 370062.97, "Total Cost": 370062.97, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2459.593, "Actual Total Time": 2459.601, "Actual Rows": 1372, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 344, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 319689.69, "Total Cost": 370062.97, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1738.891, "Actual Total Time": 2243.439, "Actual Rows": 1372, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 319689.27, "Total Cost": 370061.63, "Plan Rows": 3, "Plan Width": 20, "Actual Startup Time": 1736.762, "Actual Total Time": 1975.475, "Actual Rows": 153383, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.011, "Actual Total Time": 96.376, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 319689.26, "Total Cost": 319689.26, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1736.523, "Actual Total Time": 1736.53, "Actual Rows": 14805, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 3128, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 16718.33, "Total Cost": 319689.26, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1415.96, "Actual Total Time": 1702.023, "Actual Rows": 14805, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 16718.18, "Total Cost": 319684.15, "Plan Rows": 30, "Plan Width": 16, "Actual Startup Time": 1415.91, "Actual Total Time": 1677.31, "Actual Rows": 21417, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 16717.75, "Total Cost": 319640.04, "Plan Rows": 74, "Plan Width": 8, "Actual Startup Time": 1415.87, "Actual Total Time": 1476.663, "Actual Rows": 71080, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 302913.76, "Plan Rows": 2837, "Plan Width": 4, "Actual Startup Time": 956.871, "Actual Total Time": 1235.812, "Actual Rows": 204750, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 302038.28, "Plan Rows": 320570, "Plan Width": 8, "Actual Startup Time": 0.539, "Actual Total Time": 1208.363, "Actual Rows": 238737, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))", "Rows Removed by Filter": 4706503}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.015, "Actual Total Time": 0.016, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'countries'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 16653.27, "Total Cost": 16653.27, "Plan Rows": 4965, "Plan Width": 4, "Actual Startup Time": 152.851, "Actual Total Time": 152.853, "Actual Rows": 151410, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 16384, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 3296, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 16653.27, "Plan Rows": 4965, "Plan Width": 4, "Actual Startup Time": 0.057, "Actual Total Time": 114.198, "Actual Rows": 151410, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 561109, "Plan Width": 8, "Actual Startup Time": 0.019, "Actual Total Time": 77.691, "Actual Rows": 447629, "Actual Loops": 3, "Filter": "((info)::text < '8.5'::text)", "Rows Removed by Filter": 12383}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.027, "Actual Total Time": 0.027, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.022, "Actual Total Time": 0.023, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.58, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 213239, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2005)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 64250, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = ANY ('{movie,episode}'::text[]))", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 460150, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 64848, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text <> '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 46281, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 46281}]}]}]}, "Planning Time": 136.047, "Triggers": [], "Execution Time": 2697.081}]
[{"Bao": {"Bao prediction": 4050.266, "Bao recommended hint": "SET enable_mergejoin TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 358497.35, "Total Cost": 358497.36, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 826.4, "Actual Total Time": 857.872, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 358497.14, "Total Cost": 358497.35, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 826.255, "Actual Total Time": 857.859, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 357497.14, "Total Cost": 357497.15, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 823.763, "Actual Total Time": 823.779, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 307124.76, "Total Cost": 357497.13, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 798.116, "Actual Total Time": 823.759, "Actual Rows": 206, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 307124.34, "Total Cost": 357496.7, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 798.095, "Actual Total Time": 823.296, "Actual Rows": 206, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.009, "Actual Total Time": 103.562, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 307124.32, "Total Cost": 307124.32, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 618.767, "Actual Total Time": 618.782, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 273385.87, "Total Cost": 307124.32, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 592.475, "Actual Total Time": 618.686, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 273385.72, "Total Cost": 307124.15, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 592.47, "Actual Total Time": 618.672, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 273385.29, "Total Cost": 307123.61, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 561.237, "Actual Total Time": 618.637, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 273385.15, "Total Cost": 307123.35, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 561.228, "Actual Total Time": 618.625, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 273385.0, "Total Cost": 307123.18, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 561.207, "Actual Total Time": 618.6, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 273384.58, "Total Cost": 307122.73, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 561.175, "Actual Total Time": 618.56, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 12, "Actual Startup Time": 0.018, "Actual Total Time": 62.98, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 273384.57, "Total Cost": 273384.57, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 496.194, "Actual Total Time": 496.197, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2467.01, "Total Cost": 273384.57, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 231.676, "Actual Total Time": 496.164, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 270917.11, "Plan Rows": 117, "Plan Width": 8, "Actual Startup Time": 127.492, "Actual Total Time": 472.812, "Actual Rows": 594, "Actual Loops": 3, "Filter": "((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))", "Rows Removed by Filter": 4944646}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2457.5, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 4, "Actual Startup Time": 23.153, "Actual Total Time": 23.155, "Actual Rows": 24592, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1121, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 4, "Actual Startup Time": 0.047, "Actual Total Time": 20.372, "Actual Rows": 24592, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.status_id = cct1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 8, "Actual Startup Time": 0.021, "Actual Total Time": 8.616, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.015, "Actual Total Time": 0.016, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.009, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'complete+verified'::text)", "Rows Removed by Filter": 3}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.014, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 7, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.009, "Actual Total Time": 0.009, "Actual Rows": 1, "Actual Loops": 7, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 7}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.14, "Total Cost": 0.21, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 1, "Actual Loops": 7, "Index Cond": "(id = mi.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.52, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.013, "Actual Total Time": 0.013, "Actual Rows": 1, "Actual Loops": 7, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2000)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 6, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'movie'::text)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 618, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 618}]}]}]}]}, "Planning Time": 138.771, "Triggers": [], "Execution Time": 857.991}]
[{"Bao": {"Bao prediction": 4329.903, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 705347.46, "Total Cost": 705347.47, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2210.131, "Actual Total Time": 2267.132, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 257738.22, "Total Cost": 705347.46, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1470.608, "Actual Total Time": 2267.084, "Actual Rows": 410, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 257737.79, "Total Cost": 705347.0, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1470.598, "Actual Total Time": 2265.504, "Actual Rows": 410, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 256737.79, "Total Cost": 704346.9, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1467.645, "Actual Total Time": 2206.334, "Actual Rows": 137, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 256737.36, "Total Cost": 701846.7, "Plan Rows": 3890, "Plan Width": 16, "Actual Startup Time": 1334.526, "Actual Total Time": 2125.825, "Actual Rows": 35780, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 441377.81, "Plan Rows": 990752, "Plan Width": 8, "Actual Startup Time": 132.644, "Actual Total Time": 1151.681, "Actual Rows": 793090, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(producer),\"(executive producer)\"}'::text[]))", "Rows Removed by Filter": 11288358}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 256719.05, "Total Cost": 256719.05, "Plan Rows": 1465, "Plan Width": 8, "Actual Startup Time": 888.699, "Actual Total Time": 888.863, "Actual Rows": 15144, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 4096, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2816, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 15319.64, "Total Cost": 256719.05, "Plan Rows": 1465, "Plan Width": 8, "Actual Startup Time": 861.85, "Actual Total Time": 881.125, "Actual Rows": 15144, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 241189.17, "Plan Rows": 55082, "Plan Width": 4, "Actual Startup Time": 426.655, "Actual Total Time": 734.53, "Actual Rows": 40621, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 224235.35, "Plan Rows": 6224235, "Plan Width": 8, "Actual Startup Time": 0.012, "Actual Total Time": 387.53, "Actual Rows": 4945240, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.015, "Actual Total Time": 0.016, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'budget'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 15253.6, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 118.111, "Actual Total Time": 118.117, "Actual Rows": 153308, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 16384, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 3360, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 0.052, "Actual Total Time": 80.129, "Actual Rows": 153308, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.015, "Actual Total Time": 33.637, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.027, "Actual Total Time": 0.028, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.022, "Actual Total Time": 0.023, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'votes'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.64, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 107339, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name)::text ~~ '%Tim%'::text) AND ((gender)::text = 'm'::text))", "Rows Removed by Filter": 1}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 410, "Index Cond": "(id = mi.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 410}]}]}, "Planning Time": 82.369, "Triggers": [], "Execution Time": 2267.201}]
[{"Bao": {"Bao prediction": 1222.87, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 322829.04, "Total Cost": 322829.05, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 120.311, "Actual Total Time": 123.86, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 36119.36, "Total Cost": 322829.03, "Plan Rows": 2, "Plan Width": 0, "Actual Startup Time": 120.308, "Actual Total Time": 123.856, "Actual Rows": 0, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 35119.36, "Total Cost": 321828.83, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 118.073, "Actual Total Time": 118.083, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 35119.22, "Total Cost": 321828.67, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 118.073, "Actual Total Time": 118.082, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 35118.79, "Total Cost": 321825.31, "Plan Rows": 2, "Plan Width": 12, "Actual Startup Time": 118.073, "Actual Total Time": 118.081, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 286477.69, "Plan Rows": 61019, "Plan Width": 8, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 0, "Actual Loops": 0, "Filter": "((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))", "Rows Removed by Filter": 0}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 35118.71, "Total Cost": 35118.71, "Plan Rows": 6, "Plan Width": 4, "Actual Startup Time": 117.853, "Actual Total Time": 117.86, "Actual Rows": 0, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 35118.71, "Plan Rows": 6, "Plan Width": 4, "Actual Startup Time": 117.837, "Actual Total Time": 117.844, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 35097.06, "Plan Rows": 1037, "Plan Width": 8, "Actual Startup Time": 3.619, "Actual Total Time": 117.341, "Actual Rows": 8008, "Actual Loops": 3, "Filter": "(((note)::text ~~ '%(theatrical)%'::text) AND ((note)::text ~~ '%(France)%'::text))", "Rows Removed by Filter": 861701}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.015, "Actual Total Time": 0.016, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.011, "Actual Total Time": 0.011, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 1.68, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 0, "Actual Loops": 0, "Index Cond": "(id = mi.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2005)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 0, "Actual Loops": 0, "Index Cond": "(id = mi.info_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 0}]}]}]}, "Planning Time": 79.674, "Triggers": [], "Execution Time": 123.933}]
[{"Bao": {"Bao prediction": 855.983, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 84689.2, "Total Cost": 84689.21, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 360.175, "Actual Total Time": 369.773, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 84688.99, "Total Cost": 84689.2, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 359.949, "Actual Total Time": 369.767, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 83688.99, "Total Cost": 83689.0, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 357.649, "Actual Total Time": 357.661, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 51923.11, "Total Cost": 83688.91, "Plan Rows": 30, "Plan Width": 0, "Actual Startup Time": 238.65, "Actual Total Time": 357.414, "Actual Rows": 4966, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 51922.96, "Total Cost": 83683.81, "Plan Rows": 30, "Plan Width": 4, "Actual Startup Time": 238.636, "Actual Total Time": 353.045, "Actual Rows": 5164, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 51922.54, "Total Cost": 83668.91, "Plan Rows": 33, "Plan Width": 8, "Actual Startup Time": 238.609, "Actual Total Time": 345.598, "Actual Rows": 5170, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 555962, "Plan Width": 12, "Actual Startup Time": 0.025, "Actual Total Time": 75.977, "Actual Rows": 445713, "Actual Loops": 3, "Filter": "(note IS NOT NULL)", "Rows Removed by Filter": 423996}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 51922.39, "Total Cost": 51922.39, "Plan Rows": 12, "Plan Width": 12, "Actual Startup Time": 238.007, "Actual Total Time": 238.011, "Actual Rows": 487, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 136, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3632.39, "Total Cost": 51922.39, "Plan Rows": 12, "Plan Width": 12, "Actual Startup Time": 23.559, "Actual Total Time": 237.87, "Actual Rows": 487, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3632.24, "Total Cost": 51920.36, "Plan Rows": 12, "Plan Width": 16, "Actual Startup Time": 23.538, "Actual Total Time": 237.411, "Actual Rows": 487, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ml.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3631.81, "Total Cost": 51913.83, "Plan Rows": 13, "Plan Width": 12, "Actual Startup Time": 23.516, "Actual Total Time": 236.449, "Actual Rows": 487, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2793.88, "Total Cost": 51045.79, "Plan Rows": 42, "Plan Width": 4, "Actual Startup Time": 16.412, "Actual Total Time": 226.335, "Actual Rows": 15801, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.008, "Actual Total Time": 103.456, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2793.84, "Total Cost": 2793.84, "Plan Rows": 3, "Plan Width": 4, "Actual Startup Time": 16.337, "Actual Total Time": 16.338, "Actual Rows": 3, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2793.84, "Plan Rows": 3, "Plan Width": 4, "Actual Startup Time": 0.737, "Actual Total Time": 16.335, "Actual Rows": 3, "Actual Loops": 3, "Filter": "((keyword)::text = ANY ('{sequel,revenge,based-on-novel}'::text[]))", "Rows Removed by Filter": 134167}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 462.97, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 8, "Actual Startup Time": 7.01, "Actual Total Time": 7.01, "Actual Rows": 29997, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 32768, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1428, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 8, "Actual Startup Time": 0.017, "Actual Total Time": 3.443, "Actual Rows": 29997, "Actual Loops": 3}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 1460, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 1950)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "link_type_pkey", "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 1460, "Index Cond": "(id = ml.link_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 1460}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 15510, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text <> '[pl]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 15493, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind IS NOT NULL) AND ((kind)::text <> 'production companies'::text))", "Rows Removed by Filter": 0}]}]}]}]}, "Planning Time": 84.62, "Triggers": [], "Execution Time": 369.879}]
[{"Bao": {"Bao prediction": 2871.298, "Bao recommended hint": "SET enable_mergejoin TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 874071.99, "Total Cost": 874072.0, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2352.596, "Actual Total Time": 2417.263, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 633800.57, "Total Cost": 874071.98, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2058.624, "Actual Total Time": 2417.256, "Actual Rows": 15, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 633800.42, "Total Cost": 874071.8, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2058.61, "Actual Total Time": 2417.228, "Actual Rows": 15, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 632800.42, "Total Cost": 873071.7, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2251.653, "Actual Total Time": 2349.603, "Actual Rows": 5, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 239795.93, "Plan Rows": 126756, "Plan Width": 8, "Actual Startup Time": 56.138, "Actual Total Time": 536.801, "Actual Rows": 129228, "Actual Loops": 3, "Filter": "((info)::text ~~ 'USA:%200%'::text)", "Rows Removed by Filter": 4816012}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 632800.41, "Total Cost": 632800.41, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1805.158, "Actual Total Time": 1805.174, "Actual Rows": 5, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 564755.79, "Total Cost": 632800.41, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1753.758, "Actual Total Time": 1805.147, "Actual Rows": 5, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 564755.65, "Total Cost": 632800.23, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 1650.022, "Actual Total Time": 1804.251, "Actual Rows": 815, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(pi.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "person_info", "Alias": "pi", "Startup Cost": 0.0, "Total Cost": 63409.96, "Plan Rows": 1235896, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 89.685, "Actual Rows": 987888, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 564755.64, "Total Cost": 564755.64, "Plan Rows": 1, "Plan Width": 32, "Actual Startup Time": 1646.133, "Actual Total Time": 1646.148, "Actual Rows": 5, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 548195.68, "Total Cost": 564755.64, "Plan Rows": 1, "Plan Width": 32, "Actual Startup Time": 1631.199, "Actual Total Time": 1646.12, "Actual Rows": 5, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 24.684, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 548195.67, "Total Cost": 548195.67, "Plan Rows": 1, "Plan Width": 28, "Actual Startup Time": 1600.448, "Actual Total Time": 1600.461, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 514454.0, "Total Cost": 548195.67, "Plan Rows": 1, "Plan Width": 28, "Actual Startup Time": 1572.289, "Actual Total Time": 1600.393, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 514453.57, "Total Cost": 548193.33, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 1572.28, "Actual Total Time": 1600.382, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 514453.15, "Total Cost": 548191.3, "Plan Rows": 1, "Plan Width": 28, "Actual Startup Time": 1572.263, "Actual Total Time": 1600.339, "Actual Rows": 7, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.014, "Actual Total Time": 62.675, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 514453.14, "Total Cost": 514453.14, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1477.874, "Actual Total Time": 1477.884, "Actual Rows": 0, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 464077.0, "Total Cost": 514453.14, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1460.954, "Actual Total Time": 1477.806, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 464076.85, "Total Cost": 514452.4, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 1460.949, "Actual Total Time": 1477.8, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 464076.43, "Total Cost": 514448.79, "Plan Rows": 1, "Plan Width": 28, "Actual Startup Time": 1460.903, "Actual Total Time": 1477.671, "Actual Rows": 36, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 102.494, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 464076.42, "Total Cost": 464076.42, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1273.972, "Actual Total Time": 1273.978, "Actual Rows": 0, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2479.34, "Total Cost": 464076.42, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 996.481, "Actual Total Time": 1273.953, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2478.91, "Total Cost": 464072.35, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 50.373, "Actual Total Time": 1273.71, "Actual Rows": 13, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2478.48, "Total Cost": 464066.99, "Plan Rows": 2, "Plan Width": 20, "Actual Startup Time": 28.151, "Actual Total Time": 1262.505, "Actual Rows": 2376, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 460246.89, "Plan Rows": 357758, "Plan Width": 16, "Actual Startup Time": 0.039, "Actual Total Time": 1198.404, "Actual Rows": 278900, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(voice),\"(voice) (uncredited)\",\"(voice: English version)\"}'::text[]))", "Rows Removed by Filter": 11802548}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2478.43, "Total Cost": 2478.43, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 27.625, "Actual Total Time": 27.628, "Actual Rows": 17879, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 885, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 37.85, "Total Cost": 2478.43, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.049, "Actual Total Time": 25.48, "Actual Rows": 17879, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.subject_id = cct1.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 0.021, "Actual Total Time": 22.584, "Actual Rows": 24592, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.status_id = cct2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.009, "Actual Total Time": 9.859, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'complete+verified'::text)", "Rows Removed by Filter": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.02, "Actual Total Time": 0.02, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.014, "Actual Total Time": 0.015, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'cast'::text)", "Rows Removed by Filter": 3}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 2.23, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 0, "Actual Loops": 7127, "Index Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 2000) AND (production_year <= 2005) AND ((title)::text = 'Shrek 2'::text))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 2.25, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.018, "Actual Rows": 0, "Actual Loops": 38, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name)::text = 'Queen'::text)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 2.02, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 108, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = 'computer-animation'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "role_type_pkey", "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.15, "Total Cost": 0.57, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.014, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 1, "Index Cond": "(id = ci.role_id)", "Rows Removed by Index Recheck": 0, "Filter": "((role)::text = 'actress'::text)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 2.03, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.005, "Actual Total Time": 0.005, "Actual Rows": 0, "Actual Loops": 22, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 2.34, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.005, "Actual Total Time": 0.005, "Actual Rows": 1, "Actual Loops": 5, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))", "Rows Removed by Filter": 0}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it3", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 2445, "Index Cond": "(id = pi.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'height'::text)", "Rows Removed by Filter": 1}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 15, "Index Cond": "(id = mi.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 0}]}]}, "Planning Time": 295.791, "Triggers": [], "Execution Time": 2417.405}]
[{"Bao": {"Bao prediction": 2079.417, "Bao recommended hint": "SET enable_mergejoin TO off; SET enable_indexscan TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 481585.27, "Total Cost": 481585.28, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1405.011, "Actual Total Time": 1435.802, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 481585.06, "Total Cost": 481585.27, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 1404.867, "Actual Total Time": 1435.796, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 480585.06, "Total Cost": 480585.07, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1402.63, "Actual Total Time": 1402.635, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 447759.6, "Total Cost": 480585.05, "Plan Rows": 4, "Plan Width": 0, "Actual Startup Time": 1402.627, "Actual Total Time": 1402.632, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 447759.44, "Total Cost": 480568.35, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 1402.627, "Actual Total Time": 1402.631, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 447758.97, "Total Cost": 480532.5, "Plan Rows": 8, "Plan Width": 8, "Actual Startup Time": 1402.626, "Actual Total Time": 1402.631, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 447758.52, "Total Cost": 480295.78, "Plan Rows": 53, "Plan Width": 16, "Actual Startup Time": 1402.626, "Actual Total Time": 1402.629, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 4732.19, "Total Cost": 37247.36, "Plan Rows": 5834, "Plan Width": 8, "Actual Startup Time": 8.487, "Actual Total Time": 143.348, "Actual Rows": 2930, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_id = cn.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 12, "Actual Startup Time": 0.007, "Actual Total Time": 62.689, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 4722.92, "Total Cost": 4722.92, "Plan Rows": 742, "Plan Width": 4, "Actual Startup Time": 8.129, "Actual Total Time": 8.129, "Actual Rows": 454, "Actual Loops": 3, "Hash Buckets": 2048, "Original Hash Buckets": 2048, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 112, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.0, "Total Cost": 4722.92, "Plan Rows": 742, "Plan Width": 4, "Actual Startup Time": 0.02, "Actual Total Time": 8.018, "Actual Rows": 454, "Actual Loops": 3, "Filter": "((country_code)::text = '[ru]'::text)", "Rows Removed by Filter": 77879}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 442984.0, "Total Cost": 442984.0, "Plan Rows": 3386, "Plan Width": 8, "Actual Startup Time": 1258.636, "Actual Total Time": 1258.637, "Actual Rows": 4, "Actual Loops": 3, "Hash Buckets": 8192, "Original Hash Buckets": 8192, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 160, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 442984.0, "Plan Rows": 3386, "Plan Width": 8, "Actual Startup Time": 140.135, "Actual Total Time": 1258.588, "Actual Rows": 4, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 441377.81, "Plan Rows": 601081, "Plan Width": 12, "Actual Startup Time": 140.091, "Actual Total Time": 1226.772, "Actual Rows": 478480, "Actual Loops": 3, "Filter": "((note)::text ~~ '%(producer)%'::text)", "Rows Removed by Filter": 11602968}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.029, "Actual Total Time": 0.03, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.023, "Actual Total Time": 0.024, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((role)::text = 'actor'::text)", "Rows Removed by Filter": 11}]}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "title", "Alias": "t", "Startup Cost": 0.45, "Total Cost": 4.47, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 0, "Actual Loops": 0, "Recheck Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2010)", "Rows Removed by Filter": 0, "Exact Heap Blocks": 0, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "title_pkey", "Startup Cost": 0.0, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 0, "Actual Loops": 0, "Index Cond": "(id = mc.movie_id)"}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.47, "Total Cost": 4.48, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 0, "Actual Loops": 0, "Recheck Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Exact Heap Blocks": 0, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "char_name_pkey", "Startup Cost": 0.0, "Total Cost": 0.47, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 0, "Actual Loops": 0, "Index Cond": "(id = ci.person_role_id)"}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.16, "Total Cost": 4.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 0, "Actual Loops": 0, "Recheck Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Exact Heap Blocks": 0, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "company_type_pkey", "Startup Cost": 0.0, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 0, "Actual Loops": 0, "Index Cond": "(id = mc.company_type_id)"}]}]}]}]}]}, "Planning Time": 84.874, "Triggers": [], "Execution Time": 1435.899}]
[{"Bao": {"Bao prediction": 2795.379, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 514326.12, "Total Cost": 514326.13, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2950.512, "Actual Total Time": 2994.021, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 514325.9, "Total Cost": 514326.11, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2950.335, "Actual Total Time": 2994.015, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 513325.9, "Total Cost": 513325.91, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2948.138, "Actual Total Time": 2948.143, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 51940.46, "Total Cost": 513319.7, "Plan Rows": 2480, "Plan Width": 0, "Actual Startup Time": 313.978, "Actual Total Time": 2934.903, "Actual Rows": 261826, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 51940.03, "Total Cost": 512190.57, "Plan Rows": 2480, "Plan Width": 4, "Actual Startup Time": 313.917, "Actual Total Time": 2436.262, "Actual Rows": 261826, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.026, "Actual Total Time": 867.117, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 51939.27, "Total Cost": 51939.27, "Plan Rows": 61, "Plan Width": 8, "Actual Startup Time": 313.573, "Actual Total Time": 313.576, "Actual Rows": 4722, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 856, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3632.93, "Total Cost": 51939.27, "Plan Rows": 61, "Plan Width": 8, "Actual Startup Time": 29.337, "Actual Total Time": 268.179, "Actual Rows": 4722, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3632.5, "Total Cost": 51884.41, "Plan Rows": 112, "Plan Width": 4, "Actual Startup Time": 29.212, "Actual Total Time": 236.212, "Actual Rows": 11849, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 101.249, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 3632.4, "Total Cost": 3632.4, "Plan Rows": 8, "Plan Width": 4, "Actual Startup Time": 29.139, "Actual Total Time": 29.14, "Actual Rows": 8, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 3632.4, "Plan Rows": 8, "Plan Width": 4, "Actual Startup Time": 0.124, "Actual Total Time": 29.13, "Actual Rows": 8, "Actual Loops": 3, "Filter": "((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))", "Rows Removed by Filter": 134162}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 35548, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2000)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 785477, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 785477}]}]}]}]}, "Planning Time": 78.584, "Triggers": [], "Execution Time": 2994.082}]
[{"Bao": {"Bao prediction": 1617.001, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 350125.42, "Total Cost": 350125.43, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 816.814, "Actual Total Time": 849.431, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 350125.21, "Total Cost": 350125.42, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 816.665, "Actual Total Time": 849.425, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 349125.21, "Total Cost": 349125.22, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 814.147, "Actual Total Time": 814.156, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 340862.25, "Total Cost": 349125.19, "Plan Rows": 7, "Plan Width": 0, "Actual Startup Time": 796.202, "Actual Total Time": 814.146, "Actual Rows": 109, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(at.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_title", "Alias": "at", "Startup Cost": 0.0, "Total Cost": 7698.13, "Plan Rows": 150613, "Plan Width": 4, "Actual Startup Time": 0.007, "Actual Total Time": 10.882, "Actual Rows": 120491, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 340862.21, "Total Cost": 340862.21, "Plan Rows": 3, "Plan Width": 16, "Actual Startup Time": 793.068, "Actual Total Time": 793.075, "Actual Rows": 466, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 290486.83, "Total Cost": 340862.21, "Plan Rows": 3, "Plan Width": 16, "Actual Startup Time": 575.316, "Actual Total Time": 792.936, "Actual Rows": 466, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 290486.41, "Total Cost": 340860.9, "Plan Rows": 3, "Plan Width": 20, "Actual Startup Time": 575.291, "Actual Total Time": 791.65, "Actual Rows": 466, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 290485.98, "Total Cost": 340858.38, "Plan Rows": 5, "Plan Width": 16, "Actual Startup Time": 575.252, "Actual Total Time": 790.532, "Actual Rows": 491, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.014, "Actual Total Time": 105.008, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 290485.97, "Total Cost": 290485.97, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 574.969, "Actual Total Time": 574.974, "Actual Rows": 223, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 255359.78, "Total Cost": 290485.97, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 457.03, "Actual Total Time": 574.86, "Actual Rows": 223, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 255359.63, "Total Cost": 290485.8, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 457.013, "Actual Total Time": 574.61, "Actual Rows": 223, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 255359.21, "Total Cost": 290484.5, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 456.975, "Actual Total Time": 573.737, "Actual Rows": 233, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 35097.06, "Plan Rows": 7526, "Plan Width": 12, "Actual Startup Time": 0.011, "Actual Total Time": 114.881, "Actual Rows": 20555, "Actual Loops": 3, "Filter": "(((note)::text ~~ '%(200%)%'::text) AND ((note)::text ~~ '%(worldwide)%'::text))", "Rows Removed by Filter": 849155}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 255359.2, "Total Cost": 255359.2, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 456.669, "Actual Total Time": 456.671, "Actual Rows": 590, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 255359.2, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 123.947, "Actual Total Time": 456.52, "Actual Rows": 590, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 255356.52, "Plan Rows": 94, "Plan Width": 8, "Actual Startup Time": 123.897, "Actual Total Time": 456.355, "Actual Rows": 590, "Actual Loops": 3, "Filter": "(((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))", "Rows Removed by Filter": 4944650}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.034, "Actual Total Time": 0.035, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.022, "Actual Total Time": 0.027, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 112}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 1.3, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 699, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 668, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 668}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 1473, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2000)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 1398, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 1398}]}]}]}]}]}]}, "Planning Time": 99.395, "Triggers": [], "Execution Time": 849.52}]
[{"Bao": {"Bao prediction": 1022.642, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 54121.12, "Total Cost": 54121.13, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 280.723, "Actual Total Time": 284.806, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 54120.91, "Total Cost": 54121.12, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 279.321, "Actual Total Time": 284.798, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 53120.91, "Total Cost": 53120.92, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 277.785, "Actual Total Time": 277.795, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 37850.48, "Total Cost": 53120.9, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 277.196, "Actual Total Time": 277.789, "Actual Rows": 47, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mc.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 37850.05, "Total Cost": 53120.31, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 277.156, "Actual Total Time": 277.236, "Actual Rows": 47, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx.movie_id = mc.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 63.587, "Actual Total Time": 63.607, "Actual Rows": 83, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.034, "Actual Total Time": 31.746, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.037, "Actual Total Time": 0.038, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.034, "Actual Total Time": 0.034, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'top 250 rank'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 37847.26, "Total Cost": 37847.26, "Plan Rows": 29, "Plan Width": 4, "Actual Startup Time": 213.276, "Actual Total Time": 213.284, "Actual Rows": 9552, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1656, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 37847.26, "Plan Rows": 29, "Plan Width": 4, "Actual Startup Time": 155.809, "Actual Total Time": 199.051, "Actual Rows": 9552, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 37814.9, "Plan Rows": 5088, "Plan Width": 8, "Actual Startup Time": 24.428, "Actual Total Time": 197.719, "Actual Rows": 9630, "Actual Loops": 3, "Filter": "(((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text) AND (((note)::text ~~ '%(co-production)%'::text) OR ((note)::text ~~ '%(presents)%'::text)))", "Rows Removed by Filter": 860080}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.016, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.012, "Actual Total Time": 0.012, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.58, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.011, "Actual Total Time": 0.011, "Actual Rows": 1, "Actual Loops": 142, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 142}]}]}]}]}, "Planning Time": 78.693, "Triggers": [], "Execution Time": 284.88}]
[{"Bao": {"Bao prediction": 1134.779, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 67611.42, "Total Cost": 67611.43, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 388.424, "Actual Total Time": 395.724, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 51883.33, "Total Cost": 67611.41, "Plan Rows": 2, "Plan Width": 0, "Actual Startup Time": 294.286, "Actual Total Time": 395.662, "Actual Rows": 740, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50883.33, "Total Cost": 66611.21, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 292.134, "Actual Total Time": 386.098, "Actual Rows": 247, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi_idx.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50882.9, "Total Cost": 66610.21, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 282.542, "Actual Total Time": 380.867, "Actual Rows": 1940, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx.movie_id = mk.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15722.44, "Plan Rows": 1941, "Plan Width": 4, "Actual Startup Time": 0.09, "Actual Total Time": 88.907, "Actual Rows": 117663, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 219331, "Plan Width": 8, "Actual Startup Time": 0.033, "Actual Total Time": 70.652, "Actual Rows": 174440, "Actual Loops": 3, "Filter": "((info)::text > '5.0'::text)", "Rows Removed by Filter": 285572}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.034, "Actual Total Time": 0.035, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.028, "Actual Total Time": 0.029, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50878.2, "Total Cost": 50878.2, "Plan Rows": 182, "Plan Width": 4, "Actual Startup Time": 281.056, "Actual Total Time": 281.057, "Actual Rows": 4317, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 760, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.29, "Total Cost": 50878.2, "Plan Rows": 182, "Plan Width": 4, "Actual Startup Time": 20.331, "Actual Total Time": 226.771, "Actual Rows": 4317, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 103.336, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 13, "Plan Width": 4, "Actual Startup Time": 20.015, "Actual Total Time": 20.015, "Actual Rows": 30, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 10, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 13, "Plan Width": 4, "Actual Startup Time": 1.22, "Actual Total Time": 19.997, "Actual Rows": 30, "Actual Loops": 3, "Filter": "((keyword)::text ~~ '%sequel%'::text)", "Rows Removed by Filter": 134140}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 5820, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2005)", "Rows Removed by Filter": 1}]}]}]}, "Planning Time": 77.919, "Triggers": [], "Execution Time": 395.795}]
[{"Bao": {"Bao prediction": 2919.878, "Bao recommended hint": "SET enable_mergejoin TO off; SET enable_indexscan TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 548409.21, "Total Cost": 548409.22, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3562.889, "Actual Total Time": 3605.854, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 514662.94, "Total Cost": 548409.21, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 3391.953, "Actual Total Time": 3605.139, "Actual Rows": 11538, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 514662.5, "Total Cost": 548404.75, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 3391.944, "Actual Total Time": 3574.192, "Actual Rows": 11538, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 514662.07, "Total Cost": 548400.31, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 3391.93, "Actual Total Time": 3542.434, "Actual Rows": 11538, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 513662.07, "Total Cost": 547400.21, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 3389.632, "Actual Total Time": 3538.066, "Actual Rows": 3846, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.014, "Actual Total Time": 61.895, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 513662.06, "Total Cost": 513662.06, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3388.257, "Actual Total Time": 3388.261, "Actual Rows": 657, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50878.66, "Total Cost": 513662.06, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 260.384, "Actual Total Time": 3387.884, "Actual Rows": 657, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50878.23, "Total Cost": 511127.48, "Plan Rows": 569, "Plan Width": 12, "Actual Startup Time": 239.882, "Actual Total Time": 2391.662, "Actual Rows": 346131, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = mk.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.02, "Actual Total Time": 854.163, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50878.05, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 239.761, "Actual Total Time": 239.763, "Actual Rows": 13947, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2680, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 12.211, "Actual Total Time": 220.195, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 104.201, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 12.151, "Actual Total Time": 12.151, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.578, "Actual Total Time": 12.146, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'character-name-in-title'::text)", "Rows Removed by Filter": 134169}]}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "name", "Alias": "n", "Startup Cost": 0.44, "Total Cost": 4.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 1038393, "Recheck Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name)::text ~~ '%Bert%'::text)", "Rows Removed by Filter": 1, "Exact Heap Blocks": 353506, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "name_pkey", "Startup Cost": 0.0, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 1038393, "Index Cond": "(id = ci.person_id)"}]}]}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.43, "Total Cost": 4.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 11538, "Recheck Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Exact Heap Blocks": 11538, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "company_name_pkey", "Startup Cost": 0.0, "Total Cost": 0.43, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 11538, "Index Cond": "(id = mc.company_id)"}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "title", "Alias": "t", "Startup Cost": 0.44, "Total Cost": 4.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 11538, "Recheck Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Exact Heap Blocks": 11538, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "title_pkey", "Startup Cost": 0.0, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 11538, "Index Cond": "(id = ci.movie_id)"}]}]}]}, "Planning Time": 82.784, "Triggers": [], "Execution Time": 3605.973}]
[{"Bao": {"Bao prediction": 1182.939, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 66607.96, "Total Cost": 66607.97, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 280.969, "Actual Total Time": 288.829, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 16133.42, "Total Cost": 66607.96, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 162.49, "Actual Total Time": 288.823, "Actual Rows": 6, "Actual Loops": 1, "Inner Unique": true, "Join Filter": "(mi_idx.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 16132.99, "Total Cost": 66607.46, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 162.475, "Actual Total Time": 288.745, "Actual Rows": 21, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 15132.99, "Total Cost": 65607.36, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 132.504, "Actual Total Time": 278.776, "Actual Rows": 7, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 15132.57, "Total Cost": 65505.86, "Plan Rows": 230, "Plan Width": 12, "Actual Startup Time": 67.156, "Actual Total Time": 274.373, "Actual Rows": 2011, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.025, "Actual Total Time": 104.204, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 15132.28, "Total Cost": 15132.28, "Plan Rows": 23, "Plan Width": 4, "Actual Startup Time": 64.182, "Actual Total Time": 64.184, "Actual Rows": 102, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15132.28, "Plan Rows": 23, "Plan Width": 4, "Actual Startup Time": 1.643, "Actual Total Time": 64.096, "Actual Rows": 102, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 2635, "Plan Width": 8, "Actual Startup Time": 0.074, "Actual Total Time": 63.857, "Actual Rows": 2794, "Actual Loops": 3, "Filter": "((info)::text > '9.0'::text)", "Rows Removed by Filter": 457218}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.027, "Actual Total Time": 0.027, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.022, "Actual Total Time": 0.023, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 6032, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text ~~ '%sequel%'::text)", "Rows Removed by Filter": 1}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 21, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2010)", "Rows Removed by Filter": 1}]}]}, "Planning Time": 77.76, "Triggers": [], "Execution Time": 288.888}]
[{"Bao": {"Bao prediction": 2939.654, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 545497.76, "Total Cost": 545497.77, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2689.691, "Actual Total Time": 2726.51, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 545497.55, "Total Cost": 545497.76, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2689.532, "Actual Total Time": 2726.504, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 544497.55, "Total Cost": 544497.56, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2687.034, "Actual Total Time": 2687.043, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 83706.29, "Total Cost": 544497.54, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1719.264, "Actual Total Time": 2687.036, "Actual Rows": 11, "Actual Loops": 3, "Inner Unique": false, "Join Filter": "(ml.linked_movie_id = t.id)", "Rows Removed by Join Filter": 954213, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 83687.37, "Total Cost": 543934.33, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 178.528, "Actual Total Time": 1856.07, "Actual Rows": 184, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 83686.94, "Total Cost": 543933.87, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 178.439, "Actual Total Time": 1850.775, "Actual Rows": 1118, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.025, "Actual Total Time": 872.498, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 83686.92, "Total Cost": 83686.92, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 160.436, "Actual Total Time": 160.441, "Actual Rows": 7, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 66502.6, "Total Cost": 83686.92, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 118.308, "Actual Total Time": 160.343, "Actual Rows": 7, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 66502.17, "Total Cost": 83686.06, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 107.11, "Actual Total Time": 159.916, "Actual Rows": 33, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = pi.person_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 16090.49, "Plan Rows": 291570, "Plan Width": 4, "Actual Startup Time": 0.012, "Actual Total Time": 45.683, "Actual Rows": 224897, "Actual Loops": 3, "Filter": "((name)::text ~~ '%a%'::text)", "Rows Removed by Filter": 75550}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 66502.15, "Total Cost": 66502.15, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 101.338, "Actual Total Time": 101.34, "Actual Rows": 21, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 66502.15, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2.155, "Actual Total Time": 101.297, "Actual Rows": 21, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(pi.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "person_info", "Alias": "pi", "Startup Cost": 0.0, "Total Cost": 66499.7, "Plan Rows": 12, "Plan Width": 8, "Actual Startup Time": 2.113, "Actual Total Time": 101.231, "Actual Rows": 21, "Actual Loops": 3, "Filter": "((note)::text = 'Volker Boehm'::text)", "Rows Removed by Filter": 987867}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.03, "Actual Total Time": 0.03, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.024, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'mini biography'::text)", "Rows Removed by Filter": 112}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.86, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.012, "Actual Total Time": 0.012, "Actual Rows": 0, "Actual Loops": 98, "Index Cond": "(id = an.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name_pcode_cf)::text >= 'A'::text) AND ((name_pcode_cf)::text <= 'F'::text) AND (((gender)::text = 'm'::text) OR (((gender)::text = 'f'::text) AND ((name)::text ~~ 'B%'::text))))", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 0, "Actual Loops": 3354, "Index Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 1980) AND (production_year <= 1995))", "Rows Removed by Filter": 1}]}, {"Node Type": "Hash Join", "Parent Relationship": "Inner", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 561.1, "Plan Rows": 169, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 4.304, "Actual Rows": 5186, "Actual Loops": 552, "Inner Unique": true, "Hash Cond": "(ml.link_type_id = lt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 8, "Actual Startup Time": 0.003, "Actual Total Time": 1.758, "Actual Rows": 29997, "Actual Loops": 552}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.009, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.005, "Actual Total Time": 0.006, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((link)::text = 'features'::text)", "Rows Removed by Filter": 17}]}]}]}]}]}]}, "Planning Time": 92.594, "Triggers": [], "Execution Time": 2726.621}]
[{"Bao": {"Bao prediction": 2200.666, "Bao recommended hint": "SET enable_mergejoin TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 809518.67, "Total Cost": 809518.68, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2537.897, "Actual Total Time": 2596.502, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 759145.85, "Total Cost": 809518.67, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2418.344, "Actual Total Time": 2596.494, "Actual Rows": 28, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 759145.7, "Total Cost": 809518.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2418.339, "Actual Total Time": 2596.457, "Actual Rows": 28, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 758145.7, "Total Cost": 808518.39, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2437.102, "Actual Total Time": 2535.012, "Actual Rows": 9, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 758145.28, "Total Cost": 808517.64, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2436.92, "Actual Total Time": 2534.309, "Actual Rows": 353, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.016, "Actual Total Time": 103.395, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 758145.26, "Total Cost": 758145.26, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2329.824, "Actual Total Time": 2329.839, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 742303.24, "Total Cost": 758145.26, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2314.002, "Actual Total Time": 2329.736, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 742302.81, "Total Cost": 758144.32, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2262.947, "Actual Total Time": 2326.365, "Actual Rows": 697, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 742302.67, "Total Cost": 758144.13, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2262.929, "Actual Total Time": 2324.378, "Actual Rows": 2104, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.022, "Actual Total Time": 32.566, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 742302.66, "Total Cost": 742302.66, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2255.728, "Actual Total Time": 2255.733, "Actual Rows": 697, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 216, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 242380.96, "Total Cost": 742302.66, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1514.397, "Actual Total Time": 2064.145, "Actual Rows": 697, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 242380.53, "Total Cost": 742301.57, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1513.55, "Actual Total Time": 2059.125, "Actual Rows": 1137, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 497985.06, "Plan Rows": 516258, "Plan Width": 8, "Actual Startup Time": 112.859, "Actual Total Time": 1365.698, "Actual Rows": 414905, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(writer),\"(head writer)\",\"(written by)\",(story),\"(story editor)\"}'::text[]))", "Rows Removed by Filter": 11666543}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 242380.52, "Total Cost": 242380.52, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 655.163, "Actual Total Time": 655.166, "Actual Rows": 1648, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 312, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2469.44, "Total Cost": 242380.52, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 553.017, "Actual Total Time": 622.087, "Actual Rows": 1648, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2467.01, "Total Cost": 242377.93, "Plan Rows": 61, "Plan Width": 16, "Actual Startup Time": 401.131, "Actual Total Time": 621.782, "Actual Rows": 1935, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 239795.93, "Plan Rows": 30499, "Plan Width": 8, "Actual Startup Time": 377.209, "Actual Total Time": 594.06, "Actual Rows": 24349, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Horror,Thriller}'::text[]))", "Rows Removed by Filter": 4920891}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2457.5, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 23.436, "Actual Total Time": 23.438, "Actual Rows": 24592, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1217, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 0.039, "Actual Total Time": 20.565, "Actual Rows": 24592, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.status_id = cct2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.019, "Actual Total Time": 8.59, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.01, "Actual Total Time": 0.01, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.007, "Actual Total Time": 0.007, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'complete+verified'::text)", "Rows Removed by Filter": 3}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.033, "Actual Total Time": 0.033, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.021, "Actual Total Time": 0.029, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'genres'::text)", "Rows Removed by Filter": 112}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 1.09, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 1, "Actual Loops": 3412, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((gender)::text = 'm'::text)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 6313, "Index Cond": "(id = mi_idx.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'votes'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.94, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.005, "Actual Total Time": 0.005, "Actual Rows": 0, "Actual Loops": 2091, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year > 2000) AND (((title)::text ~~ '%Freddy%'::text) OR ((title)::text ~~ '%Jason%'::text) OR ((title)::text ~~ 'Saw%'::text)))", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.69, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 1060, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))", "Rows Removed by Filter": 1}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "comp_cast_type_pkey", "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 28, "Index Cond": "(id = cc.subject_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = ANY ('{cast,crew}'::text[]))", "Rows Removed by Filter": 0}]}]}, "Planning Time": 205.056, "Triggers": [], "Execution Time": 2596.636}]
[{"Bao": {"Bao prediction": 3450.959, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 641325.25, "Total Cost": 641325.26, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2145.616, "Actual Total Time": 2189.569, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 641325.03, "Total Cost": 641325.24, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2144.907, "Actual Total Time": 2189.563, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 640325.03, "Total Cost": 640325.04, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2142.741, "Actual Total Time": 2142.761, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 601089.49, "Total Cost": 639793.79, "Plan Rows": 212498, "Plan Width": 0, "Actual Startup Time": 2124.86, "Actual Total Time": 2142.753, "Actual Rows": 3, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 601063.51, "Total Cost": 639206.68, "Plan Rows": 212498, "Plan Width": 4, "Actual Startup Time": 2124.733, "Actual Total Time": 2142.62, "Actual Rows": 3, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = t.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 5344.51, "Total Cost": 37859.67, "Plan Rows": 391078, "Plan Width": 8, "Actual Startup Time": 13.462, "Actual Total Time": 209.607, "Actual Rows": 384599, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_id = cn.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 12, "Actual Startup Time": 0.015, "Actual Total Time": 65.529, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 4722.92, "Total Cost": 4722.92, "Plan Rows": 49727, "Plan Width": 4, "Actual Startup Time": 13.376, "Actual Total Time": 13.377, "Actual Rows": 28281, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 4384, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.0, "Total Cost": 4722.92, "Plan Rows": 49727, "Plan Width": 4, "Actual Startup Time": 0.037, "Actual Total Time": 9.546, "Actual Rows": 28281, "Actual Loops": 3, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 50051}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 592393.74, "Total Cost": 592393.74, "Plan Rows": 202661, "Plan Width": 8, "Actual Startup Time": 1862.294, "Actual Total Time": 1862.308, "Actual Rows": 4, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 8, "Original Hash Batches": 8, "Peak Memory Usage": 1120, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 132136.9, "Total Cost": 592393.74, "Plan Rows": 202661, "Plan Width": 8, "Actual Startup Time": 1835.838, "Actual Total Time": 1862.015, "Actual Rows": 4, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 71027.22, "Total Cost": 525378.13, "Plan Rows": 293308, "Plan Width": 4, "Actual Startup Time": 1610.561, "Actual Total Time": 1636.872, "Actual Rows": 5, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.person_role_id = chn.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 25.98, "Total Cost": 442991.05, "Plan Rows": 601081, "Plan Width": 8, "Actual Startup Time": 128.9, "Actual Total Time": 1294.659, "Actual Rows": 478480, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 441377.81, "Plan Rows": 601081, "Plan Width": 12, "Actual Startup Time": 128.854, "Actual Total Time": 1224.806, "Actual Rows": 478480, "Actual Loops": 3, "Filter": "((note)::text ~~ '%(producer)%'::text)", "Rows Removed by Filter": 11602968}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 17.1, "Total Cost": 17.1, "Plan Rows": 710, "Plan Width": 4, "Actual Startup Time": 0.033, "Actual Total Time": 0.034, "Actual Rows": 12, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 17.1, "Plan Rows": 710, "Plan Width": 4, "Actual Startup Time": 0.029, "Actual Total Time": 0.03, "Actual Rows": 12, "Actual Loops": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 49533.0, "Total Cost": 49533.0, "Plan Rows": 1308500, "Plan Width": 4, "Actual Startup Time": 239.379, "Actual Total Time": 239.38, "Actual Rows": 1046780, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 64, "Original Hash Batches": 64, "Peak Memory Usage": 3008, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.0, "Total Cost": 49533.0, "Plan Rows": 1308500, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 113.581, "Actual Rows": 1046780, "Actual Loops": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 49166.73, "Total Cost": 49166.73, "Plan Rows": 727916, "Plan Width": 4, "Actual Startup Time": 184.789, "Actual Total Time": 184.789, "Actual Rows": 583011, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 32, "Original Hash Batches": 32, "Peak Memory Usage": 3200, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "title", "Alias": "t", "Startup Cost": 0.0, "Total Cost": 49166.73, "Plan Rows": 727916, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 113.817, "Actual Rows": 583011, "Actual Loops": 3, "Filter": "(production_year > 1990)", "Rows Removed by Filter": 259760}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 17.1, "Total Cost": 17.1, "Plan Rows": 710, "Plan Width": 4, "Actual Startup Time": 0.019, "Actual Total Time": 0.021, "Actual Rows": 4, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 17.1, "Plan Rows": 710, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.015, "Actual Rows": 4, "Actual Loops": 3}]}]}]}]}]}, "Planning Time": 83.005, "Triggers": [], "Execution Time": 2189.656}]
[{"Bao": {"Bao prediction": 1175.884, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 83192.88, "Total Cost": 83192.89, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 455.589, "Actual Total Time": 464.871, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 32820.19, "Total Cost": 83192.88, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 238.574, "Actual Total Time": 464.852, "Actual Rows": 310, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 31820.19, "Total Cost": 82192.78, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 237.357, "Actual Total Time": 452.083, "Actual Rows": 103, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 31819.77, "Total Cost": 82192.31, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 235.93, "Actual Total Time": 448.749, "Actual Rows": 2288, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.015, "Actual Total Time": 104.587, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 31819.76, "Total Cost": 31819.76, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 235.192, "Actual Total Time": 235.202, "Actual Rows": 233, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 31818.74, "Total Cost": 31819.76, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 229.601, "Actual Total Time": 234.779, "Actual Rows": 233, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ml.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 31818.31, "Total Cost": 31819.15, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 229.222, "Actual Total Time": 233.955, "Actual Rows": 384, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Merge Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 31817.89, "Total Cost": 31818.7, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 228.666, "Actual Total Time": 231.141, "Actual Rows": 1464, "Actual Loops": 3, "Inner Unique": false, "Merge Cond": "(mc.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 31255.69, "Total Cost": 31263.17, "Plan Rows": 2992, "Plan Width": 8, "Actual Startup Time": 223.839, "Actual Total Time": 225.117, "Actual Rows": 15931, "Actual Loops": 3, "Sort Key": ["mc.movie_id"], "Sort Method": "external merge", "Sort Space Used": 7256, "Sort Space Type": "Disk", "Workers": [{"Worker Number": 0, "Sort Method": "external merge", "Sort Space Used": 6960, "Sort Space Type": "Disk"}, {"Worker Number": 1, "Sort Method": "external merge", "Sort Space Used": 6952, "Sort Space Type": "Disk"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 31082.95, "Plan Rows": 2992, "Plan Width": 8, "Actual Startup Time": 37.913, "Actual Total Time": 135.81, "Actual Rows": 397976, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 531175, "Plan Width": 12, "Actual Startup Time": 0.019, "Actual Total Time": 81.158, "Actual Rows": 423996, "Actual Loops": 3, "Filter": "(note IS NULL)", "Rows Removed by Filter": 445713}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.019, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}]}, {"Node Type": "Sort", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 562.2, "Total Cost": 562.3, "Plan Rows": 42, "Plan Width": 4, "Actual Startup Time": 4.813, "Actual Total Time": 4.954, "Actual Rows": 3128, "Actual Loops": 3, "Sort Key": ["ml.movie_id"], "Sort Method": "quicksort", "Sort Space Used": 205, "Sort Space Type": "Memory", "Workers": [{"Worker Number": 0, "Sort Method": "quicksort", "Sort Space Used": 205, "Sort Space Type": "Memory"}, {"Worker Number": 1, "Sort Method": "quicksort", "Sort Space Used": 205, "Sort Space Type": "Memory"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.89, "Total Cost": 561.07, "Plan Rows": 42, "Plan Width": 4, "Actual Startup Time": 0.061, "Actual Total Time": 4.424, "Actual Rows": 2315, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ml.link_type_id = lt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 8, "Actual Startup Time": 0.032, "Actual Total Time": 2.062, "Actual Rows": 29997, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.017, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.011, "Actual Total Time": 0.014, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((link)::text ~~ '%follow%'::text)", "Rows Removed by Filter": 16}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 4393, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.59, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 1152, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 1950) AND (production_year <= 2000))", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 6863, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = 'sequel'::text)", "Rows Removed by Filter": 1}]}]}]}, "Planning Time": 85.905, "Triggers": [], "Execution Time": 465.849}]
[{"Bao": {"Bao prediction": 3262.875, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 514108.77, "Total Cost": 514108.78, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 4099.51, "Actual Total Time": 4145.038, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 514108.56, "Total Cost": 514108.77, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 4099.337, "Actual Total Time": 4145.032, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 513108.56, "Total Cost": 513108.57, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 4096.982, "Actual Total Time": 4096.993, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 462736.14, "Total Cost": 513108.56, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 4010.102, "Actual Total Time": 4096.988, "Actual Rows": 11, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 462735.71, "Total Cost": 513108.1, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 4010.081, "Actual Total Time": 4096.936, "Actual Rows": 11, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 462735.29, "Total Cost": 513107.64, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3976.531, "Actual Total Time": 4095.896, "Actual Rows": 438, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.017, "Actual Total Time": 100.711, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 462735.27, "Total Cost": 462735.27, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 3893.004, "Actual Total Time": 3893.012, "Actual Rows": 3, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2488.29, "Total Cost": 462735.27, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1134.823, "Actual Total Time": 3892.896, "Actual Rows": 3, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2487.86, "Total Cost": 462734.81, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 355.46, "Actual Total Time": 3029.05, "Actual Rows": 511941, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 12, "Actual Startup Time": 0.013, "Actual Total Time": 949.74, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2487.85, "Total Cost": 2487.85, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 355.423, "Actual Total Time": 355.431, "Actual Rows": 28583, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1373, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 19.5, "Total Cost": 2487.85, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.103, "Actual Total Time": 350.756, "Actual Rows": 28583, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 19.36, "Total Cost": 2487.67, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 0.081, "Actual Total Time": 272.457, "Actual Rows": 73560, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2485.89, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.044, "Actual Total Time": 67.226, "Actual Rows": 85941, "Actual Loops": 3, "Inner Unique": false, "Join Filter": "(cc.status_id = cct2.id)", "Rows Removed by Join Filter": 85941, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.02, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((kind)::text ~~ '%complete%'::text)", "Rows Removed by Filter": 2}, {"Node Type": "Hash Join", "Parent Relationship": "Inner", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 0.014, "Actual Total Time": 27.6, "Actual Rows": 85941, "Actual Loops": 6, "Inner Unique": true, "Hash Cond": "(cc.subject_id = cct1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.006, "Actual Total Time": 9.506, "Actual Rows": 135086, "Actual Loops": 6}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.007, "Actual Total Time": 0.007, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'cast'::text)", "Rows Removed by Filter": 3}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 1.78, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 257823, "Index Cond": "(id = cc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 1950)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 220680, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'movie'::text)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 1535822, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name)::text !~~ '%Sherlock%'::text) AND (((name)::text ~~ '%Tony%Stark%'::text) OR ((name)::text ~~ '%Iron%Man%'::text)))", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 1314, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 1, "Actual Loops": 33, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 33}]}]}]}]}, "Planning Time": 105.467, "Triggers": [], "Execution Time": 4145.184}]
[{"Bao": {"Bao prediction": 1962.141, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 512132.44, "Total Cost": 512132.45, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1918.532, "Actual Total Time": 1952.037, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 51885.35, "Total Cost": 512132.43, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 476.304, "Actual Total Time": 1952.031, "Actual Rows": 2, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 51884.92, "Total Cost": 512131.98, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 476.28, "Actual Total Time": 1951.854, "Actual Rows": 33, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50884.92, "Total Cost": 511131.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 406.382, "Actual Total Time": 1916.475, "Actual Rows": 11, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.012, "Actual Total Time": 850.643, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50884.91, "Total Cost": 50884.91, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 218.622, "Actual Total Time": 218.624, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.57, "Total Cost": 50884.91, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 165.539, "Actual Total Time": 218.597, "Actual Rows": 1, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 58.607, "Actual Total Time": 218.531, "Actual Rows": 5, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 104.049, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 11.984, "Actual Total Time": 11.985, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.329, "Actual Total Time": 11.98, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'marvel-cinematic-universe'::text)", "Rows Removed by Filter": 134169}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.012, "Actual Total Time": 0.012, "Actual Rows": 0, "Actual Loops": 14, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2014)", "Rows Removed by Filter": 1}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 0, "Actual Loops": 33, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name)::text ~~ '%Downey%Robert%'::text)", "Rows Removed by Filter": 1}]}]}, "Planning Time": 78.494, "Triggers": [], "Execution Time": 1952.1}]
[{"Bao": {"Bao prediction": 2400.875, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 350125.11, "Total Cost": 350125.12, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 816.949, "Actual Total Time": 850.231, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 350124.9, "Total Cost": 350125.11, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 816.789, "Actual Total Time": 850.225, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 349124.9, "Total Cost": 349124.91, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 814.2, "Actual Total Time": 814.209, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 298751.19, "Total Cost": 349124.89, "Plan Rows": 4, "Plan Width": 0, "Actual Startup Time": 794.054, "Actual Total Time": 814.204, "Actual Rows": 12, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 298750.77, "Total Cost": 349123.13, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 794.038, "Actual Total Time": 814.13, "Actual Rows": 12, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.007, "Actual Total Time": 109.102, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 298750.76, "Total Cost": 298750.76, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 603.301, "Actual Total Time": 603.308, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 263623.17, "Total Cost": 298750.76, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 560.286, "Actual Total Time": 603.279, "Actual Rows": 1, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 263622.74, "Total Cost": 298749.81, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 560.265, "Actual Total Time": 603.248, "Actual Rows": 1, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 263622.59, "Total Cost": 298749.64, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 560.247, "Actual Total Time": 603.227, "Actual Rows": 1, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 263622.17, "Total Cost": 298747.46, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 497.259, "Actual Total Time": 603.086, "Actual Rows": 25, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = at.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 35097.06, "Plan Rows": 7526, "Plan Width": 12, "Actual Startup Time": 0.029, "Actual Total Time": 116.13, "Actual Rows": 20555, "Actual Loops": 3, "Filter": "(((note)::text ~~ '%(200%)%'::text) AND ((note)::text ~~ '%(worldwide)%'::text))", "Rows Removed by Filter": 849155}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 263622.16, "Total Cost": 263622.16, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 485.597, "Actual Total Time": 485.6, "Actual Rows": 39, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 255359.21, "Total Cost": 263622.16, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 462.287, "Actual Total Time": 485.504, "Actual Rows": 39, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(at.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_title", "Alias": "at", "Startup Cost": 0.0, "Total Cost": 7698.13, "Plan Rows": 150613, "Plan Width": 4, "Actual Startup Time": 0.01, "Actual Total Time": 11.366, "Actual Rows": 120491, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 255359.2, "Total Cost": 255359.2, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 462.025, "Actual Total Time": 462.027, "Actual Rows": 590, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 255359.2, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 125.03, "Actual Total Time": 461.853, "Actual Rows": 590, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 255356.52, "Plan Rows": 94, "Plan Width": 8, "Actual Startup Time": 124.981, "Actual Total Time": 461.687, "Actual Rows": 590, "Actual Loops": 3, "Filter": "(((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))", "Rows Removed by Filter": 4944650}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.033, "Actual Total Time": 0.034, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.021, "Actual Total Time": 0.026, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 1.3, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.005, "Actual Total Time": 0.005, "Actual Rows": 0, "Actual Loops": 76, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((country_code)::text = '[us]'::text) AND ((name)::text = 'YouTube'::text))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.018, "Actual Rows": 1, "Actual Loops": 3, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 3}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.95, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.029, "Actual Total Time": 0.029, "Actual Rows": 1, "Actual Loops": 3, "Index Cond": "(id = at.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 2005) AND (production_year <= 2010))", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.005, "Actual Total Time": 0.005, "Actual Rows": 1, "Actual Loops": 37, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 37}]}]}]}]}, "Planning Time": 100.313, "Triggers": [], "Execution Time": 850.329}]
[{"Bao": {"Bao prediction": 1135.537, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 50226.76, "Total Cost": 50226.77, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 232.472, "Actual Total Time": 236.555, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 50226.55, "Total Cost": 50226.76, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 231.787, "Actual Total Time": 236.547, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 49226.55, "Total Cost": 49226.56, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 229.829, "Actual Total Time": 229.834, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 33908.15, "Total Cost": 49226.49, "Plan Rows": 23, "Plan Width": 0, "Actual Startup Time": 229.806, "Actual Total Time": 229.831, "Actual Rows": 1, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 33907.72, "Total Cost": 49178.32, "Plan Rows": 82, "Plan Width": 8, "Actual Startup Time": 229.763, "Actual Total Time": 229.787, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx.movie_id = mc.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 64.329, "Actual Total Time": 64.331, "Actual Rows": 3, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.009, "Actual Total Time": 32.196, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.033, "Actual Total Time": 0.034, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.03, "Actual Total Time": 0.031, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'bottom 10 rank'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 33866.15, "Total Cost": 33866.15, "Plan Rows": 3132, "Plan Width": 4, "Actual Startup Time": 165.071, "Actual Total Time": 165.073, "Actual Rows": 46968, "Actual Loops": 3, "Hash Buckets": 262144, "Original Hash Buckets": 8192, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9568, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 33866.15, "Plan Rows": 3132, "Plan Width": 4, "Actual Startup Time": 106.368, "Actual Total Time": 150.463, "Actual Rows": 46968, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 32379.21, "Plan Rows": 555923, "Plan Width": 8, "Actual Startup Time": 0.017, "Actual Total Time": 121.99, "Actual Rows": 445696, "Actual Loops": 3, "Filter": "((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text)", "Rows Removed by Filter": 424014}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.017, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.012, "Actual Total Time": 0.012, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.59, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.025, "Actual Total Time": 0.025, "Actual Rows": 1, "Actual Loops": 5, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 2005) AND (production_year <= 2010))", "Rows Removed by Filter": 0}]}]}]}]}, "Planning Time": 77.823, "Triggers": [], "Execution Time": 236.621}]
[{"Bao": {"Bao prediction": 1142.547, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 67996.0, "Total Cost": 67996.01, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 405.553, "Actual Total Time": 412.812, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 67995.78, "Total Cost": 67995.99, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 405.362, "Actual Total Time": 412.808, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 66995.78, "Total Cost": 66995.79, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 403.334, "Actual Total Time": 403.337, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50883.33, "Total Cost": 66995.78, "Plan Rows": 2, "Plan Width": 0, "Actual Startup Time": 282.152, "Actual Total Time": 403.234, "Actual Rows": 1567, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi_idx.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50882.9, "Total Cost": 66994.27, "Plan Rows": 3, "Plan Width": 8, "Actual Startup Time": 282.138, "Actual Total Time": 396.124, "Actual Rows": 2697, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx.movie_id = mk.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 16101.88, "Plan Rows": 3174, "Plan Width": 4, "Actual Startup Time": 0.067, "Actual Total Time": 101.779, "Actual Rows": 149656, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 358654, "Plan Width": 8, "Actual Startup Time": 0.016, "Actual Total Time": 74.827, "Actual Rows": 287152, "Actual Loops": 3, "Filter": "((info)::text > '2.0'::text)", "Rows Removed by Filter": 172860}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.031, "Actual Total Time": 0.032, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.027, "Actual Total Time": 0.029, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50878.2, "Total Cost": 50878.2, "Plan Rows": 182, "Plan Width": 4, "Actual Startup Time": 280.627, "Actual Total Time": 280.629, "Actual Rows": 4317, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 792, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.29, "Total Cost": 50878.2, "Plan Rows": 182, "Plan Width": 4, "Actual Startup Time": 19.673, "Actual Total Time": 228.011, "Actual Rows": 4317, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.017, "Actual Total Time": 105.407, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 13, "Plan Width": 4, "Actual Startup Time": 19.509, "Actual Total Time": 19.509, "Actual Rows": 30, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 10, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 13, "Plan Width": 4, "Actual Startup Time": 1.172, "Actual Total Time": 19.492, "Actual Rows": 30, "Actual Loops": 3, "Filter": "((keyword)::text ~~ '%sequel%'::text)", "Rows Removed by Filter": 134140}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 8092, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 1990)", "Rows Removed by Filter": 0}]}]}]}]}, "Planning Time": 77.404, "Triggers": [], "Execution Time": 412.878}]
[{"Bao": {"Bao prediction": 3404.004, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 406345.85, "Total Cost": 406345.86, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3518.044, "Actual Total Time": 3553.646, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 406345.63, "Total Cost": 406345.84, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 3516.353, "Actual Total Time": 3553.64, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 405345.63, "Total Cost": 405345.64, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3513.794, "Actual Total Time": 3513.806, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 354973.24, "Total Cost": 405345.63, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1841.203, "Actual Total Time": 3513.388, "Actual Rows": 7163, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 354972.82, "Total Cost": 405345.18, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1835.5, "Actual Total Time": 2135.433, "Actual Rows": 870324, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.024, "Actual Total Time": 99.42, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 354972.8, "Total Cost": 354972.8, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1835.061, "Actual Total Time": 1835.072, "Actual Rows": 11977, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2744, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 319642.11, "Total Cost": 354972.8, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1500.057, "Actual Total Time": 1802.509, "Actual Rows": 11977, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 319641.96, "Total Cost": 354972.64, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1500.044, "Actual Total Time": 1790.433, "Actual Rows": 11977, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 319641.54, "Total Cost": 354972.08, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 1500.029, "Actual Total Time": 1764.047, "Actual Rows": 13444, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 319641.39, "Total Cost": 354970.55, "Plan Rows": 9, "Plan Width": 28, "Actual Startup Time": 1499.888, "Actual Total Time": 1746.821, "Actual Rows": 16731, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 319640.96, "Total Cost": 354957.43, "Plan Rows": 22, "Plan Width": 20, "Actual Startup Time": 1499.862, "Actual Total Time": 1655.186, "Actual Rows": 42758, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 35097.06, "Plan Rows": 58487, "Plan Width": 12, "Actual Startup Time": 0.019, "Actual Total Time": 129.936, "Actual Rows": 101090, "Actual Loops": 3, "Filter": "(((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))", "Rows Removed by Filter": 768619}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 319640.04, "Total Cost": 319640.04, "Plan Rows": 74, "Plan Width": 8, "Actual Startup Time": 1499.819, "Actual Total Time": 1499.824, "Actual Rows": 71080, "Actual Loops": 3, "Hash Buckets": 262144, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 12472, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 16717.75, "Total Cost": 319640.04, "Plan Rows": 74, "Plan Width": 8, "Actual Startup Time": 1428.565, "Actual Total Time": 1479.811, "Actual Rows": 71080, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 302913.76, "Plan Rows": 2837, "Plan Width": 4, "Actual Startup Time": 964.926, "Actual Total Time": 1247.151, "Actual Rows": 204750, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 302038.28, "Plan Rows": 320570, "Plan Width": 8, "Actual Startup Time": 0.551, "Actual Total Time": 1219.447, "Actual Rows": 238737, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))", "Rows Removed by Filter": 4706503}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.013, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.006, "Actual Total Time": 0.012, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'countries'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 16653.27, "Total Cost": 16653.27, "Plan Rows": 4965, "Plan Width": 4, "Actual Startup Time": 154.331, "Actual Total Time": 154.333, "Actual Rows": 151410, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 16384, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 3296, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 16653.27, "Plan Rows": 4965, "Plan Width": 4, "Actual Startup Time": 0.056, "Actual Total Time": 115.591, "Actual Rows": 151410, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 561109, "Plan Width": 8, "Actual Startup Time": 0.019, "Actual Total Time": 78.456, "Actual Rows": 447629, "Actual Loops": 3, "Filter": "((info)::text < '8.5'::text)", "Rows Removed by Filter": 12383}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.027, "Actual Total Time": 0.028, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.022, "Actual Total Time": 0.023, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.58, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 128275, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2005)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 50194, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = ANY ('{movie,episode}'::text[]))", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.55, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 40333, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text <> '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 35930, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 35930}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 2610972, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))", "Rows Removed by Filter": 1}]}]}]}]}, "Planning Time": 135.526, "Triggers": [], "Execution Time": 3553.762}]
[{"Bao": {"Bao prediction": 2898.17, "Bao recommended hint": "SET enable_nestloop TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 348795.27, "Total Cost": 348795.28, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1885.141, "Actual Total Time": 1919.645, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 348795.16, "Total Cost": 348795.27, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1884.99, "Actual Total Time": 1919.639, "Actual Rows": 2, "Actual Loops": 1, "Workers Planned": 1, "Workers Launched": 1, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 347795.16, "Total Cost": 347795.17, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1883.285, "Actual Total Time": 1883.3, "Actual Rows": 1, "Actual Loops": 2, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 342885.75, "Total Cost": 347795.16, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1868.068, "Actual Total Time": 1883.287, "Actual Rows": 186, "Actual Loops": 2, "Inner Unique": false, "Hash Cond": "(cn.id = mc.company_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.0, "Total Cost": 4722.92, "Plan Rows": 49727, "Plan Width": 4, "Actual Startup Time": 0.011, "Actual Total Time": 12.845, "Actual Rows": 42422, "Actual Loops": 2, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 75077}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 342885.74, "Total Cost": 342885.74, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1867.338, "Actual Total Time": 1867.353, "Actual Rows": 313, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 310330.62, "Total Cost": 342885.74, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1753.621, "Actual Total Time": 1867.234, "Actual Rows": 313, "Actual Loops": 2, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 32551.06, "Plan Rows": 6125, "Plan Width": 8, "Actual Startup Time": 89.351, "Actual Total Time": 233.223, "Actual Rows": 667442, "Actual Loops": 2, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 12, "Actual Startup Time": 0.024, "Actual Total Time": 89.375, "Actual Rows": 1304564, "Actual Loops": 2}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.024, "Actual Total Time": 0.024, "Actual Rows": 1, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.021, "Actual Total Time": 0.021, "Actual Rows": 1, "Actual Loops": 2, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 310311.69, "Total Cost": 310311.69, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1595.26, "Actual Total Time": 1595.273, "Actual Rows": 136, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 295041.42, "Total Cost": 310311.69, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1517.182, "Actual Total Time": 1595.195, "Actual Rows": 136, "Actual Loops": 2, "Inner Unique": false, "Hash Cond": "(miidx.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 0.06, "Actual Total Time": 114.516, "Actual Rows": 229962, "Actual Loops": 2, "Inner Unique": true, "Hash Cond": "(miidx.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "miidx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.022, "Actual Total Time": 46.994, "Actual Rows": 690018, "Actual Loops": 2}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.023, "Actual Total Time": 0.024, "Actual Rows": 1, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 2, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 295038.98, "Total Cost": 295038.98, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1465.967, "Actual Total Time": 1465.971, "Actual Rows": 255, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 54461.92, "Total Cost": 295038.98, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 793.317, "Actual Total Time": 1465.857, "Actual Rows": 255, "Actual Loops": 2, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it2.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 54459.5, "Total Cost": 295036.54, "Plan Rows": 5, "Plan Width": 12, "Actual Startup Time": 356.994, "Actual Total Time": 1465.611, "Actual Rows": 2207, "Actual Loops": 2, "Inner Unique": true, "Hash Cond": "(t.kind_id = kt.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 54436.68, "Total Cost": 295010.67, "Plan Rows": 1162, "Plan Width": 16, "Actual Startup Time": 341.83, "Actual Total Time": 1464.906, "Actual Rows": 5932, "Actual Loops": 2, "Inner Unique": true, "Hash Cond": "(mi.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 224235.35, "Plan Rows": 6224235, "Plan Width": 8, "Actual Startup Time": 0.012, "Actual Total Time": 546.531, "Actual Rows": 7417860, "Actual Loops": 2}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 54434.22, "Total Cost": 54434.22, "Plan Rows": 197, "Plan Width": 8, "Actual Startup Time": 341.201, "Actual Total Time": 341.201, "Actual Rows": 1109, "Actual Loops": 2, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 184, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "title", "Alias": "t", "Startup Cost": 0.0, "Total Cost": 54434.22, "Plan Rows": 197, "Plan Width": 8, "Actual Startup Time": 0.233, "Actual Total Time": 264.834, "Actual Rows": 1109, "Actual Loops": 2, "Filter": "(((title)::text <> ''::text) AND (((title)::text ~~ '%Champion%'::text) OR ((title)::text ~~ '%Loser%'::text)))", "Rows Removed by Filter": 1263047}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 22.75, "Total Cost": 22.75, "Plan Rows": 5, "Plan Width": 4, "Actual Startup Time": 0.014, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.0, "Total Cost": 22.75, "Plan Rows": 5, "Plan Width": 4, "Actual Startup Time": 0.012, "Actual Total Time": 0.013, "Actual Rows": 1, "Actual Loops": 2, "Filter": "((kind)::text = 'movie'::text)", "Rows Removed by Filter": 6}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.038, "Actual Total Time": 0.039, "Actual Rows": 1, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.029, "Actual Total Time": 0.035, "Actual Rows": 1, "Actual Loops": 2, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}]}]}]}]}]}, "Planning Time": 93.913, "Triggers": [], "Execution Time": 1919.734}]
[{"Bao": {"Bao prediction": 3764.31, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 837833.47, "Total Cost": 837833.48, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3481.672, "Actual Total Time": 3543.155, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 837833.25, "Total Cost": 837833.46, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 3480.207, "Actual Total Time": 3543.149, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 836833.25, "Total Cost": 836833.26, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3477.883, "Actual Total Time": 3477.901, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 786382.32, "Total Cost": 836833.25, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2633.366, "Actual Total Time": 3477.291, "Actual Rows": 8718, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 786381.89, "Total Cost": 836832.4, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2633.347, "Actual Total Time": 3457.344, "Actual Rows": 8718, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 786381.47, "Total Cost": 836754.32, "Plan Rows": 116, "Plan Width": 20, "Actual Startup Time": 2631.777, "Actual Total Time": 2901.829, "Actual Rows": 313684, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.008, "Actual Total Time": 103.996, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 786381.34, "Total Cost": 786381.34, "Plan Rows": 10, "Plan Width": 12, "Actual Startup Time": 2630.624, "Actual Total Time": 2630.637, "Actual Rows": 9358, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1848, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 286435.79, "Total Cost": 786381.34, "Plan Rows": 10, "Plan Width": 12, "Actual Startup Time": 1699.382, "Actual Total Time": 2592.92, "Actual Rows": 9358, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 286435.36, "Total Cost": 786356.49, "Plan Rows": 23, "Plan Width": 16, "Actual Startup Time": 1699.288, "Actual Total Time": 2547.721, "Actual Rows": 18052, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 497985.06, "Plan Rows": 516258, "Plan Width": 8, "Actual Startup Time": 97.891, "Actual Total Time": 1387.927, "Actual Rows": 414905, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(writer),\"(head writer)\",\"(written by)\",(story),\"(story editor)\"}'::text[]))", "Rows Removed by Filter": 11666543}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 286435.15, "Total Cost": 286435.15, "Plan Rows": 17, "Plan Width": 8, "Actual Startup Time": 1097.633, "Actual Total Time": 1097.643, "Actual Rows": 34172, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 6104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 15319.64, "Total Cost": 286435.15, "Plan Rows": 17, "Plan Width": 8, "Actual Startup Time": 1060.439, "Actual Total Time": 1084.308, "Actual Rows": 34172, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 271115.48, "Plan Rows": 637, "Plan Width": 4, "Actual Startup Time": 813.421, "Actual Total Time": 928.706, "Actual Rows": 62198, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 270917.11, "Plan Rows": 71947, "Plan Width": 8, "Actual Startup Time": 533.442, "Actual Total Time": 920.634, "Actual Rows": 62990, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))", "Rows Removed by Filter": 4882250}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 0.017, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.009, "Actual Total Time": 0.015, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'genres'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 15253.6, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 118.978, "Actual Total Time": 118.986, "Actual Rows": 153308, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 16384, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 3328, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 0.056, "Actual Total Time": 81.062, "Actual Rows": 153308, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.015, "Actual Total Time": 34.048, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.031, "Actual Total Time": 0.032, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.025, "Actual Total Time": 0.026, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'votes'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 1.08, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 54155, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((gender)::text = 'm'::text)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.67, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 941053, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.84, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 26153, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 26153}]}]}]}]}, "Planning Time": 95.858, "Triggers": [], "Execution Time": 3543.251}]
[{"Bao": {"Bao prediction": 3232.362, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 371045.62, "Total Cost": 371045.63, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2023.35, "Actual Total Time": 2058.864, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 320673.12, "Total Cost": 371045.61, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1796.473, "Actual Total Time": 2058.812, "Actual Rows": 761, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 319673.12, "Total Cost": 370045.51, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1794.001, "Actual Total Time": 2019.994, "Actual Rows": 254, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 319672.7, "Total Cost": 370045.06, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1793.702, "Actual Total Time": 1973.476, "Actual Rows": 25223, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.012, "Actual Total Time": 100.604, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 319672.69, "Total Cost": 319672.69, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1747.979, "Actual Total Time": 1748.128, "Actual Rows": 2915, "Actual Loops": 3, "Hash Buckets": 8192, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 600, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 16718.33, "Total Cost": 319672.69, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1444.75, "Actual Total Time": 1693.097, "Actual Rows": 2915, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 16718.18, "Total Cost": 319670.81, "Plan Rows": 11, "Plan Width": 16, "Actual Startup Time": 1431.08, "Actual Total Time": 1686.607, "Actual Rows": 5838, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 16717.75, "Total Cost": 319627.89, "Plan Rows": 72, "Plan Width": 8, "Actual Startup Time": 1430.98, "Actual Total Time": 1490.369, "Actual Rows": 71080, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 302901.77, "Plan Rows": 2798, "Plan Width": 4, "Actual Startup Time": 965.982, "Actual Total Time": 1248.134, "Actual Rows": 204750, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 302038.28, "Plan Rows": 316166, "Plan Width": 8, "Actual Startup Time": 0.571, "Actual Total Time": 1220.614, "Actual Rows": 235558, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))", "Rows Removed by Filter": 4709682}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.007, "Actual Total Time": 0.012, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'countries'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 16653.27, "Total Cost": 16653.27, "Plan Rows": 4965, "Plan Width": 4, "Actual Startup Time": 154.79, "Actual Total Time": 154.791, "Actual Rows": 151410, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 16384, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 3328, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 16653.27, "Plan Rows": 4965, "Plan Width": 4, "Actual Startup Time": 0.058, "Actual Total Time": 116.118, "Actual Rows": 151410, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 561109, "Plan Width": 8, "Actual Startup Time": 0.019, "Actual Total Time": 78.768, "Actual Rows": 447629, "Actual Loops": 3, "Filter": "((info)::text < '8.5'::text)", "Rows Removed by Filter": 12383}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.028, "Actual Total Time": 0.029, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.023, "Actual Total Time": 0.025, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.58, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 213239, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2010)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 17514, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'movie'::text)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 75669, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))", "Rows Removed by Filter": 1}]}]}]}, "Planning Time": 86.118, "Triggers": [], "Execution Time": 2058.958}]
[{"Bao": {"Bao prediction": 1463.324, "Bao recommended hint": "SET enable_mergejoin TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 83029.95, "Total Cost": 83029.96, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 369.167, "Actual Total Time": 378.611, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 32657.23, "Total Cost": 83029.95, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 369.122, "Actual Total Time": 378.605, "Actual Rows": 14, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 32656.81, "Total Cost": 83029.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 368.87, "Actual Total Time": 378.514, "Actual Rows": 56, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 32656.39, "Total Cost": 83029.03, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 368.835, "Actual Total Time": 378.292, "Actual Rows": 84, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 31656.39, "Total Cost": 82028.93, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 300.21, "Actual Total Time": 366.769, "Actual Rows": 28, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 102.165, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 31656.38, "Total Cost": 31656.38, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 163.551, "Actual Total Time": 163.556, "Actual Rows": 7, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 580.95, "Total Cost": 31656.38, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 124.61, "Actual Total Time": 163.514, "Actual Rows": 7, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ml.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 580.52, "Total Cost": 31655.77, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 42.425, "Actual Total Time": 161.985, "Actual Rows": 598, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 31082.95, "Plan Rows": 2992, "Plan Width": 8, "Actual Startup Time": 37.908, "Actual Total Time": 133.649, "Actual Rows": 397976, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 531175, "Plan Width": 12, "Actual Startup Time": 0.018, "Actual Total Time": 80.546, "Actual Rows": 423996, "Actual Loops": 3, "Filter": "(note IS NULL)", "Rows Removed by Filter": 445713}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 0.018, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.012, "Actual Total Time": 0.013, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 561.07, "Total Cost": 561.07, "Plan Rows": 42, "Plan Width": 4, "Actual Startup Time": 4.464, "Actual Total Time": 4.466, "Actual Rows": 1158, "Actual Loops": 3, "Hash Buckets": 2048, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 57, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.89, "Total Cost": 561.07, "Plan Rows": 42, "Plan Width": 4, "Actual Startup Time": 0.061, "Actual Total Time": 4.325, "Actual Rows": 1158, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ml.link_type_id = lt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 8, "Actual Startup Time": 0.025, "Actual Total Time": 2.07, "Actual Rows": 29997, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.018, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.01, "Actual Total Time": 0.013, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((link)::text ~~ '%follows%'::text)", "Rows Removed by Filter": 17}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.59, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 1793, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((title)::text ~~ '%Money%'::text) AND (production_year = 1998))", "Rows Removed by Filter": 1}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 84, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 56, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = 'sequel'::text)", "Rows Removed by Filter": 1}]}]}, "Planning Time": 85.585, "Triggers": [], "Execution Time": 378.699}]
[{"Bao": {"Bao prediction": 2927.544, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 513969.89, "Total Cost": 513969.9, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1475.967, "Actual Total Time": 1505.856, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 513969.67, "Total Cost": 513969.88, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 1475.794, "Actual Total Time": 1505.85, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 512969.67, "Total Cost": 512969.68, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1473.454, "Actual Total Time": 1473.459, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 479160.53, "Total Cost": 512969.67, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1303.074, "Actual Total Time": 1473.448, "Actual Rows": 35, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 479160.1, "Total Cost": 512969.15, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1302.124, "Actual Total Time": 1472.853, "Actual Rows": 88, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 479159.95, "Total Cost": 512968.98, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1302.115, "Actual Total Time": 1472.732, "Actual Rows": 88, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 479159.52, "Total Cost": 512963.4, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1302.067, "Actual Total Time": 1471.855, "Actual Rows": 92, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 479159.1, "Total Cost": 512897.84, "Plan Rows": 147, "Plan Width": 20, "Actual Startup Time": 1274.681, "Actual Total Time": 1421.919, "Actual Rows": 29496, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 12, "Actual Startup Time": 0.012, "Actual Total Time": 62.074, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 479158.47, "Total Cost": 479158.47, "Plan Rows": 50, "Plan Width": 8, "Actual Startup Time": 1274.348, "Actual Total Time": 1274.35, "Actual Rows": 8625, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1528, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 479158.47, "Plan Rows": 50, "Plan Width": 8, "Actual Startup Time": 0.212, "Actual Total Time": 1207.013, "Actual Rows": 8625, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 479115.98, "Plan Rows": 8925, "Plan Width": 12, "Actual Startup Time": 0.177, "Actual Total Time": 1205.335, "Actual Rows": 10763, "Actual Loops": 3, "Filter": "(((note)::text ~~ '%(voice)%'::text) AND ((note)::text ~~ '%(uncredited)%'::text))", "Rows Removed by Filter": 12070685}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.024, "Actual Total Time": 0.025, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.02, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((role)::text = 'actor'::text)", "Rows Removed by Filter": 11}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 88489, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[ru]'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 5.59, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.009, "Actual Total Time": 0.009, "Actual Rows": 1, "Actual Loops": 275, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 265}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 265, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 265}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.52, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.006, "Actual Total Time": 0.006, "Actual Rows": 0, "Actual Loops": 265, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2005)", "Rows Removed by Filter": 1}]}]}]}]}, "Planning Time": 80.393, "Triggers": [], "Execution Time": 1505.944}]
[{"Bao": {"Bao prediction": 757.775, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 52751.88, "Total Cost": 52751.89, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 241.996, "Actual Total Time": 250.45, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 52751.67, "Total Cost": 52751.88, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 241.838, "Actual Total Time": 250.443, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 51751.67, "Total Cost": 51751.68, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 239.728, "Actual Total Time": 239.732, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3465.08, "Total Cost": 51751.66, "Plan Rows": 5, "Plan Width": 0, "Actual Startup Time": 19.039, "Actual Total Time": 239.641, "Actual Rows": 1463, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3464.65, "Total Cost": 51729.3, "Plan Rows": 5, "Plan Width": 4, "Actual Startup Time": 19.018, "Actual Total Time": 232.168, "Actual Rows": 1463, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3464.22, "Total Cost": 51726.86, "Plan Rows": 5, "Plan Width": 12, "Actual Startup Time": 18.996, "Actual Total Time": 229.46, "Actual Rows": 1463, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3464.07, "Total Cost": 51726.02, "Plan Rows": 5, "Plan Width": 16, "Actual Startup Time": 18.967, "Actual Total Time": 227.952, "Actual Rows": 1463, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 10.811, "Actual Total Time": 217.057, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.009, "Actual Total Time": 101.36, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 10.767, "Actual Total Time": 10.768, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.558, "Actual Total Time": 10.764, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'character-name-in-title'::text)", "Rows Removed by Filter": 134169}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 462.97, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 12, "Actual Startup Time": 7.889, "Actual Total Time": 7.89, "Actual Rows": 29997, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 32768, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1545, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 12, "Actual Startup Time": 0.021, "Actual Total Time": 3.7, "Actual Rows": 29997, "Actual Loops": 3}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "link_type_pkey", "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 4388, "Index Cond": "(id = ml.link_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 4388}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t1", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 4388, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 4388}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t2", "Startup Cost": 0.43, "Total Cost": 4.47, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.005, "Actual Total Time": 0.005, "Actual Rows": 1, "Actual Loops": 4388, "Index Cond": "(id = ml.linked_movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 4388}]}]}]}]}, "Planning Time": 78.042, "Triggers": [], "Execution Time": 250.53}]
[{"Bao": {"Bao prediction": 2011.116, "Bao recommended hint": "SET enable_mergejoin TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 378807.31, "Total Cost": 378807.32, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1556.888, "Actual Total Time": 1588.937, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 378807.1, "Total Cost": 378807.31, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 1556.766, "Actual Total Time": 1588.932, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 377807.1, "Total Cost": 377807.11, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1554.258, "Actual Total Time": 1554.268, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 82030.31, "Total Cost": 377807.1, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1387.136, "Actual Total Time": 1554.238, "Actual Rows": 625, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 294257.98, "Plan Rows": 405012, "Plan Width": 4, "Actual Startup Time": 0.058, "Actual Total Time": 1148.384, "Actual Rows": 312074, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,English}'::text[]))", "Rows Removed by Filter": 4633166}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 82030.29, "Total Cost": 82030.29, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 387.025, "Actual Total Time": 387.033, "Actual Rows": 134, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 31657.27, "Total Cost": 82030.29, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 241.23, "Actual Total Time": 386.911, "Actual Rows": 134, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 31656.85, "Total Cost": 82029.39, "Plan Rows": 2, "Plan Width": 20, "Actual Startup Time": 165.422, "Actual Total Time": 382.664, "Actual Rows": 2899, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.016, "Actual Total Time": 104.083, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 31656.84, "Total Cost": 31656.84, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 165.206, "Actual Total Time": 165.211, "Actual Rows": 377, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 581.37, "Total Cost": 31656.84, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 42.669, "Actual Total Time": 165.04, "Actual Rows": 377, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ml.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 580.94, "Total Cost": 31656.23, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 42.643, "Actual Total Time": 164.221, "Actual Rows": 384, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 580.52, "Total Cost": 31655.77, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 42.225, "Actual Total Time": 161.471, "Actual Rows": 1464, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 31082.95, "Plan Rows": 2992, "Plan Width": 8, "Actual Startup Time": 37.56, "Actual Total Time": 133.338, "Actual Rows": 397976, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 531175, "Plan Width": 12, "Actual Startup Time": 0.021, "Actual Total Time": 80.699, "Actual Rows": 423996, "Actual Loops": 3, "Filter": "(note IS NULL)", "Rows Removed by Filter": 445713}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.019, "Actual Total Time": 0.02, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.014, "Actual Total Time": 0.015, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 561.07, "Total Cost": 561.07, "Plan Rows": 42, "Plan Width": 4, "Actual Startup Time": 4.606, "Actual Total Time": 4.608, "Actual Rows": 2315, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 114, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.89, "Total Cost": 561.07, "Plan Rows": 42, "Plan Width": 4, "Actual Startup Time": 0.06, "Actual Total Time": 4.344, "Actual Rows": 2315, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ml.link_type_id = lt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 8, "Actual Startup Time": 0.028, "Actual Total Time": 2.003, "Actual Rows": 29997, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.02, "Actual Total Time": 0.021, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.011, "Actual Total Time": 0.014, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((link)::text ~~ '%follow%'::text)", "Rows Removed by Filter": 16}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 4393, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.59, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 1152, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 1950) AND (production_year <= 2010))", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 8697, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = 'sequel'::text)", "Rows Removed by Filter": 1}]}]}]}]}]}]}, "Planning Time": 98.397, "Triggers": [], "Execution Time": 1589.041}]
[{"Bao": {"Bao prediction": 3668.716, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 290319.36, "Total Cost": 290319.37, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 4995.258, "Actual Total Time": 5025.703, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 48897.35, "Total Cost": 290319.36, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1466.889, "Actual Total Time": 4991.513, "Actual Rows": 670390, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 48896.93, "Total Cost": 290318.92, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1466.873, "Actual Total Time": 2112.37, "Actual Rows": 1919495, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 47896.93, "Total Cost": 289318.82, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1467.37, "Actual Total Time": 3772.264, "Actual Rows": 639832, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 47896.78, "Total Cost": 289310.99, "Plan Rows": 46, "Plan Width": 8, "Actual Startup Time": 1401.165, "Actual Total Time": 3001.978, "Actual Rows": 834997, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 47896.35, "Total Cost": 289289.85, "Plan Rows": 46, "Plan Width": 16, "Actual Startup Time": 1401.107, "Actual Total Time": 1679.511, "Actual Rows": 834997, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mc.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 241189.17, "Plan Rows": 55082, "Plan Width": 4, "Actual Startup Time": 211.482, "Actual Total Time": 818.092, "Actual Rows": 1012240, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 224235.35, "Plan Rows": 6224235, "Plan Width": 8, "Actual Startup Time": 0.016, "Actual Total Time": 388.651, "Actual Rows": 4945240, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 0.018, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.01, "Actual Total Time": 0.016, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 47891.91, "Total Cost": 47891.91, "Plan Rows": 161, "Plan Width": 12, "Actual Startup Time": 473.106, "Actual Total Time": 473.111, "Actual Rows": 194741, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 4000, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 15336.14, "Total Cost": 47891.91, "Plan Rows": 161, "Plan Width": 12, "Actual Startup Time": 339.518, "Actual Total Time": 425.691, "Actual Rows": 194741, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = miidx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 32551.06, "Plan Rows": 6125, "Plan Width": 8, "Actual Startup Time": 62.331, "Actual Total Time": 163.429, "Actual Rows": 444961, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 12, "Actual Startup Time": 0.012, "Actual Total Time": 63.535, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.029, "Actual Total Time": 0.029, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.027, "Actual Total Time": 0.027, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 15253.6, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 120.482, "Actual Total Time": 120.484, "Actual Rows": 153308, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 16384, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 3328, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 0.052, "Actual Total Time": 82.585, "Actual Rows": 153308, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(miidx.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "miidx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.014, "Actual Total Time": 34.609, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.029, "Actual Total Time": 0.029, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.023, "Actual Total Time": 0.024, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 2504990, "Index Cond": "(id = mi.movie_id)", "Rows Removed by Index Recheck": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 2504990, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'movie'::text)", "Rows Removed by Filter": 0}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 1919495, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1}]}]}, "Planning Time": 91.125, "Triggers": [], "Execution Time": 5025.8}]
[{"Bao": {"Bao prediction": 3454.964, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 840260.12, "Total Cost": 840260.13, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2699.209, "Actual Total Time": 2761.102, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 789885.99, "Total Cost": 840260.12, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2508.95, "Actual Total Time": 2761.035, "Actual Rows": 1273, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 788885.99, "Total Cost": 839260.02, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2502.076, "Actual Total Time": 2695.191, "Actual Rows": 424, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 788885.57, "Total Cost": 839257.93, "Plan Rows": 2, "Plan Width": 4, "Actual Startup Time": 2495.556, "Actual Total Time": 2668.152, "Actual Rows": 15754, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.019, "Actual Total Time": 103.869, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 788885.56, "Total Cost": 788885.56, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2453.755, "Actual Total Time": 2453.764, "Actual Rows": 146, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 755135.19, "Total Cost": 788885.56, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2274.947, "Actual Total Time": 2453.665, "Actual Rows": 146, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 755134.76, "Total Cost": 788884.4, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2274.916, "Actual Total Time": 2452.993, "Actual Rows": 146, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 755134.34, "Total Cost": 788872.57, "Plan Rows": 12, "Plan Width": 20, "Actual Startup Time": 2251.087, "Actual Total Time": 2396.355, "Actual Rows": 31220, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.019, "Actual Total Time": 63.765, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 755134.29, "Total Cost": 755134.29, "Plan Rows": 4, "Plan Width": 12, "Actual Startup Time": 2250.164, "Actual Total Time": 2250.17, "Actual Rows": 3888, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 824, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 255200.19, "Total Cost": 755134.29, "Plan Rows": 4, "Plan Width": 12, "Actual Startup Time": 1609.048, "Actual Total Time": 2196.87, "Actual Rows": 3888, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 255199.76, "Total Cost": 755120.83, "Plan Rows": 10, "Plan Width": 16, "Actual Startup Time": 1520.501, "Actual Total Time": 2174.416, "Actual Rows": 7262, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 497985.06, "Plan Rows": 516258, "Plan Width": 8, "Actual Startup Time": 89.784, "Actual Total Time": 1379.459, "Actual Rows": 414905, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(writer),\"(head writer)\",\"(written by)\",(story),\"(story editor)\"}'::text[]))", "Rows Removed by Filter": 11666543}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 255199.68, "Total Cost": 255199.68, "Plan Rows": 7, "Plan Width": 8, "Actual Startup Time": 752.703, "Actual Total Time": 752.707, "Actual Rows": 13022, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2584, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 15319.64, "Total Cost": 255199.68, "Plan Rows": 7, "Plan Width": 8, "Actual Startup Time": 727.768, "Actual Total Time": 746.768, "Actual Rows": 13022, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 239881.42, "Plan Rows": 270, "Plan Width": 4, "Actual Startup Time": 530.045, "Actual Total Time": 600.871, "Actual Rows": 24086, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 239795.93, "Plan Rows": 30499, "Plan Width": 8, "Actual Startup Time": 376.721, "Actual Total Time": 597.71, "Actual Rows": 24349, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Horror,Thriller}'::text[]))", "Rows Removed by Filter": 4920891}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.015, "Actual Total Time": 0.016, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'genres'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 15253.6, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 118.688, "Actual Total Time": 118.69, "Actual Rows": 153308, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 16384, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 3328, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 0.057, "Actual Total Time": 80.445, "Actual Rows": 153308, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.015, "Actual Total Time": 33.797, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.03, "Actual Total Time": 0.03, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.025, "Actual Total Time": 0.026, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'votes'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 1.35, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 21787, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((gender)::text = 'm'::text)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.98, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 93660, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name)::text ~~ 'Lionsgate%'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 1.15, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 1, "Actual Loops": 439, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 439}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.98, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 47262, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))", "Rows Removed by Filter": 1}]}]}]}, "Planning Time": 162.026, "Triggers": [], "Execution Time": 2761.217}]
[{"Bao": {"Bao prediction": 2545.441, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 494205.61, "Total Cost": 494205.62, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1364.995, "Actual Total Time": 1396.577, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 494205.39, "Total Cost": 494205.6, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 1364.709, "Actual Total Time": 1396.573, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 493205.39, "Total Cost": 493205.4, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1362.346, "Actual Total Time": 1362.356, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 476643.41, "Total Cost": 493205.39, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1346.719, "Actual Total Time": 1362.351, "Actual Rows": 21, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 476642.98, "Total Cost": 493203.27, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1346.697, "Actual Total Time": 1362.216, "Actual Rows": 21, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 476642.55, "Total Cost": 493202.5, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1302.156, "Actual Total Time": 1353.033, "Actual Rows": 5793, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an1.person_id = ci.person_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an1", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.025, "Actual Total Time": 25.116, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 476642.53, "Total Cost": 476642.53, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1301.273, "Actual Total Time": 1301.282, "Actual Rows": 2479, "Actual Loops": 3, "Hash Buckets": 8192, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 504, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 441518.56, "Total Cost": 476642.53, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1165.728, "Actual Total Time": 1277.864, "Actual Rows": 2479, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 441518.14, "Total Cost": 476636.14, "Plan Rows": 4, "Plan Width": 16, "Actual Startup Time": 1165.674, "Actual Total Time": 1273.913, "Actual Rows": 2511, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 35097.06, "Plan Rows": 5579, "Plan Width": 8, "Actual Startup Time": 0.057, "Actual Total Time": 105.853, "Actual Rows": 16299, "Actual Loops": 3, "Filter": "(((note)::text ~~ '%(Japan)%'::text) AND ((note)::text !~~ '%(USA)%'::text))", "Rows Removed by Filter": 853411}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 441514.99, "Total Cost": 441514.99, "Plan Rows": 252, "Plan Width": 8, "Actual Startup Time": 1165.504, "Actual Total Time": 1165.511, "Actual Rows": 11616, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2424, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 441514.99, "Plan Rows": 252, "Plan Width": 8, "Actual Startup Time": 327.969, "Actual Total Time": 928.655, "Actual Rows": 11616, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 441377.81, "Plan Rows": 44782, "Plan Width": 12, "Actual Startup Time": 0.424, "Actual Total Time": 925.438, "Actual Rows": 31032, "Actual Loops": 3, "Filter": "((note)::text = '(voice: English version)'::text)", "Rows Removed by Filter": 12050416}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.023, "Actual Total Time": 0.024, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.019, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((role)::text = 'actress'::text)", "Rows Removed by Filter": 11}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 1.6, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 7532, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[jp]'::text)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n1", "Startup Cost": 0.43, "Total Cost": 0.77, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 17379, "Index Cond": "(id = an1.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name)::text ~~ '%Yo%'::text) AND ((name)::text !~~ '%Yu%'::text))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 2.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.006, "Actual Total Time": 0.006, "Actual Rows": 1, "Actual Loops": 62, "Index Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 62}]}]}]}]}, "Planning Time": 82.426, "Triggers": [], "Execution Time": 1396.653}]
[{"Bao": {"Bao prediction": 2383.18, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 529510.66, "Total Cost": 529510.67, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2295.954, "Actual Total Time": 2337.741, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 69261.23, "Total Cost": 529510.65, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 468.968, "Actual Total Time": 2337.6, "Actual Rows": 1728, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 69261.08, "Total Cost": 529510.48, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 468.962, "Actual Total Time": 2335.577, "Actual Rows": 2199, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 69260.65, "Total Cost": 529510.02, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 468.953, "Actual Total Time": 2330.553, "Actual Rows": 2199, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 68260.65, "Total Cost": 528509.92, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 468.216, "Actual Total Time": 2290.516, "Actual Rows": 733, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 68260.22, "Total Cost": 528507.17, "Plan Rows": 6, "Plan Width": 12, "Actual Startup Time": 465.176, "Actual Total Time": 2255.291, "Actual Rows": 24126, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 12, "Actual Startup Time": 0.016, "Actual Total Time": 845.913, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 68260.21, "Total Cost": 68260.21, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 464.101, "Actual Total Time": 464.109, "Actual Rows": 134, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 17887.81, "Total Cost": 68260.21, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 222.493, "Actual Total Time": 463.973, "Actual Rows": 134, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 17887.39, "Total Cost": 68259.75, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 221.086, "Actual Total Time": 399.951, "Actual Rows": 33725, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 103.545, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 17887.38, "Total Cost": 17887.38, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 177.846, "Actual Total Time": 177.852, "Actual Rows": 288, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2462.84, "Total Cost": 17887.38, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 95.859, "Actual Total Time": 177.35, "Actual Rows": 288, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2462.69, "Total Cost": 17887.2, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 50.495, "Actual Total Time": 174.345, "Actual Rows": 3291, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(cc.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2462.26, "Total Cost": 17885.8, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 50.216, "Actual Total Time": 143.294, "Actual Rows": 9971, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2459.84, "Total Cost": 17883.29, "Plan Rows": 33, "Plan Width": 16, "Actual Startup Time": 50.172, "Actual Total Time": 141.317, "Actual Rows": 14617, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 80118, "Plan Width": 8, "Actual Startup Time": 0.022, "Actual Total Time": 65.149, "Actual Rows": 64632, "Actual Loops": 3, "Filter": "((info)::text > '7.0'::text)", "Rows Removed by Filter": 395380}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2457.46, "Total Cost": 2457.46, "Plan Rows": 190, "Plan Width": 8, "Actual Startup Time": 50.113, "Actual Total Time": 50.115, "Actual Rows": 135086, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 1024, "Hash Batches": 2, "Original Hash Batches": 1, "Peak Memory Usage": 3659, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.89, "Total Cost": 2457.46, "Plan Rows": 190, "Plan Width": 8, "Actual Startup Time": 0.038, "Actual Total Time": 31.215, "Actual Rows": 135086, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.status_id = cct2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.015, "Actual Total Time": 9.819, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.012, "Actual Total Time": 0.013, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.01, "Actual Total Time": 0.011, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((kind)::text ~~ '%complete%'::text)", "Rows Removed by Filter": 2}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.034, "Actual Total Time": 0.034, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.027, "Actual Total Time": 0.028, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 1.39, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 29914, "Index Cond": "(id = mi_idx.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2000)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 9872, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'movie'::text)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 101174, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 72379, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))", "Rows Removed by Filter": 0}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 2199, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 2199}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "comp_cast_type_pkey", "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 2199, "Index Cond": "(id = cc.subject_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'cast'::text)", "Rows Removed by Filter": 0}]}]}, "Planning Time": 207.206, "Triggers": [], "Execution Time": 2337.868}]
[{"Bao": {"Bao prediction": 3501.552, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 837674.03, "Total Cost": 837674.04, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2536.241, "Actual Total Time": 2597.662, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 787300.1, "Total Cost": 837674.02, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2535.56, "Actual Total Time": 2597.654, "Actual Rows": 45, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 786300.1, "Total Cost": 836673.92, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2469.479, "Actual Total Time": 2532.765, "Actual Rows": 15, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 786299.68, "Total Cost": 836672.04, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2469.263, "Actual Total Time": 2532.314, "Actual Rows": 270, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.007, "Actual Total Time": 101.74, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 786299.67, "Total Cost": 786299.67, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2330.215, "Actual Total Time": 2330.235, "Actual Rows": 8, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 769739.71, "Total Cost": 786299.67, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2318.511, "Actual Total Time": 2330.207, "Actual Rows": 8, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.011, "Actual Total Time": 24.388, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 769739.7, "Total Cost": 769739.7, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2284.727, "Actual Total Time": 2284.745, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 735999.44, "Total Cost": 769739.7, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2277.582, "Actual Total Time": 2284.63, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 735999.02, "Total Cost": 769737.16, "Plan Rows": 1, "Plan Width": 28, "Actual Startup Time": 2222.22, "Actual Total Time": 2284.524, "Actual Rows": 26, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.009, "Actual Total Time": 62.297, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 735999.0, "Total Cost": 735999.0, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2162.348, "Actual Total Time": 2162.364, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 480150.81, "Total Cost": 735999.0, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2127.76, "Actual Total Time": 2162.275, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 480150.38, "Total Cost": 735997.27, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2127.741, "Actual Total Time": 2162.25, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 480149.95, "Total Cost": 735995.54, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2098.943, "Actual Total Time": 2160.192, "Actual Rows": 339, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 480149.52, "Total Cost": 735984.47, "Plan Rows": 6, "Plan Width": 16, "Actual Startup Time": 2098.697, "Actual Total Time": 2123.375, "Actual Rows": 13024, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 480147.1, "Total Cost": 735980.11, "Plan Rows": 712, "Plan Width": 20, "Actual Startup Time": 2098.651, "Actual Total Time": 2121.121, "Actual Rows": 13024, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 255356.52, "Plan Rows": 126272, "Plan Width": 8, "Actual Startup Time": 98.601, "Actual Total Time": 750.731, "Actual Rows": 100416, "Actual Loops": 3, "Filter": "((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%201%'::text) OR ((info)::text ~~ 'USA:%201%'::text)))", "Rows Removed by Filter": 4844824}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 480120.81, "Total Cost": 480120.81, "Plan Rows": 2103, "Plan Width": 12, "Actual Startup Time": 1333.241, "Actual Total Time": 1333.243, "Actual Rows": 92055, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 8192, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 2176, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 480120.81, "Plan Rows": 2103, "Plan Width": 12, "Actual Startup Time": 400.714, "Actual Total Time": 1302.751, "Actual Rows": 92055, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 479115.98, "Plan Rows": 373356, "Plan Width": 16, "Actual Startup Time": 0.026, "Actual Total Time": 1274.594, "Actual Rows": 289159, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(voice),\"(voice: Japanese version)\",\"(voice) (uncredited)\",\"(voice: English version)\"}'::text[]))", "Rows Removed by Filter": 11792289}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.019, "Actual Total Time": 0.02, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.017, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((role)::text = 'actress'::text)", "Rows Removed by Filter": 11}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.033, "Actual Total Time": 0.033, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.022, "Actual Total Time": 0.029, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 1.85, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 39071, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 1.71, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.006, "Actual Total Time": 0.006, "Actual Rows": 0, "Actual Loops": 1017, "Index Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year > 2010) AND ((title)::text ~~ 'Kung Fu Panda%'::text))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 1.74, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.013, "Actual Rows": 1, "Actual Loops": 5, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 5}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 1.48, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 0, "Actual Loops": 79, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((country_code)::text = '[us]'::text) AND ((name)::text = 'DreamWorks Animation'::text))", "Rows Removed by Filter": 1}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 1.47, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 810, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{hero,martial-arts,hand-to-hand-combat,computer-animated-movie}'::text[]))", "Rows Removed by Filter": 1}]}]}]}, "Planning Time": 216.587, "Triggers": [], "Execution Time": 2597.78}]
[{"Bao": {"Bao prediction": 2441.038, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 369814.16, "Total Cost": 369814.17, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1602.925, "Actual Total Time": 1632.673, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 369813.95, "Total Cost": 369814.16, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 1601.535, "Actual Total Time": 1632.666, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 368813.95, "Total Cost": 368813.96, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1599.184, "Actual Total Time": 1599.198, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 318441.36, "Total Cost": 368813.94, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1451.376, "Actual Total Time": 1599.171, "Actual Rows": 470, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 318440.94, "Total Cost": 368813.48, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1371.921, "Actual Total Time": 1588.265, "Actual Rows": 7954, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.018, "Actual Total Time": 106.619, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 318440.93, "Total Cost": 318440.93, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1370.049, "Actual Total Time": 1370.059, "Actual Rows": 821, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 216, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 318440.31, "Total Cost": 318440.93, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1360.988, "Actual Total Time": 1368.514, "Actual Rows": 821, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ml.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 318439.88, "Total Cost": 318440.32, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1360.792, "Actual Total Time": 1366.419, "Actual Rows": 1241, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Merge Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 318439.46, "Total Cost": 318439.87, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1360.766, "Actual Total Time": 1361.563, "Actual Rows": 2928, "Actual Loops": 3, "Inner Unique": false, "Merge Cond": "(mc.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 317877.26, "Total Cost": 317879.61, "Plan Rows": 941, "Plan Width": 12, "Actual Startup Time": 1356.154, "Actual Total Time": 1356.219, "Actual Rows": 1103, "Actual Loops": 3, "Sort Key": ["mc.movie_id"], "Sort Method": "quicksort", "Sort Space Used": 3714, "Sort Space Type": "Memory", "Workers": [{"Worker Number": 0, "Sort Method": "quicksort", "Sort Space Used": 3623, "Sort Space Type": "Memory"}, {"Worker Number": 1, "Sort Method": "quicksort", "Sort Space Used": 4035, "Sort Space Type": "Memory"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 31120.35, "Total Cost": 317830.78, "Plan Rows": 941, "Plan Width": 12, "Actual Startup Time": 1300.507, "Actual Total Time": 1344.733, "Actual Rows": 51726, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 286477.69, "Plan Rows": 61019, "Plan Width": 4, "Actual Startup Time": 0.483, "Actual Total Time": 1070.432, "Actual Rows": 51299, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))", "Rows Removed by Filter": 4893941}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 31082.95, "Total Cost": 31082.95, "Plan Rows": 2992, "Plan Width": 8, "Actual Startup Time": 217.842, "Actual Total Time": 217.844, "Actual Rows": 397976, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 8192, "Hash Batches": 16, "Original Hash Batches": 1, "Peak Memory Usage": 3520, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 31082.95, "Plan Rows": 2992, "Plan Width": 8, "Actual Startup Time": 38.001, "Actual Total Time": 137.21, "Actual Rows": 397976, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 531175, "Plan Width": 12, "Actual Startup Time": 0.018, "Actual Total Time": 83.351, "Actual Rows": 423996, "Actual Loops": 3, "Filter": "(note IS NULL)", "Rows Removed by Filter": 445713}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.019, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.013, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 3}]}]}]}]}]}, {"Node Type": "Sort", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 562.2, "Total Cost": 562.3, "Plan Rows": 42, "Plan Width": 4, "Actual Startup Time": 4.602, "Actual Total Time": 4.821, "Actual Rows": 4941, "Actual Loops": 3, "Sort Key": ["ml.movie_id"], "Sort Method": "quicksort", "Sort Space Used": 205, "Sort Space Type": "Memory", "Workers": [{"Worker Number": 0, "Sort Method": "quicksort", "Sort Space Used": 205, "Sort Space Type": "Memory"}, {"Worker Number": 1, "Sort Method": "quicksort", "Sort Space Used": 205, "Sort Space Type": "Memory"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.89, "Total Cost": 561.07, "Plan Rows": 42, "Plan Width": 4, "Actual Startup Time": 0.044, "Actual Total Time": 4.242, "Actual Rows": 2315, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ml.link_type_id = lt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 8, "Actual Startup Time": 0.02, "Actual Total Time": 1.907, "Actual Rows": 29997, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.014, "Actual Total Time": 0.015, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.01, "Actual Total Time": 0.013, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((link)::text ~~ '%follow%'::text)", "Rows Removed by Filter": 16}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 8785, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.59, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 3722, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 1950) AND (production_year <= 2000))", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 23862, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = 'sequel'::text)", "Rows Removed by Filter": 1}]}]}]}]}, "Planning Time": 100.507, "Triggers": [], "Execution Time": 1632.774}]
[{"Bao": {"Bao prediction": 3124.415, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 514108.78, "Total Cost": 514108.79, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2622.588, "Actual Total Time": 2667.202, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 514108.56, "Total Cost": 514108.77, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2622.466, "Actual Total Time": 2667.196, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 513108.56, "Total Cost": 513108.57, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2620.067, "Actual Total Time": 2620.077, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 462736.14, "Total Cost": 513108.56, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2552.864, "Actual Total Time": 2620.071, "Actual Rows": 6, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 462735.71, "Total Cost": 513108.1, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2543.951, "Actual Total Time": 2620.027, "Actual Rows": 11, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 462735.29, "Total Cost": 513107.64, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2501.233, "Actual Total Time": 2619.02, "Actual Rows": 427, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.008, "Actual Total Time": 98.277, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 462735.27, "Total Cost": 462735.27, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2419.42, "Actual Total Time": 2419.425, "Actual Rows": 3, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2488.29, "Total Cost": 462735.27, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1142.515, "Actual Total Time": 2419.379, "Actual Rows": 3, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2487.86, "Total Cost": 462734.81, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 296.931, "Actual Total Time": 2224.178, "Actual Rows": 131779, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 12, "Actual Startup Time": 0.013, "Actual Total Time": 890.792, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2487.85, "Total Cost": 2487.85, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 296.865, "Actual Total Time": 296.869, "Actual Rows": 4696, "Actual Loops": 3, "Hash Buckets": 8192, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 248, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 19.5, "Total Cost": 2487.85, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.25, "Actual Total Time": 295.871, "Actual Rows": 4696, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 19.36, "Total Cost": 2487.67, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 0.178, "Actual Total Time": 271.717, "Actual Rows": 23557, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2485.89, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.045, "Actual Total Time": 66.067, "Actual Rows": 85941, "Actual Loops": 3, "Inner Unique": false, "Join Filter": "(cc.status_id = cct2.id)", "Rows Removed by Join Filter": 85941, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 0.019, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((kind)::text ~~ '%complete%'::text)", "Rows Removed by Filter": 2}, {"Node Type": "Hash Join", "Parent Relationship": "Inner", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 0.015, "Actual Total Time": 27.105, "Actual Rows": 85941, "Actual Loops": 6, "Inner Unique": true, "Hash Cond": "(cc.subject_id = cct1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.006, "Actual Total Time": 9.275, "Actual Rows": 135086, "Actual Loops": 6}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.009, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'cast'::text)", "Rows Removed by Filter": 3}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 1.78, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 257823, "Index Cond": "(id = cc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2000)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 70671, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'movie'::text)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 395336, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name)::text !~~ '%Sherlock%'::text) AND (((name)::text ~~ '%Tony%Stark%'::text) OR ((name)::text ~~ '%Iron%Man%'::text)))", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 1280, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 33, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name)::text ~~ '%Downey%Robert%'::text)", "Rows Removed by Filter": 0}]}]}]}]}, "Planning Time": 105.067, "Triggers": [], "Execution Time": 2667.304}]
[{"Bao": {"Bao prediction": 2621.594, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 562517.93, "Total Cost": 562517.94, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2733.834, "Actual Total Time": 2780.868, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 562517.72, "Total Cost": 562517.93, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2733.34, "Actual Total Time": 2780.863, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 561517.72, "Total Cost": 561517.73, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2731.055, "Actual Total Time": 2731.063, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 544956.68, "Total Cost": 561516.78, "Plan Rows": 375, "Plan Width": 0, "Actual Startup Time": 2664.271, "Actual Total Time": 2727.725, "Actual Rows": 83152, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = n.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 24.274, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 544954.65, "Total Cost": 544954.65, "Plan Rows": 163, "Plan Width": 8, "Actual Startup Time": 2663.942, "Actual Total Time": 2663.949, "Actual Rows": 56424, "Actual Loops": 3, "Hash Buckets": 262144, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 10744, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 84633.49, "Total Cost": 544954.65, "Plan Rows": 163, "Plan Width": 8, "Actual Startup Time": 459.378, "Actual Total Time": 2563.789, "Actual Rows": 56424, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 84633.06, "Total Cost": 544880.43, "Plan Rows": 163, "Plan Width": 4, "Actual Startup Time": 459.352, "Actual Total Time": 2451.13, "Actual Rows": 56424, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.022, "Actual Total Time": 871.106, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 84632.96, "Total Cost": 84632.96, "Plan Rows": 8, "Plan Width": 12, "Actual Startup Time": 459.194, "Actual Total Time": 459.199, "Actual Rows": 2255, "Actual Loops": 3, "Hash Buckets": 8192, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 504, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50885.41, "Total Cost": 84632.96, "Plan Rows": 8, "Plan Width": 12, "Actual Startup Time": 270.404, "Actual Total Time": 419.229, "Actual Rows": 2255, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50884.99, "Total Cost": 84623.15, "Plan Rows": 22, "Plan Width": 16, "Actual Startup Time": 270.368, "Actual Total Time": 414.039, "Actual Rows": 2887, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.024, "Actual Total Time": 62.388, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50884.94, "Total Cost": 50884.94, "Plan Rows": 4, "Plan Width": 8, "Actual Startup Time": 270.009, "Actual Total Time": 270.011, "Actual Rows": 1795, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 312, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.57, "Total Cost": 50884.94, "Plan Rows": 4, "Plan Width": 8, "Actual Startup Time": 11.995, "Actual Total Time": 257.659, "Actual Rows": 1795, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 11.95, "Actual Total Time": 217.951, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 101.443, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 11.907, "Actual Total Time": 11.907, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.558, "Actual Total Time": 11.902, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'character-name-in-title'::text)", "Rows Removed by Filter": 134169}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 41840, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((episode_nr >= 5) AND (episode_nr < 100))", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 8661, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 169273, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 169273}]}]}]}]}]}]}, "Planning Time": 89.219, "Triggers": [], "Execution Time": 2780.955}]
[{"Bao": {"Bao prediction": 1590.516, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 85653.07, "Total Cost": 85653.08, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 510.715, "Actual Total Time": 520.971, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 51879.08, "Total Cost": 85653.07, "Plan Rows": 2, "Plan Width": 0, "Actual Startup Time": 247.933, "Actual Total Time": 520.668, "Actual Rows": 5228, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50879.08, "Total Cost": 84652.87, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 246.018, "Actual Total Time": 507.967, "Actual Rows": 1743, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mc.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50878.65, "Total Cost": 84652.37, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 245.988, "Actual Total Time": 502.061, "Actual Rows": 1743, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50878.23, "Total Cost": 84616.69, "Plan Rows": 80, "Plan Width": 12, "Actual Startup Time": 245.019, "Actual Total Time": 407.219, "Actual Rows": 49517, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mk.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.024, "Actual Total Time": 64.325, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50878.05, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 244.588, "Actual Total Time": 244.59, "Actual Rows": 13947, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2680, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 11.941, "Actual Total Time": 218.531, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 103.01, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 11.898, "Actual Total Time": 11.899, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.555, "Actual Total Time": 11.893, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'character-name-in-title'::text)", "Rows Removed by Filter": 134169}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 148552, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[nl]'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 5228, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 5228}]}]}]}, "Planning Time": 78.732, "Triggers": [], "Execution Time": 521.031}]
[{"Bao": {"Bao prediction": 5777.424, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 580748.48, "Total Cost": 580748.49, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 7510.497, "Actual Total Time": 7581.565, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 580748.27, "Total Cost": 580748.48, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 7507.82, "Actual Total Time": 7581.558, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 579748.27, "Total Cost": 579748.28, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 7505.592, "Actual Total Time": 7505.601, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 562595.7, "Total Cost": 579235.99, "Plan Rows": 204910, "Plan Width": 0, "Actual Startup Time": 7295.673, "Actual Total Time": 7470.378, "Actual Rows": 829204, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(a1.person_id = n1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "a1", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.031, "Actual Total Time": 27.417, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 561481.05, "Total Cost": 561481.05, "Plan Rows": 89172, "Plan Width": 8, "Actual Startup Time": 7213.702, "Actual Total Time": 7213.709, "Actual Rows": 656886, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 262144, "Hash Batches": 32, "Original Hash Batches": 1, "Peak Memory Usage": 3840, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 527127.79, "Total Cost": 561481.05, "Plan Rows": 89172, "Plan Width": 8, "Actual Startup Time": 6800.531, "Actual Total Time": 7052.522, "Actual Rows": 656886, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 5344.51, "Total Cost": 37859.67, "Plan Rows": 391078, "Plan Width": 4, "Actual Startup Time": 15.782, "Actual Total Time": 208.754, "Actual Rows": 384599, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_id = cn.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.016, "Actual Total Time": 66.678, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 4722.92, "Total Cost": 4722.92, "Plan Rows": 49727, "Plan Width": 4, "Actual Startup Time": 15.528, "Actual Total Time": 15.528, "Actual Rows": 28281, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 4384, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.0, "Total Cost": 4722.92, "Plan Rows": 49727, "Plan Width": 4, "Actual Startup Time": 0.04, "Actual Total Time": 9.655, "Actual Rows": 28281, "Actual Loops": 3, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 50051}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 520720.24, "Total Cost": 520720.24, "Plan Rows": 85044, "Plan Width": 16, "Actual Startup Time": 6537.645, "Actual Total Time": 6537.648, "Actual Rows": 909648, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 262144, "Hash Batches": 32, "Original Hash Batches": 1, "Peak Memory Usage": 4576, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 19.79, "Total Cost": 520720.24, "Plan Rows": 85044, "Plan Width": 16, "Actual Startup Time": 1227.163, "Actual Total Time": 6262.736, "Actual Rows": 909648, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 19.36, "Total Cost": 482240.5, "Plan Rows": 85044, "Plan Width": 12, "Actual Startup Time": 1227.139, "Actual Total Time": 3766.659, "Actual Rows": 909648, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 443520.17, "Plan Rows": 85044, "Plan Width": 8, "Actual Startup Time": 1227.09, "Actual Total Time": 1992.804, "Actual Rows": 909648, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 12, "Actual Startup Time": 0.016, "Actual Total Time": 869.938, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.035, "Actual Total Time": 0.035, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.028, "Actual Total Time": 0.029, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((role)::text = 'writer'::text)", "Rows Removed by Filter": 11}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n1", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 2728943, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 2728943}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 2728943, "Index Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 2728943}]}]}]}]}]}]}]}]}, "Planning Time": 83.103, "Triggers": [], "Execution Time": 7581.648}]
[{"Bao": {"Bao prediction": 2551.046, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 360322.39, "Total Cost": 360322.4, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1263.312, "Actual Total Time": 1295.039, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 344726.34, "Total Cost": 360322.39, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1250.948, "Actual Total Time": 1295.027, "Actual Rows": 148, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 344726.2, "Total Cost": 360322.2, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1250.935, "Actual Total Time": 1294.836, "Actual Rows": 224, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 343726.2, "Total Cost": 359322.1, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1228.631, "Actual Total Time": 1260.548, "Actual Rows": 75, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 126190, "Plan Width": 8, "Actual Startup Time": 0.036, "Actual Total Time": 67.751, "Actual Rows": 99992, "Actual Loops": 3, "Filter": "((info)::text > '6.5'::text)", "Rows Removed by Filter": 360020}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 343726.19, "Total Cost": 343726.19, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1186.541, "Actual Total Time": 1186.551, "Actual Rows": 70, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 293353.66, "Total Cost": 343726.19, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 1038.813, "Actual Total Time": 1186.451, "Actual Rows": 70, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 293353.24, "Total Cost": 343725.64, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 1038.798, "Actual Total Time": 1186.131, "Actual Rows": 71, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 293352.82, "Total Cost": 343725.18, "Plan Rows": 1, "Plan Width": 28, "Actual Startup Time": 969.905, "Actual Total Time": 1176.292, "Actual Rows": 6417, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.022, "Actual Total Time": 107.049, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 293352.81, "Total Cost": 293352.81, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 962.202, "Actual Total Time": 962.21, "Actual Rows": 127, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 258035.04, "Total Cost": 293352.81, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 823.672, "Actual Total Time": 962.068, "Actual Rows": 127, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 258034.89, "Total Cost": 293352.64, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 823.662, "Actual Total Time": 961.904, "Actual Rows": 141, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 258034.46, "Total Cost": 293350.89, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 823.553, "Actual Total Time": 959.645, "Actual Rows": 690, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 258034.31, "Total Cost": 293350.72, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 823.536, "Actual Total Time": 959.013, "Actual Rows": 690, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 258034.16, "Total Cost": 293350.55, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 823.518, "Actual Total Time": 958.272, "Actual Rows": 781, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 35097.06, "Plan Rows": 58487, "Plan Width": 12, "Actual Startup Time": 0.017, "Actual Total Time": 127.773, "Actual Rows": 101090, "Actual Loops": 3, "Filter": "(((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))", "Rows Removed by Filter": 768619}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 258034.15, "Total Cost": 258034.15, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 823.077, "Actual Total Time": 823.081, "Actual Rows": 735, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 216, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2469.44, "Total Cost": 258034.15, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 626.416, "Actual Total Time": 775.729, "Actual Rows": 735, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2467.01, "Total Cost": 258031.42, "Plan Rows": 110, "Plan Width": 16, "Actual Startup Time": 31.034, "Actual Total Time": 775.485, "Actual Rows": 1857, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 255356.52, "Plan Rows": 55142, "Plan Width": 8, "Actual Startup Time": 0.407, "Actual Total Time": 736.599, "Actual Rows": 44746, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))", "Rows Removed by Filter": 4900494}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2457.5, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 30.234, "Actual Total Time": 30.236, "Actual Rows": 49145, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2432, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 13.507, "Actual Total Time": 24.572, "Actual Rows": 49145, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.subject_id = cct1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.014, "Actual Total Time": 9.782, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.01, "Actual Total Time": 0.011, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.008, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'crew'::text)", "Rows Removed by Filter": 3}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.036, "Actual Total Time": 0.036, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.025, "Actual Total Time": 0.032, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'countries'::text)", "Rows Removed by Filter": 112}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "comp_cast_type_pkey", "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 2342, "Index Cond": "(id = cc.status_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text <> 'complete+verified'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 2071, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 2071}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 1.73, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 2071, "Index Cond": "(id = mc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2005)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 422, "Index Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = ANY ('{movie,episode}'::text[]))", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 19251, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.55, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 1, "Actual Loops": 212, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text <> '[us]'::text)", "Rows Removed by Filter": 0}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 224, "Index Cond": "(id = mi_idx.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 0}]}]}, "Planning Time": 232.442, "Triggers": [], "Execution Time": 1295.175}]
[{"Bao": {"Bao prediction": 2307.405, "Bao recommended hint": "SET enable_nestloop TO off; SET enable_mergejoin TO off; SET enable_indexscan TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 708167.28, "Total Cost": 708167.29, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2943.813, "Actual Total Time": 2994.429, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 657412.38, "Total Cost": 708167.28, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2943.14, "Actual Total Time": 2994.42, "Actual Rows": 93, "Actual Loops": 1, "Inner Unique": true, "Hash Cond": "(t.kind_id = kt.id)", "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 657389.57, "Total Cost": 708144.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2840.511, "Actual Total Time": 2994.379, "Actual Rows": 111, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 656389.57, "Total Cost": 707144.36, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 2852.021, "Actual Total Time": 2940.778, "Actual Rows": 37, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(t.id = mk.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "title", "Alias": "t", "Startup Cost": 0.0, "Total Cost": 49166.73, "Plan Rows": 423480, "Plan Width": 8, "Actual Startup Time": 0.022, "Actual Total Time": 92.239, "Actual Rows": 337640, "Actual Loops": 3, "Filter": "(production_year > 2005)", "Rows Removed by Filter": 505131}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 656389.56, "Total Cost": 656389.56, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2827.6, "Actual Total Time": 2827.612, "Actual Rows": 122, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 576898.1, "Total Cost": 656389.56, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2613.109, "Actual Total Time": 2827.54, "Actual Rows": 122, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.status_id = cct2.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 576879.21, "Total Cost": 656370.67, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2613.079, "Actual Total Time": 2827.475, "Actual Rows": 122, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(n.id = ci.person_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "name", "Alias": "n", "Startup Cost": 0.0, "Total Cost": 72979.14, "Plan Rows": 1736614, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 115.28, "Actual Rows": 1389164, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 576879.2, "Total Cost": 576879.2, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2611.373, "Actual Total Time": 2611.383, "Actual Rows": 122, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 526506.83, "Total Cost": 576879.2, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2379.996, "Actual Total Time": 2611.266, "Actual Rows": 122, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 523545.23, "Total Cost": 573917.6, "Plan Rows": 2, "Plan Width": 28, "Actual Startup Time": 2354.714, "Actual Total Time": 2586.523, "Actual Rows": 90602, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.013, "Actual Total Time": 105.0, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 523545.21, "Total Cost": 523545.21, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 2354.155, "Actual Total Time": 2354.162, "Actual Rows": 1278, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 344, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 77064.71, "Total Cost": 523545.21, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 339.977, "Actual Total Time": 2344.284, "Actual Rows": 1278, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 77062.29, "Total Cost": 523542.72, "Plan Rows": 25, "Plan Width": 24, "Actual Startup Time": 338.232, "Actual Total Time": 2343.715, "Actual Rows": 4336, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.subject_id = cct1.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 77043.36, "Total Cost": 523512.36, "Plan Rows": 4334, "Plan Width": 28, "Actual Startup Time": 338.214, "Actual Total Time": 2342.661, "Actual Rows": 6986, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 72612.93, "Total Cost": 517953.0, "Plan Rows": 28717, "Plan Width": 16, "Actual Startup Time": 304.933, "Actual Total Time": 2296.862, "Actual Rows": 14096, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 57233.52, "Total Cost": 500498.26, "Plan Rows": 521511, "Plan Width": 8, "Actual Startup Time": 239.105, "Actual Total Time": 2182.666, "Actual Rows": 207862, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.person_role_id = chn.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 12, "Actual Startup Time": 0.008, "Actual Total Time": 889.72, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 56075.49, "Total Cost": 56075.49, "Plan Rows": 92642, "Plan Width": 4, "Actual Startup Time": 238.689, "Actual Total Time": 238.69, "Actual Rows": 60051, "Actual Loops": 3, "Hash Buckets": 262144, "Original Hash Buckets": 262144, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9120, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.0, "Total Cost": 56075.49, "Plan Rows": 92642, "Plan Width": 4, "Actual Startup Time": 0.038, "Actual Total Time": 222.525, "Actual Rows": 60051, "Actual Loops": 3, "Filter": "((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))", "Rows Removed by Filter": 986729}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 15122.68, "Total Cost": 15122.68, "Plan Rows": 20538, "Plan Width": 8, "Actual Startup Time": 65.503, "Actual Total Time": 65.503, "Actual Rows": 17883, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 65536, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2656, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 20538, "Plan Width": 8, "Actual Startup Time": 0.024, "Actual Total Time": 62.447, "Actual Rows": 17883, "Actual Loops": 3, "Filter": "((info)::text > '8.0'::text)", "Rows Removed by Filter": 442129}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2081.86, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 32.442, "Actual Total Time": 32.443, "Actual Rows": 135086, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 4, "Original Hash Batches": 4, "Peak Memory Usage": 2471, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.009, "Actual Total Time": 13.229, "Actual Rows": 135086, "Actual Loops": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.008, "Actual Total Time": 0.009, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.005, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'cast'::text)", "Rows Removed by Filter": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.025, "Actual Total Time": 0.026, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.022, "Actual Total Time": 0.023, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2961.55, "Total Cost": 2961.55, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 19.787, "Actual Total Time": 19.788, "Actual Rows": 4, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2961.55, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.094, "Actual Total Time": 19.783, "Actual Rows": 4, "Actual Loops": 3, "Filter": "((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,fight}'::text[]))", "Rows Removed by Filter": 134166}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.022, "Actual Total Time": 0.022, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 0.017, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((kind)::text ~~ '%complete%'::text)", "Rows Removed by Filter": 2}]}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 22.75, "Total Cost": 22.75, "Plan Rows": 5, "Plan Width": 4, "Actual Startup Time": 0.014, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 1, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.0, "Total Cost": 22.75, "Plan Rows": 5, "Plan Width": 4, "Actual Startup Time": 0.011, "Actual Total Time": 0.012, "Actual Rows": 1, "Actual Loops": 1, "Filter": "((kind)::text = 'movie'::text)", "Rows Removed by Filter": 6}]}]}]}, "Planning Time": 205.398, "Triggers": [], "Execution Time": 2994.539}]
[{"Bao": {"Bao prediction": 3082.719, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 546238.38, "Total Cost": 546238.39, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3981.767, "Actual Total Time": 4030.115, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 546238.17, "Total Cost": 546238.38, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 3980.956, "Actual Total Time": 4030.109, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 545238.17, "Total Cost": 545238.18, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3978.86, "Actual Total Time": 3978.867, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 511394.69, "Total Cost": 545237.58, "Plan Rows": 235, "Plan Width": 0, "Actual Startup Time": 3165.164, "Actual Total Time": 3962.275, "Actual Rows": 371040, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 511394.27, "Total Cost": 545133.37, "Plan Rows": 235, "Plan Width": 4, "Actual Startup Time": 3165.139, "Actual Total Time": 3386.727, "Actual Rows": 371040, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 62.803, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 511393.27, "Total Cost": 511393.27, "Plan Rows": 80, "Plan Width": 12, "Actual Startup Time": 3164.547, "Actual Total Time": 3164.552, "Actual Rows": 49831, "Actual Loops": 3, "Hash Buckets": 262144, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 11192, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50885.48, "Total Cost": 511393.27, "Plan Rows": 80, "Plan Width": 12, "Actual Startup Time": 297.344, "Actual Total Time": 3134.752, "Actual Rows": 49831, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50885.05, "Total Cost": 511132.78, "Plan Rows": 569, "Plan Width": 16, "Actual Startup Time": 297.197, "Actual Total Time": 2444.871, "Actual Rows": 346131, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.018, "Actual Total Time": 859.793, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50884.87, "Total Cost": 50884.87, "Plan Rows": 14, "Plan Width": 8, "Actual Startup Time": 297.096, "Actual Total Time": 297.099, "Actual Rows": 13947, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2680, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.57, "Total Cost": 50884.87, "Plan Rows": 14, "Plan Width": 8, "Actual Startup Time": 12.086, "Actual Total Time": 264.534, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 12.058, "Actual Total Time": 222.937, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 103.092, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 12.015, "Actual Total Time": 12.016, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.568, "Actual Total Time": 12.008, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'character-name-in-title'::text)", "Rows Removed by Filter": 134169}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 41840, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 41840}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 1038393, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name)::text ~~ '%B%'::text)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 1113120, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 1113120}]}]}]}]}, "Planning Time": 87.155, "Triggers": [], "Execution Time": 4030.21}]
[{"Bao": {"Bao prediction": 3255.976, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 290349.42, "Total Cost": 290349.43, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1078.131, "Actual Total Time": 1105.171, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 48918.24, "Total Cost": 290349.41, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1078.028, "Actual Total Time": 1105.166, "Actual Rows": 10, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 48917.82, "Total Cost": 290348.97, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1078.009, "Actual Total Time": 1105.057, "Actual Rows": 33, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 47917.82, "Total Cost": 289348.87, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 883.987, "Actual Total Time": 1075.907, "Actual Rows": 11, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 47917.39, "Total Cost": 289311.04, "Plan Rows": 81, "Plan Width": 16, "Actual Startup Time": 778.187, "Actual Total Time": 1075.826, "Actual Rows": 24, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 241189.17, "Plan Rows": 55082, "Plan Width": 4, "Actual Startup Time": 441.164, "Actual Total Time": 757.849, "Actual Rows": 40621, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 224235.35, "Plan Rows": 6224235, "Plan Width": 8, "Actual Startup Time": 0.018, "Actual Total Time": 403.234, "Actual Rows": 4945240, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.02, "Actual Total Time": 0.021, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 0.018, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'budget'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 47911.45, "Total Cost": 47911.45, "Plan Rows": 281, "Plan Width": 12, "Actual Startup Time": 315.262, "Actual Total Time": 315.266, "Actual Rows": 40, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 15337.95, "Total Cost": 47911.45, "Plan Rows": 281, "Plan Width": 12, "Actual Startup Time": 124.01, "Actual Total Time": 315.159, "Actual Rows": 40, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 20.74, "Total Cost": 32552.88, "Plan Rows": 10718, "Plan Width": 8, "Actual Startup Time": 0.057, "Actual Total Time": 197.159, "Actual Rows": 869710, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mc.company_type_id = ct.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 12, "Actual Startup Time": 0.012, "Actual Total Time": 63.712, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 20.65, "Total Cost": 20.65, "Plan Rows": 7, "Plan Width": 4, "Actual Startup Time": 0.021, "Actual Total Time": 0.022, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.0, "Total Cost": 20.65, "Plan Rows": 7, "Plan Width": 4, "Actual Startup Time": 0.011, "Actual Total Time": 0.019, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((kind IS NOT NULL) AND (((kind)::text = 'production companies'::text) OR ((kind)::text = 'distributors'::text)))", "Rows Removed by Filter": 2}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 15253.6, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 67.821, "Actual Total Time": 67.823, "Actual Rows": 3, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 16384, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 160, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15253.6, "Plan Rows": 5089, "Plan Width": 4, "Actual Startup Time": 67.746, "Actual Total Time": 67.748, "Actual Rows": 3, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.015, "Actual Total Time": 34.111, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.029, "Actual Total Time": 0.029, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.024, "Actual Total Time": 0.025, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'bottom 10 rank'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.47, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 72, "Index Cond": "(id = mi.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year > 2000) AND (((title)::text ~~ 'Birdemic%'::text) OR ((title)::text ~~ '%Movie%'::text)))", "Rows Removed by Filter": 1}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 33, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1}]}]}, "Planning Time": 86.703, "Triggers": [], "Execution Time": 1105.256}]
[{"Bao": {"Bao prediction": 1311.114, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 101537.35, "Total Cost": 101537.36, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 405.789, "Actual Total Time": 410.521, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 67798.46, "Total Cost": 101537.35, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 286.622, "Actual Total Time": 410.507, "Actual Rows": 114, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 67798.31, "Total Cost": 101537.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 286.615, "Actual Total Time": 410.391, "Actual Rows": 114, "Actual Loops": 1, "Inner Unique": true, "Join Filter": "(ml.movie_id = t1.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 67797.88, "Total Cost": 101536.64, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 286.606, "Actual Total Time": 410.141, "Actual Rows": 114, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 66797.88, "Total Cost": 100536.54, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 283.906, "Actual Total Time": 403.055, "Actual Rows": 38, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 66797.74, "Total Cost": 100536.36, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 283.891, "Actual Total Time": 402.938, "Actual Rows": 114, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 66797.32, "Total Cost": 100535.47, "Plan Rows": 2, "Plan Width": 20, "Actual Startup Time": 283.872, "Actual Total Time": 402.68, "Actual Rows": 131, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc1.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc1", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.004, "Actual Total Time": 59.057, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 66797.3, "Total Cost": 66797.3, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 283.085, "Actual Total Time": 283.093, "Actual Rows": 44, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 33059.13, "Total Cost": 66797.3, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 159.972, "Actual Total Time": 283.059, "Actual Rows": 44, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 33058.71, "Total Cost": 66796.86, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 159.94, "Actual Total Time": 282.91, "Actual Rows": 44, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc2.movie_id = t2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc2", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.006, "Actual Total Time": 63.115, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 33058.7, "Total Cost": 33058.7, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 159.414, "Actual Total Time": 159.421, "Actual Rows": 19, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 17211.51, "Total Cost": 33058.7, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 96.897, "Actual Total Time": 159.328, "Actual Rows": 19, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 17211.36, "Total Cost": 33058.19, "Plan Rows": 3, "Plan Width": 28, "Actual Startup Time": 96.8, "Actual Total Time": 159.283, "Actual Rows": 27, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ml.linked_movie_id = t2.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 17210.93, "Total Cost": 33052.42, "Plan Rows": 8, "Plan Width": 20, "Actual Startup Time": 96.733, "Actual Total Time": 159.078, "Actual Rows": 41, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx1.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx1", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.007, "Actual Total Time": 30.947, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 17210.91, "Total Cost": 17210.91, "Plan Rows": 2, "Plan Width": 12, "Actual Startup Time": 96.009, "Actual Total Time": 96.013, "Actual Rows": 16, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 860.26, "Total Cost": 17210.91, "Plan Rows": 2, "Plan Width": 12, "Actual Startup Time": 8.651, "Actual Total Time": 95.954, "Actual Rows": 16, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ml.link_type_id = lt.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 840.36, "Total Cost": 17190.56, "Plan Rows": 169, "Plan Width": 16, "Actual Startup Time": 8.176, "Actual Total Time": 95.863, "Actual Rows": 502, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx2.movie_id = ml.linked_movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15921.02, "Plan Rows": 2586, "Plan Width": 4, "Actual Startup Time": 0.073, "Actual Total Time": 85.358, "Actual Rows": 12250, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx2.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx2", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 292245, "Plan Width": 8, "Actual Startup Time": 0.015, "Actual Total Time": 71.12, "Actual Rows": 234640, "Actual Loops": 3, "Filter": "((info)::text < '3.5'::text)", "Rows Removed by Filter": 225372}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.024, "Actual Total Time": 0.025, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.021, "Actual Total Time": 0.023, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 462.97, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 12, "Actual Startup Time": 7.804, "Actual Total Time": 7.804, "Actual Rows": 29997, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 32768, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1545, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 12, "Actual Startup Time": 0.011, "Actual Total Time": 3.622, "Actual Rows": 29997, "Actual Loops": 3}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 19.76, "Total Cost": 19.76, "Plan Rows": 11, "Plan Width": 4, "Actual Startup Time": 0.037, "Actual Total Time": 0.037, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.0, "Total Cost": 19.76, "Plan Rows": 11, "Plan Width": 4, "Actual Startup Time": 0.023, "Actual Total Time": 0.026, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((link)::text = ANY ('{sequel,follows,\"followed by\"}'::text[]))", "Rows Removed by Filter": 16}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t2", "Startup Cost": 0.43, "Total Cost": 0.71, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.005, "Actual Total Time": 0.005, "Actual Rows": 1, "Actual Loops": 123, "Index Cond": "(id = mi_idx2.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 2000) AND (production_year <= 2010))", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt2", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 81, "Index Cond": "(id = t2.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = ANY ('{\"tv series\",episode}'::text[]))", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn2", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 132, "Index Cond": "(id = mc2.company_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 132}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn1", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 393, "Index Cond": "(id = mc1.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text <> '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 342, "Index Cond": "(id = mi_idx1.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 1}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t1", "Startup Cost": 0.43, "Total Cost": 0.52, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 114, "Index Cond": "(id = mc1.movie_id)", "Rows Removed by Index Recheck": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt1", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 114, "Index Cond": "(id = t1.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = ANY ('{\"tv series\",episode}'::text[]))", "Rows Removed by Filter": 0}]}]}, "Planning Time": 244.495, "Triggers": [], "Execution Time": 410.699}]
[{"Bao": {"Bao prediction": 1598.723, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 85654.09, "Total Cost": 85654.1, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 514.979, "Actual Total Time": 525.781, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 85653.87, "Total Cost": 85654.08, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 514.848, "Actual Total Time": 525.776, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 84653.87, "Total Cost": 84653.88, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 512.765, "Actual Total Time": 512.769, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50879.08, "Total Cost": 84653.87, "Plan Rows": 3, "Plan Width": 0, "Actual Startup Time": 251.195, "Actual Total Time": 512.566, "Actual Rows": 2611, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mc.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50878.65, "Total Cost": 84652.37, "Plan Rows": 3, "Plan Width": 8, "Actual Startup Time": 251.164, "Actual Total Time": 503.646, "Actual Rows": 2611, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50878.23, "Total Cost": 84616.69, "Plan Rows": 80, "Plan Width": 12, "Actual Startup Time": 250.582, "Actual Total Time": 409.464, "Actual Rows": 49517, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mk.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 62.96, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50878.05, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 250.178, "Actual Total Time": 250.18, "Actual Rows": 13947, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2680, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 11.886, "Actual Total Time": 224.785, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 106.346, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 11.842, "Actual Total Time": 11.843, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.553, "Actual Total Time": 11.836, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'character-name-in-title'::text)", "Rows Removed by Filter": 134169}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 148552, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[de]'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 7834, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 7834}]}]}]}]}, "Planning Time": 79.556, "Triggers": [], "Execution Time": 525.848}]
[{"Bao": {"Bao prediction": 1309.264, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 84678.33, "Total Cost": 84678.34, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 365.003, "Actual Total Time": 373.965, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 84678.12, "Total Cost": 84678.33, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 364.798, "Actual Total Time": 373.958, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 83678.12, "Total Cost": 83678.13, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 362.537, "Actual Total Time": 362.544, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 51915.14, "Total Cost": 83678.12, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 240.697, "Actual Total Time": 362.394, "Actual Rows": 2315, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ml.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 51914.71, "Total Cost": 83677.61, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 240.675, "Actual Total Time": 358.881, "Actual Rows": 2315, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 51914.56, "Total Cost": 83677.45, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 240.651, "Actual Total Time": 356.792, "Actual Rows": 2315, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 51914.41, "Total Cost": 83677.28, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 240.641, "Actual Total Time": 354.822, "Actual Rows": 2315, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 51913.99, "Total Cost": 83660.38, "Plan Rows": 37, "Plan Width": 24, "Actual Startup Time": 239.306, "Actual Total Time": 346.975, "Actual Rows": 5170, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 555962, "Plan Width": 12, "Actual Startup Time": 0.022, "Actual Total Time": 76.169, "Actual Rows": 445713, "Actual Loops": 3, "Filter": "(note IS NOT NULL)", "Rows Removed by Filter": 423996}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 51913.83, "Total Cost": 51913.83, "Plan Rows": 13, "Plan Width": 12, "Actual Startup Time": 238.637, "Actual Total Time": 238.64, "Actual Rows": 487, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3631.81, "Total Cost": 51913.83, "Plan Rows": 13, "Plan Width": 12, "Actual Startup Time": 23.924, "Actual Total Time": 238.478, "Actual Rows": 487, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2793.88, "Total Cost": 51045.79, "Plan Rows": 42, "Plan Width": 4, "Actual Startup Time": 16.394, "Actual Total Time": 227.984, "Actual Rows": 15801, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.008, "Actual Total Time": 106.508, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2793.84, "Total Cost": 2793.84, "Plan Rows": 3, "Plan Width": 4, "Actual Startup Time": 16.328, "Actual Total Time": 16.329, "Actual Rows": 3, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2793.84, "Plan Rows": 3, "Plan Width": 4, "Actual Startup Time": 0.791, "Actual Total Time": 16.325, "Actual Rows": 3, "Actual Loops": 3, "Filter": "((keyword)::text = ANY ('{sequel,revenge,based-on-novel}'::text[]))", "Rows Removed by Filter": 134167}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 462.97, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 8, "Actual Startup Time": 7.341, "Actual Total Time": 7.342, "Actual Rows": 29997, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 32768, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1428, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 8, "Actual Startup Time": 0.018, "Actual Total Time": 3.563, "Actual Rows": 29997, "Actual Loops": 3}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 15510, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '20th Century Fox%'::text) OR ((name)::text ~~ 'Twentieth Century Fox%'::text)))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 6946, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind IS NOT NULL) AND ((kind)::text <> 'production companies'::text))", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "link_type_pkey", "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 6946, "Index Cond": "(id = ml.link_type_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 6946}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 6946, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 1950)", "Rows Removed by Filter": 0}]}]}]}]}, "Planning Time": 85.639, "Triggers": [], "Execution Time": 374.059}]
[{"Bao": {"Bao prediction": 3314.894, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 789000.02, "Total Cost": 789000.03, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2570.928, "Actual Total Time": 2628.649, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 788999.81, "Total Cost": 789000.02, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2569.598, "Actual Total Time": 2628.644, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 787999.81, "Total Cost": 787999.82, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2566.817, "Actual Total Time": 2566.826, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 771437.91, "Total Cost": 787999.81, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2467.915, "Actual Total Time": 2566.817, "Actual Rows": 61, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ci.person_id = n.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 771437.48, "Total Cost": 787998.22, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2441.266, "Actual Total Time": 2530.408, "Actual Rows": 22342, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 771437.06, "Total Cost": 787997.01, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 2441.241, "Actual Total Time": 2493.93, "Actual Rows": 22983, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = ci.person_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.023, "Actual Total Time": 23.881, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 771437.05, "Total Cost": 771437.05, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2440.519, "Actual Total Time": 2440.527, "Actual Rows": 12609, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2552, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 735857.27, "Total Cost": 771437.05, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2170.977, "Actual Total Time": 2407.722, "Actual Rows": 12609, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 735856.84, "Total Cost": 771435.59, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 2170.94, "Actual Total Time": 2378.77, "Actual Rows": 14241, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 735856.41, "Total Cost": 771429.83, "Plan Rows": 4, "Plan Width": 24, "Actual Startup Time": 2170.631, "Actual Total Time": 2335.733, "Actual Rows": 24232, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 35097.06, "Plan Rows": 127023, "Plan Width": 8, "Actual Startup Time": 0.015, "Actual Total Time": 138.038, "Actual Rows": 196998, "Actual Loops": 3, "Filter": "((note IS NOT NULL) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))", "Rows Removed by Filter": 672712}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 735856.34, "Total Cost": 735856.34, "Plan Rows": 6, "Plan Width": 16, "Actual Startup Time": 2170.549, "Actual Total Time": 2170.555, "Actual Rows": 49045, "Actual Loops": 3, "Hash Buckets": 262144, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 11032, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 480149.52, "Total Cost": 735856.34, "Plan Rows": 6, "Plan Width": 16, "Actual Startup Time": 2124.919, "Actual Total Time": 2153.778, "Actual Rows": 49045, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 255704.99, "Plan Rows": 1125, "Plan Width": 4, "Actual Startup Time": 202.872, "Actual Total Time": 773.028, "Actual Rows": 150346, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 255356.52, "Plan Rows": 127064, "Plan Width": 8, "Actual Startup Time": 83.354, "Actual Total Time": 753.731, "Actual Rows": 150368, "Actual Loops": 3, "Filter": "((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))", "Rows Removed by Filter": 4794872}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.035, "Actual Total Time": 0.036, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.028, "Actual Total Time": 0.033, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 480120.81, "Total Cost": 480120.81, "Plan Rows": 2103, "Plan Width": 12, "Actual Startup Time": 1332.219, "Actual Total Time": 1332.221, "Actual Rows": 92055, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 8192, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 2208, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 480120.81, "Plan Rows": 2103, "Plan Width": 12, "Actual Startup Time": 401.374, "Actual Total Time": 1303.298, "Actual Rows": 92055, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 479115.98, "Plan Rows": 373356, "Plan Width": 16, "Actual Startup Time": 0.032, "Actual Total Time": 1274.966, "Actual Rows": 289159, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(voice),\"(voice: Japanese version)\",\"(voice) (uncredited)\",\"(voice: English version)\"}'::text[]))", "Rows Removed by Filter": 11792289}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.025, "Actual Total Time": 0.026, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.02, "Actual Total Time": 0.021, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((role)::text = 'actress'::text)", "Rows Removed by Filter": 11}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 1.43, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 72696, "Index Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 2005) AND (production_year <= 2009))", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 1.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 42723, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 37828}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 1.2, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 68948, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 1.58, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 67025, "Index Cond": "(id = an.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name)::text ~~ '%Ang%'::text) AND ((gender)::text = 'f'::text))", "Rows Removed by Filter": 1}]}]}]}]}, "Planning Time": 113.761, "Triggers": [], "Execution Time": 2628.76}]
[{"Bao": {"Bao prediction": 1977.734, "Bao recommended hint": "SET enable_mergejoin TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 341665.46, "Total Cost": 341665.47, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1106.35, "Actual Total Time": 1137.902, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 86102.02, "Total Cost": 341665.46, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 959.26, "Actual Total Time": 1137.884, "Actual Rows": 247, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 86101.87, "Total Cost": 341665.28, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 959.245, "Actual Total Time": 1137.676, "Actual Rows": 247, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 85101.87, "Total Cost": 340665.18, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1054.456, "Actual Total Time": 1103.311, "Actual Rows": 82, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 255356.52, "Plan Rows": 55142, "Plan Width": 4, "Actual Startup Time": 0.357, "Actual Total Time": 736.545, "Actual Rows": 44746, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))", "Rows Removed by Filter": 4900494}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 85101.86, "Total Cost": 85101.86, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 363.719, "Actual Total Time": 363.728, "Actual Rows": 32, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 34720.89, "Total Cost": 85101.86, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 295.602, "Actual Total Time": 363.666, "Actual Rows": 32, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 34720.47, "Total Cost": 85093.01, "Plan Rows": 20, "Plan Width": 28, "Actual Startup Time": 295.533, "Actual Total Time": 363.348, "Actual Rows": 234, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.019, "Actual Total Time": 104.291, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 34720.46, "Total Cost": 34720.46, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 155.979, "Actual Total Time": 155.986, "Actual Rows": 32, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3067.11, "Total Cost": 34720.46, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 135.548, "Actual Total Time": 155.953, "Actual Rows": 32, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3066.96, "Total Cost": 34720.28, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 135.545, "Actual Total Time": 155.923, "Actual Rows": 32, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 3066.54, "Total Cost": 34719.82, "Plan Rows": 1, "Plan Width": 28, "Actual Startup Time": 135.531, "Actual Total Time": 155.804, "Actual Rows": 63, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 531175, "Plan Width": 12, "Actual Startup Time": 0.025, "Actual Total Time": 75.892, "Actual Rows": 423996, "Actual Loops": 3, "Filter": "(note IS NULL)", "Rows Removed by Filter": 445713}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 3066.52, "Total Cost": 3066.52, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 57.642, "Actual Total Time": 57.647, "Actual Rows": 38, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 10, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2486.33, "Total Cost": 3066.52, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 50.535, "Actual Total Time": 57.639, "Actual Rows": 38, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ml.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2485.9, "Total Cost": 3064.73, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 45.767, "Actual Total Time": 56.906, "Actual Rows": 189, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ml.link_type_id = lt.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2467.01, "Total Cost": 3045.14, "Plan Rows": 267, "Plan Width": 16, "Actual Startup Time": 45.371, "Actual Total Time": 56.659, "Actual Rows": 3346, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ml.movie_id = cc.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 8, "Actual Startup Time": 0.009, "Actual Total Time": 2.041, "Actual Rows": 29997, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2457.5, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 45.321, "Actual Total Time": 45.323, "Actual Rows": 110494, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 1024, "Hash Batches": 2, "Original Hash Batches": 1, "Peak Memory Usage": 3172, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 2457.5, "Plan Rows": 761, "Plan Width": 8, "Actual Startup Time": 0.035, "Actual Total Time": 29.751, "Actual Rows": 110494, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(cc.status_id = cct2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "complete_cast", "Alias": "cc", "Startup Cost": 0.0, "Total Cost": 2081.86, "Plan Rows": 135086, "Plan Width": 12, "Actual Startup Time": 0.014, "Actual Total Time": 10.046, "Actual Rows": 135086, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.012, "Actual Total Time": 0.012, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "comp_cast_type", "Alias": "cct2", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.009, "Actual Total Time": 0.01, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((kind)::text = 'complete'::text)", "Rows Removed by Filter": 3}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.026, "Actual Total Time": 0.026, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.022, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((link)::text ~~ '%follow%'::text)", "Rows Removed by Filter": 16}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 1.78, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 0, "Actual Loops": 567, "Index Cond": "(id = cc.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year = 1998)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 190, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_type_pkey", "Relation Name": "company_type", "Alias": "ct", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 95, "Index Cond": "(id = mc.company_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'production companies'::text)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 703, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = 'sequel'::text)", "Rows Removed by Filter": 1}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "comp_cast_type_pkey", "Relation Name": "comp_cast_type", "Alias": "cct1", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 247, "Index Cond": "(id = cc.subject_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = ANY ('{cast,crew}'::text[]))", "Rows Removed by Filter": 0}]}]}, "Planning Time": 204.49, "Triggers": [], "Execution Time": 1138.028}]
[{"Bao": {"Bao prediction": 3782.931, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 837910.86, "Total Cost": 837910.87, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 3029.181, "Actual Total Time": 3089.517, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 804168.83, "Total Cost": 837910.85, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 2926.306, "Actual Total Time": 3089.488, "Actual Rows": 275, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 804168.4, "Total Cost": 837909.01, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2904.72, "Actual Total Time": 3079.039, "Actual Rows": 6518, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 804167.97, "Total Cost": 837907.27, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 2904.711, "Actual Total Time": 3068.603, "Actual Rows": 6532, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 804167.55, "Total Cost": 837905.79, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2904.691, "Actual Total Time": 3048.585, "Actual Rows": 14511, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 803167.55, "Total Cost": 836905.69, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 2897.341, "Actual Total Time": 3009.498, "Actual Rows": 4837, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.018, "Actual Total Time": 62.596, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 803167.54, "Total Cost": 803167.54, "Plan Rows": 1, "Plan Width": 28, "Actual Startup Time": 2881.738, "Actual Total Time": 2881.751, "Actual Rows": 784, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 280, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 752545.57, "Total Cost": 803167.54, "Plan Rows": 1, "Plan Width": 28, "Actual Startup Time": 2284.57, "Actual Total Time": 2841.199, "Actual Rows": 784, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 752545.14, "Total Cost": 803165.92, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 2272.318, "Actual Total Time": 2838.836, "Actual Rows": 1485, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 752544.72, "Total Cost": 802917.76, "Plan Rows": 169, "Plan Width": 28, "Actual Startup Time": 2217.56, "Actual Total Time": 2467.815, "Actual Rows": 247385, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 101.322, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 752544.55, "Total Cost": 752544.55, "Plan Rows": 14, "Plan Width": 20, "Actual Startup Time": 2215.997, "Actual Total Time": 2216.008, "Actual Rows": 24569, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 6072, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 735984.54, "Total Cost": 752544.55, "Plan Rows": 14, "Plan Width": 20, "Actual Startup Time": 2144.523, "Actual Total Time": 2201.729, "Actual Rows": 24569, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(an.person_id = ci.person_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "aka_name", "Alias": "an", "Startup Cost": 0.0, "Total Cost": 15151.6, "Plan Rows": 375560, "Plan Width": 4, "Actual Startup Time": 0.016, "Actual Total Time": 25.2, "Actual Rows": 300448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 735984.47, "Total Cost": 735984.47, "Plan Rows": 6, "Plan Width": 16, "Actual Startup Time": 2144.354, "Actual Total Time": 2144.363, "Actual Rows": 13024, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2936, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 480149.52, "Total Cost": 735984.47, "Plan Rows": 6, "Plan Width": 16, "Actual Startup Time": 2117.914, "Actual Total Time": 2139.185, "Actual Rows": 13024, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it.id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 480147.1, "Total Cost": 735980.11, "Plan Rows": 712, "Plan Width": 20, "Actual Startup Time": 2117.873, "Actual Total Time": 2137.346, "Actual Rows": 13024, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = ci.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 255356.52, "Plan Rows": 126272, "Plan Width": 8, "Actual Startup Time": 129.114, "Actual Total Time": 757.55, "Actual Rows": 100416, "Actual Loops": 3, "Filter": "((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%201%'::text) OR ((info)::text ~~ 'USA:%201%'::text)))", "Rows Removed by Filter": 4844824}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 480120.81, "Total Cost": 480120.81, "Plan Rows": 2103, "Plan Width": 12, "Actual Startup Time": 1345.669, "Actual Total Time": 1345.671, "Actual Rows": 92055, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 8192, "Hash Batches": 8, "Original Hash Batches": 1, "Peak Memory Usage": 2176, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.93, "Total Cost": 480120.81, "Plan Rows": 2103, "Plan Width": 12, "Actual Startup Time": 403.819, "Actual Total Time": 1313.815, "Actual Rows": 92055, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ci.role_id = rt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 479115.98, "Plan Rows": 373356, "Plan Width": 16, "Actual Startup Time": 0.023, "Actual Total Time": 1285.324, "Actual Rows": 289159, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(voice),\"(voice: Japanese version)\",\"(voice) (uncredited)\",\"(voice: English version)\"}'::text[]))", "Rows Removed by Filter": 11792289}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.026, "Actual Total Time": 0.026, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "role_type", "Alias": "rt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 4, "Plan Width": 4, "Actual Startup Time": 0.023, "Actual Total Time": 0.024, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((role)::text = 'actress'::text)", "Rows Removed by Filter": 11}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.03, "Actual Total Time": 0.03, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.018, "Actual Total Time": 0.025, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'release dates'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "keyword_pkey", "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.42, "Total Cost": 1.47, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 742156, "Index Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{hero,martial-arts,hand-to-hand-combat}'::text[]))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 1.6, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 4455, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2010)", "Rows Removed by Filter": 0}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.42, "Total Cost": 1.48, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 14511, "Index Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "char_name_pkey", "Relation Name": "char_name", "Alias": "chn", "Startup Cost": 0.43, "Total Cost": 1.74, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 6532, "Index Cond": "(id = ci.person_role_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 6518}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 1.85, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 6518, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "(((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))", "Rows Removed by Filter": 1}]}]}, "Planning Time": 218.814, "Triggers": [], "Execution Time": 3089.638}]
[{"Bao": {"Bao prediction": 3116.131, "Bao recommended hint": "SET enable_mergejoin TO off; SET enable_indexscan TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 548938.32, "Total Cost": 548938.33, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 5310.713, "Actual Total Time": 5357.022, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 548938.1, "Total Cost": 548938.31, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 5310.187, "Actual Total Time": 5357.016, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 547938.1, "Total Cost": 547938.11, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 5307.881, "Actual Total Time": 5307.888, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 85035.15, "Total Cost": 547936.61, "Plan Rows": 596, "Plan Width": 0, "Actual Startup Time": 627.697, "Actual Total Time": 5262.786, "Actual Rows": 944185, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 85034.71, "Total Cost": 545283.28, "Plan Rows": 596, "Plan Width": 4, "Actual Startup Time": 627.674, "Actual Total Time": 2886.211, "Actual Rows": 944185, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 858.46, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 85034.36, "Total Cost": 85034.36, "Plan Rows": 28, "Plan Width": 12, "Actual Startup Time": 627.357, "Actual Total Time": 627.363, "Actual Rows": 22772, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 5304, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50941.07, "Total Cost": 85034.36, "Plan Rows": 28, "Plan Width": 12, "Actual Startup Time": 302.483, "Actual Total Time": 597.973, "Actual Rows": 22772, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50940.64, "Total Cost": 84678.83, "Plan Rows": 80, "Plan Width": 16, "Actual Startup Time": 302.442, "Actual Total Time": 461.664, "Actual Rows": 49517, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.009, "Actual Total Time": 62.305, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50940.47, "Total Cost": 50940.47, "Plan Rows": 14, "Plan Width": 8, "Actual Startup Time": 302.3, "Actual Total Time": 302.303, "Actual Rows": 13947, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2680, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.58, "Total Cost": 50940.47, "Plan Rows": 14, "Plan Width": 8, "Actual Startup Time": 12.06, "Actual Total Time": 268.972, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 12.027, "Actual Total Time": 217.506, "Actual Rows": 13947, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.01, "Actual Total Time": 99.603, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 11.976, "Actual Total Time": 11.977, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.542, "Actual Total Time": 11.971, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'character-name-in-title'::text)", "Rows Removed by Filter": 134169}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "title", "Alias": "t", "Startup Cost": 0.45, "Total Cost": 4.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 41840, "Recheck Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Exact Heap Blocks": 15437, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "title_pkey", "Startup Cost": 0.0, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 41840, "Index Cond": "(id = mk.movie_id)"}]}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "company_name", "Alias": "cn", "Startup Cost": 0.43, "Total Cost": 4.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 148552, "Recheck Cond": "(id = mc.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[us]'::text)", "Rows Removed by Filter": 1, "Exact Heap Blocks": 49911, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "company_name_pkey", "Startup Cost": 0.0, "Total Cost": 0.43, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 148552, "Index Cond": "(id = mc.company_id)"}]}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "name", "Alias": "n", "Startup Cost": 0.44, "Total Cost": 4.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 2832555, "Recheck Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Exact Heap Blocks": 956976, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "name_pkey", "Startup Cost": 0.0, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 2832555, "Index Cond": "(id = ci.person_id)"}]}]}]}]}]}, "Planning Time": 81.827, "Triggers": [], "Execution Time": 5357.114}]
[{"Bao": {"Bao prediction": 1638.946, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 101048.05, "Total Cost": 101048.06, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 398.926, "Actual Total Time": 404.595, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 67309.71, "Total Cost": 101048.05, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 398.848, "Actual Total Time": 404.59, "Actual Rows": 4, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 67309.57, "Total Cost": 101047.86, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 398.842, "Actual Total Time": 404.572, "Actual Rows": 12, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 67309.42, "Total Cost": 101047.69, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 398.834, "Actual Total Time": 404.553, "Actual Rows": 12, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 67309.0, "Total Cost": 101047.24, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 398.815, "Actual Total Time": 404.511, "Actual Rows": 12, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 66309.0, "Total Cost": 100047.14, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 337.337, "Actual Total Time": 396.132, "Actual Rows": 4, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc2.movie_id = t2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc2", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.014, "Actual Total Time": 58.939, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 66308.99, "Total Cost": 66308.99, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 278.029, "Actual Total Time": 278.039, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50467.36, "Total Cost": 66308.99, "Plan Rows": 1, "Plan Width": 20, "Actual Startup Time": 257.6, "Actual Total Time": 277.992, "Actual Rows": 1, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50467.22, "Total Cost": 66308.8, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 217.09, "Actual Total Time": 277.971, "Actual Rows": 12, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50467.07, "Total Cost": 66308.63, "Plan Rows": 1, "Plan Width": 28, "Actual Startup Time": 217.067, "Actual Total Time": 277.937, "Actual Rows": 12, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ml.movie_id = t1.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50466.64, "Total Cost": 66308.1, "Plan Rows": 1, "Plan Width": 36, "Actual Startup Time": 217.043, "Actual Total Time": 277.892, "Actual Rows": 12, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx1.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx1", "Startup Cost": 0.0, "Total Cost": 13685.15, "Plan Rows": 575015, "Plan Width": 8, "Actual Startup Time": 0.006, "Actual Total Time": 30.771, "Actual Rows": 460012, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50466.62, "Total Cost": 50466.62, "Plan Rows": 1, "Plan Width": 28, "Actual Startup Time": 216.238, "Actual Total Time": 216.245, "Actual Rows": 4, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 16725.77, "Total Cost": 50466.62, "Plan Rows": 1, "Plan Width": 28, "Actual Startup Time": 135.265, "Actual Total Time": 216.187, "Actual Rows": 4, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 16725.35, "Total Cost": 50463.5, "Plan Rows": 7, "Plan Width": 32, "Actual Startup Time": 94.54, "Actual Total Time": 215.895, "Actual Rows": 95, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mc1.movie_id = ml.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_companies", "Alias": "mc1", "Startup Cost": 0.0, "Total Cost": 29661.37, "Plan Rows": 1087137, "Plan Width": 8, "Actual Startup Time": 0.024, "Actual Total Time": 62.016, "Actual Rows": 869710, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 16725.33, "Total Cost": 16725.33, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 94.381, "Actual Total Time": 94.385, "Actual Rows": 17, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 562.02, "Total Cost": 16725.33, "Plan Rows": 1, "Plan Width": 24, "Actual Startup Time": 20.074, "Actual Total Time": 94.33, "Actual Rows": 17, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(ml.linked_movie_id = t2.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 561.59, "Total Cost": 16706.89, "Plan Rows": 25, "Plan Width": 16, "Actual Startup Time": 6.335, "Actual Total Time": 90.848, "Actual Rows": 967, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi_idx2.movie_id = ml.linked_movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx2", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 272632, "Plan Width": 8, "Actual Startup Time": 0.035, "Actual Total Time": 70.681, "Actual Rows": 218320, "Actual Loops": 3, "Filter": "((info)::text < '3.0'::text)", "Rows Removed by Filter": 241691}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 561.07, "Total Cost": 561.07, "Plan Rows": 42, "Plan Width": 8, "Actual Startup Time": 6.112, "Actual Total Time": 6.114, "Actual Rows": 2315, "Actual Loops": 3, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 123, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 18.89, "Total Cost": 561.07, "Plan Rows": 42, "Plan Width": 8, "Actual Startup Time": 0.05, "Actual Total Time": 5.805, "Actual Rows": 2315, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(ml.link_type_id = lt.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "movie_link", "Alias": "ml", "Startup Cost": 0.0, "Total Cost": 462.97, "Plan Rows": 29997, "Plan Width": 12, "Actual Startup Time": 0.015, "Actual Total Time": 2.715, "Actual Rows": 29997, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 18.88, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.019, "Actual Total Time": 0.019, "Actual Rows": 2, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "link_type", "Alias": "lt", "Startup Cost": 0.0, "Total Cost": 18.88, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.011, "Actual Total Time": 0.015, "Actual Rows": 2, "Actual Loops": 3, "Filter": "((link)::text ~~ '%follow%'::text)", "Rows Removed by Filter": 16}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t2", "Startup Cost": 0.43, "Total Cost": 0.73, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 2902, "Index Cond": "(id = mi_idx2.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year = 2007)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn1", "Startup Cost": 0.42, "Total Cost": 0.45, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 284, "Index Cond": "(id = mc1.company_id)", "Rows Removed by Index Recheck": 0, "Filter": "((country_code)::text = '[nl]'::text)", "Rows Removed by Filter": 1}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t1", "Startup Cost": 0.43, "Total Cost": 0.52, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 36, "Index Cond": "(id = mc1.movie_id)", "Rows Removed by Index Recheck": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt1", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 36, "Index Cond": "(id = t1.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'tv series'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 36, "Index Cond": "(id = mi_idx2.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 1}]}]}]}]}, {"Node Type": "Index Only Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "company_name_pkey", "Relation Name": "company_name", "Alias": "cn2", "Startup Cost": 0.42, "Total Cost": 0.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 12, "Index Cond": "(id = mc2.company_id)", "Rows Removed by Index Recheck": 0, "Heap Fetches": 12}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "kind_type_pkey", "Relation Name": "kind_type", "Alias": "kt2", "Startup Cost": 0.15, "Total Cost": 0.17, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 12, "Index Cond": "(id = t2.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'tv series'::text)", "Rows Removed by Filter": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "info_type_pkey", "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.14, "Total Cost": 0.16, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 12, "Index Cond": "(id = mi_idx1.info_type_id)", "Rows Removed by Index Recheck": 0, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 1}]}]}, "Planning Time": 248.431, "Triggers": [], "Execution Time": 404.738}]
[{"Bao": {"Bao prediction": 3190.134, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 755980.19, "Total Cost": 755980.2, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2071.411, "Actual Total Time": 2122.318, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 755979.98, "Total Cost": 755980.19, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 2071.231, "Actual Total Time": 2122.312, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 754979.98, "Total Cost": 754979.99, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 2069.015, "Actual Total Time": 2069.023, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 255058.45, "Total Cost": 754979.98, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1542.857, "Actual Total Time": 2069.016, "Actual Rows": 4, "Actual Loops": 3, "Inner Unique": true, "Join Filter": "(mi.movie_id = t.id)", "Rows Removed by Join Filter": 0, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 255058.02, "Total Cost": 754979.37, "Plan Rows": 1, "Plan Width": 12, "Actual Startup Time": 1532.058, "Actual Total Time": 2068.939, "Actual Rows": 5, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 255057.59, "Total Cost": 754978.62, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1521.705, "Actual Total Time": 2067.852, "Actual Rows": 137, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = mi.movie_id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 497985.06, "Plan Rows": 516258, "Plan Width": 8, "Actual Startup Time": 83.089, "Actual Total Time": 1364.753, "Actual Rows": 414905, "Actual Loops": 3, "Filter": "((note)::text = ANY ('{(writer),\"(head writer)\",\"(written by)\",(story),\"(story editor)\"}'::text[]))", "Rows Removed by Filter": 11666543}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 255057.57, "Total Cost": 255057.57, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 673.071, "Actual Total Time": 673.076, "Actual Rows": 244, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 15185.74, "Total Cost": 255057.57, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 597.498, "Actual Total Time": 672.723, "Actual Rows": 244, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 239873.33, "Plan Rows": 244, "Plan Width": 4, "Actual Startup Time": 525.459, "Actual Total Time": 597.854, "Actual Rows": 24086, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 239795.93, "Plan Rows": 27527, "Plan Width": 8, "Actual Startup Time": 372.655, "Actual Total Time": 594.682, "Actual Rows": 24349, "Actual Loops": 3, "Filter": "((note IS NULL) AND ((info)::text = ANY ('{Horror,Thriller}'::text[])))", "Rows Removed by Filter": 4920891}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.017, "Actual Total Time": 0.018, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.007, "Actual Total Time": 0.014, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'genres'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 15181.04, "Total Cost": 15181.04, "Plan Rows": 182, "Plan Width": 4, "Actual Startup Time": 71.824, "Actual Total Time": 71.825, "Actual Rows": 5283, "Actual Loops": 3, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 952, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15181.04, "Plan Rows": 182, "Plan Width": 4, "Actual Startup Time": 0.099, "Actual Total Time": 64.52, "Actual Rows": 5283, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 20538, "Plan Width": 8, "Actual Startup Time": 0.025, "Actual Total Time": 63.056, "Actual Rows": 17883, "Actual Loops": 3, "Filter": "((info)::text > '8.0'::text)", "Rows Removed by Filter": 442129}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.033, "Actual Total Time": 0.033, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.028, "Actual Total Time": 0.029, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}]}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.75, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.007, "Actual Total Time": 0.007, "Actual Rows": 0, "Actual Loops": 412, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((gender IS NOT NULL) AND ((gender)::text = 'f'::text))", "Rows Removed by Filter": 1}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.6, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.013, "Actual Rows": 1, "Actual Loops": 16, "Index Cond": "(id = ci.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year >= 2008) AND (production_year <= 2014))", "Rows Removed by Filter": 0}]}]}]}]}, "Planning Time": 85.267, "Triggers": [], "Execution Time": 2122.408}]
[{"Bao": {"Bao prediction": 2222.35, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 338675.07, "Total Cost": 338675.08, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1314.313, "Actual Total Time": 1343.955, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 338674.86, "Total Cost": 338675.07, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 1314.138, "Actual Total Time": 1343.923, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 337674.86, "Total Cost": 337674.87, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1311.897, "Actual Total Time": 1311.901, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50968.25, "Total Cost": 337674.79, "Plan Rows": 28, "Plan Width": 0, "Actual Startup Time": 252.997, "Actual Total Time": 1311.886, "Actual Rows": 69, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 286477.69, "Plan Rows": 61019, "Plan Width": 4, "Actual Startup Time": 0.49, "Actual Total Time": 1070.206, "Actual Rows": 51299, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))", "Rows Removed by Filter": 4893941}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50967.34, "Total Cost": 50967.34, "Plan Rows": 73, "Plan Width": 8, "Actual Startup Time": 235.958, "Actual Total Time": 235.96, "Actual Rows": 745, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.72, "Total Cost": 50967.34, "Plan Rows": 73, "Plan Width": 8, "Actual Startup Time": 32.489, "Actual Total Time": 235.78, "Actual Rows": 745, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.29, "Total Cost": 50878.2, "Plan Rows": 182, "Plan Width": 4, "Actual Startup Time": 20.562, "Actual Total Time": 224.538, "Actual Rows": 4317, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.011, "Actual Total Time": 100.583, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 13, "Plan Width": 4, "Actual Startup Time": 20.034, "Actual Total Time": 20.035, "Actual Rows": 30, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 10, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 13, "Plan Width": 4, "Actual Startup Time": 1.229, "Actual Total Time": 20.021, "Actual Rows": 30, "Actual Loops": 3, "Filter": "((keyword)::text ~~ '%sequel%'::text)", "Rows Removed by Filter": 134140}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 0, "Actual Loops": 12951, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2005)", "Rows Removed by Filter": 1}]}]}]}]}]}]}, "Planning Time": 78.802, "Triggers": [], "Execution Time": 1344.022}]
[{"Bao": {"Bao prediction": 2507.51, "Bao recommended hint": "SET enable_mergejoin TO off; SET enable_indexscan TO off; "}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Finalize", "Parallel Aware": false, "Startup Cost": 369960.12, "Total Cost": 369960.13, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1731.979, "Actual Total Time": 1766.193, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 369959.91, "Total Cost": 369960.12, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 1731.236, "Actual Total Time": 1766.187, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 368959.91, "Total Cost": 368959.92, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1728.903, "Actual Total Time": 1728.912, "Actual Rows": 1, "Actual Loops": 3, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 318575.5, "Total Cost": 368959.9, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1705.585, "Actual Total Time": 1728.909, "Actual Rows": 0, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 318575.27, "Total Cost": 368954.32, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 1640.507, "Actual Total Time": 1728.899, "Actual Rows": 1, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 318574.84, "Total Cost": 368947.2, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1535.934, "Actual Total Time": 1728.567, "Actual Rows": 65, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mk.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.015, "Actual Total Time": 96.841, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 318574.83, "Total Cost": 318574.83, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1531.315, "Actual Total Time": 1531.322, "Actual Rows": 6, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 15575.16, "Total Cost": 318574.83, "Plan Rows": 1, "Plan Width": 16, "Actual Startup Time": 1088.821, "Actual Total Time": 1531.118, "Actual Rows": 6, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 15574.67, "Total Cost": 318484.6, "Plan Rows": 20, "Plan Width": 8, "Actual Startup Time": 1060.916, "Actual Total Time": 1401.199, "Actual Rows": 38863, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(mi.movie_id = mi_idx.movie_id)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 302901.77, "Plan Rows": 2798, "Plan Width": 4, "Actual Startup Time": 953.483, "Actual Total Time": 1240.136, "Actual Rows": 204750, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi.info_type_id = it1.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info", "Alias": "mi", "Startup Cost": 0.0, "Total Cost": 302038.28, "Plan Rows": 316166, "Plan Width": 8, "Actual Startup Time": 0.557, "Actual Total Time": 1210.479, "Actual Rows": 235558, "Actual Loops": 3, "Filter": "((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))", "Rows Removed by Filter": 4709682}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.014, "Actual Total Time": 0.015, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it1", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.006, "Actual Total Time": 0.012, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'countries'::text)", "Rows Removed by Filter": 112}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 15554.8, "Total Cost": 15554.8, "Plan Rows": 1396, "Plan Width": 4, "Actual Startup Time": 107.355, "Actual Total Time": 107.356, "Actual Rows": 86616, "Actual Loops": 3, "Hash Buckets": 262144, "Original Hash Buckets": 4096, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 14272, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2.43, "Total Cost": 15554.8, "Plan Rows": 1396, "Plan Width": 4, "Actual Startup Time": 0.054, "Actual Total Time": 84.59, "Actual Rows": 86616, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mi_idx.info_type_id = it2.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_info_idx", "Alias": "mi_idx", "Startup Cost": 0.0, "Total Cost": 15122.68, "Plan Rows": 157776, "Plan Width": 8, "Actual Startup Time": 0.018, "Actual Total Time": 71.137, "Actual Rows": 125612, "Actual Loops": 3, "Filter": "((info)::text > '6.0'::text)", "Rows Removed by Filter": 334399}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2.41, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.027, "Actual Total Time": 0.027, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "info_type", "Alias": "it2", "Startup Cost": 0.0, "Total Cost": 2.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.02, "Actual Total Time": 0.021, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((info)::text = 'rating'::text)", "Rows Removed by Filter": 112}]}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "title", "Alias": "t", "Startup Cost": 0.49, "Total Cost": 4.51, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 116588, "Recheck Cond": "(id = mi.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "((production_year > 2010) AND (((title)::text ~~ '%murder%'::text) OR ((title)::text ~~ '%Murder%'::text) OR ((title)::text ~~ '%Mord%'::text)))", "Rows Removed by Filter": 1, "Exact Heap Blocks": 40318, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "title_pkey", "Startup Cost": 0.0, "Total Cost": 0.48, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 116588, "Index Cond": "(id = mi.movie_id)"}]}]}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.43, "Total Cost": 4.44, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 0, "Actual Loops": 196, "Recheck Cond": "(id = mk.keyword_id)", "Rows Removed by Index Recheck": 0, "Filter": "((keyword)::text = ANY ('{murder,murder-in-title}'::text[]))", "Rows Removed by Filter": 1, "Exact Heap Blocks": 54, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "keyword_pkey", "Startup Cost": 0.0, "Total Cost": 0.43, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.002, "Actual Total Time": 0.002, "Actual Rows": 1, "Actual Loops": 196, "Index Cond": "(id = mk.keyword_id)"}]}]}, {"Node Type": "Bitmap Heap Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Relation Name": "kind_type", "Alias": "kt", "Startup Cost": 0.23, "Total Cost": 4.25, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.01, "Actual Total Time": 0.011, "Actual Rows": 0, "Actual Loops": 2, "Recheck Cond": "(id = t.kind_id)", "Rows Removed by Index Recheck": 0, "Filter": "((kind)::text = 'movie'::text)", "Rows Removed by Filter": 0, "Exact Heap Blocks": 1, "Lossy Heap Blocks": 0, "Plans": [{"Node Type": "Bitmap Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Index Name": "kind_type_pkey", "Startup Cost": 0.0, "Total Cost": 0.23, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 0.008, "Actual Total Time": 0.008, "Actual Rows": 1, "Actual Loops": 2, "Index Cond": "(id = t.kind_id)"}]}]}]}]}]}, "Planning Time": 86.353, "Triggers": [], "Execution Time": 1766.287}]
[{"Bao": {"Bao prediction": 2069.498, "Bao recommended hint": "(no hint)"}}, {"Plan": {"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parallel Aware": false, "Startup Cost": 512172.34, "Total Cost": 512172.35, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 1896.628, "Actual Total Time": 1930.574, "Actual Rows": 1, "Actual Loops": 1, "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Startup Cost": 51885.36, "Total Cost": 512172.33, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 360.791, "Actual Total Time": 1930.567, "Actual Rows": 6, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 50885.36, "Total Cost": 511172.23, "Plan Rows": 1, "Plan Width": 0, "Actual Startup Time": 1382.65, "Actual Total Time": 1894.559, "Actual Rows": 2, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Join Type": "Inner", "Startup Cost": 50884.93, "Total Cost": 511131.95, "Plan Rows": 88, "Plan Width": 4, "Actual Startup Time": 228.521, "Actual Total Time": 1891.43, "Actual Rows": 408, "Actual Loops": 3, "Inner Unique": false, "Hash Cond": "(ci.movie_id = t.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "cast_info", "Alias": "ci", "Startup Cost": 0.0, "Total Cost": 403639.65, "Plan Rows": 15095265, "Plan Width": 8, "Actual Startup Time": 0.011, "Actual Total Time": 836.082, "Actual Rows": 12081448, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Startup Cost": 50884.91, "Total Cost": 50884.91, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 214.468, "Actual Total Time": 214.475, "Actual Rows": 4, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.57, "Total Cost": 50884.91, "Plan Rows": 2, "Plan Width": 8, "Actual Startup Time": 81.845, "Actual Total Time": 214.44, "Actual Rows": 4, "Actual Loops": 3, "Inner Unique": true, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Join Type": "Inner", "Startup Cost": 2626.14, "Total Cost": 50878.05, "Plan Rows": 14, "Plan Width": 4, "Actual Startup Time": 51.411, "Actual Total Time": 214.37, "Actual Rows": 5, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(mk.keyword_id = k.id)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Relation Name": "movie_keyword", "Alias": "mk", "Startup Cost": 0.0, "Total Cost": 43303.71, "Plan Rows": 1884971, "Plan Width": 8, "Actual Startup Time": 0.019, "Actual Total Time": 101.816, "Actual Rows": 1507977, "Actual Loops": 3}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Startup Cost": 2626.12, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 11.156, "Actual Total Time": 11.157, "Actual Rows": 1, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Relation Name": "keyword", "Alias": "k", "Startup Cost": 0.0, "Total Cost": 2626.12, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.303, "Actual Total Time": 11.151, "Actual Rows": 1, "Actual Loops": 3, "Filter": "((keyword)::text = 'marvel-cinematic-universe'::text)", "Rows Removed by Filter": 134169}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "title_pkey", "Relation Name": "title", "Alias": "t", "Startup Cost": 0.43, "Total Cost": 0.49, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.012, "Actual Total Time": 0.012, "Actual Rows": 1, "Actual Loops": 14, "Index Cond": "(id = mk.movie_id)", "Rows Removed by Index Recheck": 0, "Filter": "(production_year > 2010)", "Rows Removed by Filter": 0}]}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Scan Direction": "Forward", "Index Name": "name_pkey", "Relation Name": "name", "Alias": "n", "Startup Cost": 0.43, "Total Cost": 0.46, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.007, "Actual Total Time": 0.007, "Actual Rows": 0, "Actual Loops": 1224, "Index Cond": "(id = ci.person_id)", "Rows Removed by Index Recheck": 0, "Filter": "((name)::text ~~ '%Downey%Robert%'::text)", "Rows Removed by Filter": 1}]}]}]}, "Planning Time": 79.287, "Triggers": [], "Execution Time": 1930.65}]
